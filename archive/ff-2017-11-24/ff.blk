\ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back                                                                                                                                                                                                                                  //  ) ) //  ) )                                              __//__  __//__                                                   //      //                                                     //      //                                                                                                                                                                                                                                   ( Right-click number or press ^P to jump to specific block )                                                                   ( Find more information on how to use the editor at block 220 )                                                                                                                                 \                                                                Title page (here)                              0                Init block (loaded at startup)                 1                User Manual                                    800 ...         \                                                                ff sources                                     10 ...           Editor sources + documentation                 11 ...           Meta compiler                                  12 ...           Platform specific code                         13 ...           Testing code                                   14 ...          \                                                                User area                                      1000 ...        \                                                                                                                                                                                                                                                               Scratch area                                    2000 -          TODO                                            240                                                                             Unused block ranges:                                                                                                                    530 - 549   (build configurations)                              554 - 599   (more platform specific code)                       723 - 799   (sources)                                           900 - 1000  (testing)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ autoloaded screen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip 0  Look           abc                                                                                                                                                                                                        asaxysasa                                 askdieasas                                                        dfdf                                                                          clear           patc                                                                                                                                                                                                abort                         this is a test                                                  this is a test                                                                                       6000                                                                                                                                                           size (for block counts)         %t     Type in hex                                                                                               asasasa                                                                                                                                                                                                                                                    m(     order   )m                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             abc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Xclip 0                                                                   \ Loader for base system                                                                                                        140 142 thru    \ decomp                                                                                                        [defined] macho  [if]                                           175 177 thru  \ unexec (macho)                                  [else]                                                          171 173 thru  \ unexec (elf)                                    [then]                                                                                                                          150 152 thru    \ debugger                                                                                                      [defined] i386  [if]  600 623 thru  [then]      \ assembler     [defined] arm  [if]  630 691 thru  [then]                                                                                       [defined] screen-editor  [if]                                   215 load        \ editor                                        [else]                                                          165 167 thru    \ line editor                                   [then]                                                                                                                                                                                          \ build                                                                                                                         : saving  memfd off ;   ' saving is presave                                                                                     : make  ( | fname -- )                                            [defined] install  [if]  install  [then]                        bl word count saved ;                                                                                                         marker new                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back   0                                                                       \ "ff" sources                                                   Core system                                    100 - 117        Basic extensions ("stuff")                     120 - 132        Decompiler                                     140 - 142        Debugger                                       150 - 152        Signal handling                                160              Terminal interface                             162              String matching                                163              Subprocess invocation                          164              Line editor                                    165 - 167        Dumping executables                            170 ...          Block files                                    180 ...          Startup code                                   190              Loader for base system + editor                9               \                                                                Kernel ("generic")                             360 - 363       \                                                                Assemblers                                     364 ...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ Editor sources                                                 Editor sources                                 200 - 214        Editor loader screen                           215              Dump editor sources to *.f files               216             \                                                                Editor documentation                           220 ...          Editor TODOs                                   240                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ Meta compiler                                                  Meta compiler core                             300 - 304        "generic" language (machine independent part)  310              Endian-neutral memory access                   320 - 321        Executable file formats                        325 ...          Metacompilation template                       345                                                                              Shortcuts for invoking meta-compiler           346                                                                             \ Configurations                                                 Linux/i386                                     500              FreeBSD/i386                                   501              NetBSD/i386                                    502              OpenBSD/i386                                   503                                                                              Linux/ARM                                      510              FreeBSD/ARM                                    511              NetBSD/ARM                                     512              OpenBSD/ARM                                    513                                                                              Linux/x86_64                                   520              FreeBSD/x86_64                                 521              NetBSD/x86_64                                  522              OpenBSD/x86_64                                 523              Darwin/x86_64                                  524                                                                              Linux/SH4                                      525                                                                              Linux/RISC-V                                   526              Linux/RISC-V 64                                527                                                                              Linux/ARM-Cortex                               528                                                                              Linux/m68k                                     529                                                                              Bare PC/i386                                   347              Bare Raspberry PI/arm                          348              Bare LEON GRIP/Sparc                           349                                                                                                                                               (unused: 529-550)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ Platform-specific code                                         Common UNIX I/O primitives                     350              "Bare" I/O primitive stubs                     351              "Bare" PC startup code + minimal I/O           560 ...          "Bare" Raspberry/PI startup code + drivers     570 ...          Sparc/LEON GRIP code + drivers                 580 ...                                                                         \ Architectures                                                  i386                                           380 ...          ARM                                            400 ...          x86_64                                         420 ...          SPARC                                          440 ...          ARM Cortex                                     450 ...          MIPS                                           460 ...          RISC-V                                         470 ...          PowerPC                                        480 ...          68000                                          490 ...          SH4                                            495 ...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ Testing code                                                    Double math                                   900 - 902         Mandelbrot                                    903               Count character frequency                     904               Base 64 encoding/decoding                     905 - 906         Simple benchmark (base64)                     907               Loader screen for tests                       910                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0                                                                             fa - TODOs                                                      ----------                                                                                                                      * TODO backspace: shift left  :#204                             * TODO enter: cr + shiftdown  :#203                             * TODO B1B2B3 mousechord                                          - needs to paste "backwards" from cursor                      * TODO B3 search sometimes does nothing(?)                        - status unclear                                              * TODO X clipboard access                                           include misc/pipe.f                                             : XClip  +selection  selection s" xclip -i -l 1" feed ;       - breaks because subprocess' environment is empty               - "env DISPLAY=:0 xclip ..." may work                         * TODO document (intro, keys, api) :#10                         * TODO extend links to block-position (":#BBB:PPP")               - allow "BBB:PPP" on cmdline                                  * TODO window-resizing sometimes swaps row/col                    - borked csi sequences, gotoxy sequence incomplete            * TODO port to x86_64 + arm, possibly darwin                      - needs sig implementation + system calls :#160                   sys_sigaction, sys_sigreturn, also sa-struct offsets          - sys_ioctl :#170                                             * TODO `nearest` is not quite right when updating the selection   - should take nearest in terms of block-position, not cursor      position                                                    * TODO once it is stable, send to iru.muzgo@gmail.com, C-Keen   * DONE ncopy                                                      - what about overlapping block ranges?                        * TODO check for spurious input sequences with obscure key        combinations                                                  * TODO sometimes mouse input inserts garbage                      - actually on resize, caused by dwm's window mgmt               - probably SIGWINCH while reading mouse event                 * TODO B1 twice at the same position could select word below    * TODO selection disabled underlined text that follows :#203      - needs correct style restore after `showln`                    - use xt-vectors for global/line style                        * TODO never pause when cmd begins with uppercase               * DONE -i option :#214                                          * TODO Option to switch between overwrite/insert mode?          * DONE ^E with cols < 64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back   0 key   \ "ff" sources 10                                                                                                               \ ff core sources - #1 (start)                                                                                                  \ miscellaneous constants                                                                                                       0 constant false                                                -1 constant true                                                32 constant bl                                                  128 constant i-bit      64 constant s-bit                       31 constant len-mask                                                                                                            version 1+ constant version     \ sic                                                                                                                                                           \ some helper words                                                                                                             : on  ( a -- ) true swap ! ;                                    : off  ( a -- ) false swap ! ;                                  1 cells 8 =  [if]  3  [then]                                    1 cells 4 =  [if]  2  [then]                                    1 cells 2 =  [if]  1  [then]  constant cellshift                : cells  ( n1 -- n2 ) cellshift lshift ;                        : bytes  ( n1 -- n2 ) cellshift rshift ;                        : cell+  ( a1 -- a2 ) 1 cells + ;                               : >body  ( cfa -- a2 ) cell+ ;                                  : >loc  ( cfa -- a ) 1 cells - ;                                : aligned  ( a1 -- a2 )                                           [ 1 cells 1- tliteral ] +  [ 1 cells negate tliteral ] and ;                                                                                                                                  \ stack words                                                                                                                   : depth  ( -- n ) s0 @ sp@ - bytes 2 - ;                        : nip  ( x y -- y ) swap drop ;                                 : rot  ( x y z -- y z x ) >r swap r> swap ;                     : -rot  ( x y z -- z x y ) swap >r swap r> ;                    : 2drop  ( x y -- ) drop drop ;                                 : 2dup  ( x y -- x y x y ) over over ;                          : 2nip  ( x y z q -- z q ) rot drop rot drop ;                  : 2swap  ( x y z q -- z q x y ) rot >r rot r> ;                 : ?dup  ( x -- x | x x ) dup dup 0 =  if  drop  then ;          : pick  ( ... n -- x ) ?dup  if  1 + cells sp@ + @  else  dup     then ;                                                        : 2over  ( x y z q -- x y z q x y ) 3 pick 3 pick ;             : 2rot >r >r 2swap r> r> 2swap ;                                : clear  ( ... -- ) s0 @ sp! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev   :#0          \ "ff" sources 10                                                                                                               \ ff core sources - #2                                                                                                                                                                          \ arithmetic                                                                                                                    : /  ( n1 n2 -- n ) /mod nip ;                                  : +!  ( n a -- ) dup @ rot + swap ! ;                           : invert  ( n1 -- n2 ) -1 xor ;                                 : mod  ( n1 n2 -- n ) /mod drop ;                               : 1+  ( n1 -- n2 ) 1 + ;                                        : 1-  ( n1 -- n2 ) 1 - ;                                        : negate  ( n1 -- n2 ) 0 swap - ;                               : 2*  ( n1 -- n2 ) 1 lshift ;                                   : 2/  ( n1 -- n2 ) 1 rshifta ;                                                                                                                                                                  \ comparison                                                                                                                    : >  ( n1 n2 -- f ) swap < ;                                    : u>  ( u1 u2 -- f )  swap u< ;                                 : 0=  ( n -- f ) 0 = ;                                          : 0<  ( n -- f ) 0 < ;                                          : <>  ( x y -- f ) = invert ;                                   : max  ( n1 n2 -- n ) 2dup >  if  drop  else  nip  then ;       : min  ( n1 n2 -- n ) 2dup <  if  drop  else  nip  then ;       : signum  ( n1 -- n2 ) dup 0 >  if  drop 1  else  0<  then ;    : within  ( n lo hi -- f ) over - >r - r> u< ;                  : abs  ( n1 -- n2 ) dup 0<  if  negate  then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 1000           \ "ff" sources 10                                                                                                               \ ff core sources - #3                                                                                                                                                                          \ string operations                                                                                                             : count  ( a -- a n ) 1+ dup 1- c@ ;                                                                                            \ count C-string                                                : zcount  ( a -- a n )                                            dup  begin  dup c@  while  1+  repeat  over - ;                                                                               : compare  ( a1 n1 a2 n2 -- n )                                   rot 2dup >r >r min  0  do                                         over i + c@ over i + c@ - signum ?dup  if                         nip nip  unloop  unloop  exit  then                         loop  2drop r> r> - signum ;                                                                                                  : fill  ( a n c -- ) swap ?dup 0=  if  2drop  exit  then          0  do  2dup swap i + c!  loop  2drop  ;                       : erase  ( a n -- ) 0 fill ;                                    : blank  ( a n -- ) bl fill ;                                                                                                   : cmove  ( a1 a2 u -- )                                           ?dup 0=  if  2drop  exit  then                                  over + swap  do  count i c!  loop  drop ;                                                                                     : cmove>  ( a1 a2 u -- )                                          ?dup 0=  if  2drop  exit  then                                  dup >r rot +  swap r@ +  r> 1+ 1  do                              over i - c@  over i - c!                                      loop  2drop ;                                                                                                                 variable searchlen                                                                                                              : search  ( a1 n1 a2 n2 -- a3 n3 f )                              searchlen !  swap dup >r searchlen @ - 1+  0  do                  over i + over searchlen @ swap searchlen @ compare 0=  if         drop i + i  unloop  r> swap -  true  exit  then             loop  drop  r>  false ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #4                                                                                                                                                                          \ abort                                                                                                                         defer abort                                                                                                                     [defined] target-unicode  [if]                                  \ UTF-8 encoding/decoding                                                                                                       : utfenc  ( a c -- a-1 c>>6 )                                     dup >r 63 and 128 or over c! 1- r> 6 rshift ;                                                                                 : utfencode  ( a c -- a n )                                       dup 128 <  if  over c!  1  exit  then                           dup 2048 <  if  swap 1 + swap utfenc 192 or over c!  2  exit    then                                                            dup 65536 <  if  swap 2 + swap utfenc utfenc 224 or over c!       3  exit  then                                                 swap 3 + swap utfenc utfenc utfenc 240 or over c!  4 ;                                                                        : utfdec  ( a c -- a+1 c2 ) 6 lshift swap 1+ dup c@ 63 and rot    or ;                                                                                                                          : utfdecode  ( a1 -- a2 c )                                       dup c@ dup 128 and  if                                            dup 32 and  if                                                    dup 16 and  if                                                    7 and utfdec utfdec utfdec                                    else                                                              15 and utfdec utfdec                                          then                                                          else                                                              31 and utfdec                                                 then                                                          then                                                            swap 1+ swap ;                                                [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #5                                                                                                                                                                          \ basic I/O                                                                                                                     1 cells buffer: iobuf   \ for holding an UTF character                                                                          create stdin 0 ,        create stdout 1 ,       create eof 0 ,                                                                  defer key           defer type                                                                                                  : (key)  ( -- c|0 )                                               stdin @ iobuf conread 0=  if  drop  eof on  -1  then ;        : (type)  ( a n -- ) stdout @ -rot conwrite ;                   : emit  ( c -- )                                                  iobuf  [defined] target-unicode  [if]  swap utfencode           [else]  c!  iobuf 1  [then]  type ;                           : cr  ( -- ) 10 emit ;                                          : space  ( -- ) bl emit ;                                       : emits  ( c n -- ) begin  ?dup  while  over emit  1-  repeat     drop ;                                                        : spaces  ( n -- ) bl swap emits ;                              : page  ( -- ) 12 emit ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ ff core sources - #6                                                                                                                                                                          \ data area handling                                                                                                            : here  ( -- a ) h @ ;                                          : memtop  ( -- a ) r0 @ 1024 - ;                                : unused  ( -- n ) r0 @ 1024 -  here - ;  \ including pad                                                                       : allot  ( n -- )                                                 dup unused >  if  space s" out of space" type cr abort  then    h +! ;                                                                                                                        : ,  ( n -- )  here !  1 cells allot ;                          : c,  ( c -- ) here c! 1 allot ;                                : pad  ( -- a ) here 256 + aligned ;                            : align  ( -- ) here aligned h ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev    0           \ "ff" sources 10                                                                                                               \ ff core sources - #7                                                                                                                                                                          \ pictured number output                                                                                                        create base 10 ,      variable >num                                                                                             : <#  ( -- ) pad >num ! ;                                                                                                       : #  ( u1 -- u2 )                                                 base @ u/mod swap dup 9 >  if                                     [char] a + 10 -                                               else                                                              [char] 0 +                                                    then  >num @ 1- dup >num ! c! ;                                                                                               : #s  ( u1 -- n2 ) begin  # dup  while  repeat ;                : #>  ( u1 -- a n ) drop >num @ dup pad swap - ;                : hold  ( c -- ) >num @ 1- dup >r c! r> >num ! ;                : sign  ( n -- ) 0<  if  [char] - hold  then ;                  : (u.)  ( u1 -- a u2 ) <# #s #> ;                               : u.  ( u -- ) (u.) type space ;                                : (.)  ( n1 -- a n2 ) dup abs <# #s swap sign #> ;              : .  ( n -- ) (.) type space ;                                  : u.r  ( n1 n2 -- ) >r <# #s #> r> over - 0 max spaces type ;   : .r  ( n1 n2 -- ) >r dup abs <# #s swap sign #> r> over - 0      max spaces type ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #8                                                                                                                                                                          \ numeric parsing                                                                                                               : hex  ( -- ) 16 base ! ;       : decimal  ( -- ) 10 base ! ;                                                                   : digit  ( c -- n -1 | 0 )                                        dup [char] A [char] [ within  if  55 - else  \ 'Z' + 1          dup [char] a [char] { within  if  87 - else  \ 'z' + 1          dup [char] 0 [char] : within  if  48 - else  drop  false exit   \ '9' + 1                                                       then then then  dup base @ <  if  true  else  drop  false       then ;                                                                                                                        : number  ( a n1 -- n2 -1 | a n1 0 )                              swap dup c@ [char] - =  if                                        1+ swap 1- -1 >r  else  swap 1 >r                             then                                                            dup >r 0 swap 0 do base @ * over i + c@ digit  if  +  else        drop unloop r> r> drop false exit                             then  loop r> drop nip r> *  true ;                                                                                                                                                           \ termination                                                                                                                   defer bye                                                                                                                       : (bye)  0 halt ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Xclip 0   \ "ff" sources 10                                                                                                               \ ff core sources - #9                                                                                                                                                                          \ interpretation                                                                                                                variable >in            variable >limit     variable >evlimit   variable sourcebuf      variable blk                                                                                            1024 buffer: tib        256 buffer: wordbuf                     6 constant #input                                                                                                               : source  ( -- a u ) sourcebuf @  >limit @ ;                    : source-id  ( -- id ) >evlimit @  if  -1  else  stdin @ then ; : current-input  ( -- c ) >in @ sourcebuf @ + c@ ;                                                                              : save-input  ( -- <input> )                                      stdin @  >in @  >limit @  sourcebuf @  blk @                    >evlimit @  #input ;                                                                                                          : default-input  ( -- )                                           stdin off  >in off  >limit off  tib sourcebuf !  blk off        >evlimit off ;                                                                                                                : restore-input ( <input> -- f )                                  eof off  #input <>  if  default-input  false                    else  >evlimit !  blk !  sourcebuf !  >limit !  >in !  stdin !    true  then ;                                                                                                                : ?restore-input  ( <input> -- )                                  stdin @ >r  restore-input 0=  if                                  space  s" unable to restore input" type cr                      r> 0=  if  1 halt  else  abort  then                          then  r> drop ;                                                                                                               : input>r                                                         r>  stdin @ >r  >in @ >r  >limit @ >r  sourcebuf @ >r           blk @ >r  >evlimit @ >r  >r ;                                                                                                 : r>input                                                         r>  r> >evlimit !  r> blk !  r> sourcebuf !  r> >limit !        r> >in !  r> stdin !  >r ;                                                                                                    : ?limit  ( -- f ) >in @ >limit @ < ;                                                                                           : next-input  ( -- -1 c | 0 0 )                                   ?limit  if  true  current-input                                 else  0 dup  then ;                                                                                                           : wsfilt  ( c1 -- c2 )                                            dup 13 =  if  drop  bl  exit  then                              dup 10 =  if  drop  bl  exit  then                              dup 9 =  if  drop  bl  then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ ff core sources - #10                                                                                                                                                                         : parse  ( c | ... -- a ) \ note: different from ANS              >r  wordbuf 1+  begin  next-input wsfilt r@ <> and  while         current-input over c! 1+  1 >in +!  repeat                    ?limit  if  1 >in +!  then                                      r> drop  wordbuf dup >r  - 1- r@ c!  r> ;                                                                                     : word  ( c | ... -- a )                                          >r  begin  next-input wsfilt r@ = and  while  1 >in +!  repeat  r> parse ;                                                                                                                    : accept  ( a n1 -- n2 )                                          swap dup >r >r  begin  ?dup  while                                key dup 10 = over -1 = or  if  2drop  r> r> -  exit  then       r@ c!  r> 1+ >r  1-                                           repeat  r> r> - ;                                                                                                             : query                                                           eof off  tib 1024 accept dup 0=  eof @  and  if                 drop  ?restore-input  else  >limit !  >in off  then ;                                                                         : nextline                                                        >in @  dup >limit @ =  if  1+ dup >in !  then                   begin                                                               dup >evlimit @ < 0=  if  >limit !  exit  then                   sourcebuf @ over + c@ 10 <>  while  1+                       repeat  >limit !  ;                                                                                                          : refill  ( -- f )                                                blk @  if  false  exit  then                                    >evlimit @  if  nextline  >in @ >evlimit @ < exit  then         query true ;                                                                                                                  defer findname    ( a1 -- a2 1 | a1 0 ) \ later modified        variable findadr                                                                                                                : >link  ( nfa -- a ) count len-mask and + aligned ;            : >cfa  ( nfa -- a ) >link 2 cells + ;                                                                                          : findnfa  ( a1 dp -- a2 1 | a1 0 )                               swap findadr !  begin  ?dup while                                 dup c@ s-bit and 0=  if   \ not smudged?                          dup count len-mask and  findadr @ count                         len-mask min compare 0=  if  true exit then                   then                                                            >link @                                                       repeat  findadr @  false ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #11                                                                                                                                                                         \ initial "findname" (w/o vocabulary support)                   : (findname)  ( a1 -- a2 1 | a1 0 ) dp @ findnfa ;                                                                              : find  ( a -- a 0 | xt 1 | xt -1 )                               findname  if                                                      dup >cfa  swap c@ i-bit and  if  1                              else  -1  then  exit                                          else  false  then ;                                                                                                           : '  ( | <name> -- xt )                                           bl word find 0=  if  space count type  s"  ?" type cr abort     then ;                                                                                                                        : ?stack  ( ... -- ... )                                          sp@ s0 @ u< 0=  if  s"  stack underflow" type  cr  abort        then ;                                                                                                                        : undefd  ( a u -- ) space  type  s"  ?" type cr  abort ;                                                                       : interpret  ( -- )                                               begin  bl word dup c@  while                                      find  if  execute  ?stack                                       else  count number 0=  if  undefd  then then                  repeat  drop ;                                                                                                                : evaluate  ( a u -- )                                            input>r  >evlimit !  sourcebuf !  >in off  blk off              -1 >limit !                                                     begin  refill  while  interpret  >limit @ 1+ >in !  repeat      r>input ;                                                                                                                     \ bulk evaluate                                                 : bulkread  ( u1 -- a u2 )                                        memtop over - dup >r  over 0  do                                  key over c!  1+  i 1024 mod 0=  if  [char] . emit  then       loop  drop  r> swap ;                                         : transmit  ( u -- ) bulkread evaluate ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ "ff" sources 10                                                                                                               \ ff core sources - #12                                                                                                                                                                         \ defining words                                                                                                                variable current        defer newheader                                                                                         : loc,  blk @ 16 lshift  >in @ or , ;                                                                                           : header  ( a n -- )                                              len-mask min  here dup >r  2dup c!                              over 1+ allot  1+ swap  cmove                                   align  current @ @ ,  loc,  r@ newheader  r> current @ ! ;                                                                    : create  ( | <name> -- )                                         bl word count header  ['] (variable) @ , ;                                                                                    : variable  ( | <name> -- ) create 0 , ;                                                                                        : constant  ( x | <name> -- )                                     create  ['] (constant) @ here 1 cells - ! , ;                                                                                 : .loc  ( pos blk -- ) ." ( " (.) type  ." :" . ." ) " ;        : locate  ( | word -- ) ' 1 cells - @ ?dup 0=  if                   ." no location"  else  dup 65535 and swap  16 rshift .loc     then ;                                                                                                                        \ literals                                                                                                                      : char  ( | <char> -- c )                                         bl word 1+  [defined] target-unicode  [if]  utfdecode nip       [else]  c@  [then] ;                                          : literal  ( x -- ) ['] (lit) , , ;                             : sliteral  ( a n -- )                                            ['] (slit) ,  dup >r c, here r@ cmove  r> allot  align ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ ff core sources - #13                                                                                                                                                                         \ compiler                                                                                                                      variable state                                                                                                                  : immediate  ( -- ) current @ @ dup c@ i-bit or swap c! ;                                                                       : compile  ( a -- )                                               findname  if                                                      dup c@ i-bit and  if  >cfa execute  ?stack                      else  >cfa ,  then                                            else                                                              count number 0=  if  undefd  else literal then                then ;                                                                                                                        : ]                                                               state on  begin                                                   bl word dup c@ 0=  if                                             drop refill                                                   else                                                              compile  state @                                              then                                                          while repeat ;                                                                                                                : [  state off ; immediate                                                                                                                                                                      \ some immediate words                                                                                                          : [char]  ( | <char> -- xc ) char literal ; immediate           : [']  ( | <name> -- cfa ) ' literal ; immediate                                                                                : (  ( | ... <paren> -- )                                         [char] ) parse drop ; immediate                                                                                               \ round >in upwards to 64 bytes if reading from block           : \  ( | <line> -- )                                              blk @  if  >in @ 63 + 63 invert and  >in !                      else  >limit @ >in !  then ; immediate                                                                                        : \s  ( | ... -- ) >evlimit @ ?dup 0=  if  >limit @  then         >in ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #14                                                                                                                                                                         \ colon word definitions                                                                                                        : smudge  current @ @ dup c@ s-bit or swap c! ;                 : reveal  current @ @ dup c@ s-bit invert and swap c! ;                                                                         : :  ( | <name> ... -- )                                          create  smudge  ['] (:) @ here 1 cells - !  ] ;                                                                               : ;  ['] exit ,  state off  reveal ; immediate                  : recurse  current @ @ >cfa , ; immediate                                                                                                                                                       \ string words                                                                                                                  : "  ( | ..." -- a n )                                            [char] " parse count >r here r@ cmove  here r> dup allot ;                                                                    : c"  ( | ..." -- a )                                             [char] " parse dup c@ 1+ >r here r@ cmove  here r> allot ;                                                                    : s"  ( | ..." -- a n )                                           [char] " parse count sliteral ; immediate                                                                                     : ."  ( | ..." -- )                                               [char] " parse count sliteral ['] type , ; immediate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ "ff" sources 10                                                                                                               \ ff core sources - #15                                                                                                                                                                         \ check for redefinitions                                                                                                       variable warnings                                                                                                               : (newheader)  ( a -- )                                           warnings @ 0=  if  drop  exit  then                             dup find if                                                       drop  s"  redefined " type  count type  space                 else  2drop  then ;                                                                                                                                                                           \ conditional abort                                                                                                             : (?abort)  ( f a n -- )                                          rot  if  space type  cr  abort  else  2drop  then ;                                                                           : abort"  ( f | ... " -- )                                        [char] " parse count sliteral  ['] (?abort) , ; immediate                                                                                                                                     \ control structures                                                                                                            : if  ( f -- ) ['] (if) ,  here 0 , ; immediate                 : else  ['] (else) ,  here >r 0 , here swap ! r> ; immediate    : then  here swap ! ; immediate                                 : begin  here ; immediate                                       : again  ['] (else) , , ; immediate                             : until  ( f -- ) ['] (if) , , ; immediate                      : while  ( f -- ) ['] (if) ,  here 0 , ; immediate              : repeat  ['] (else) ,  swap ,  here swap ! ; immediate         : do  ( n1 n2 -- ) ['] (do) ,  0 here ; immediate                                                                               : ?do  ( n1 n2 -- )                                               ['] over ,  ['] over ,  ['] = ,  ['] (if) ,                     here 0 ,  ['] drop dup , ,  ['] (else) ,  here 0 ,              here rot !                                                      ['] (do) ,  here ; immediate                                                                                                  : loop  ['] (loop) , ,  ?dup  if  here swap !  then ; immediate                                                                 : +loop  ( n -- )                                                 ['] (+loop) , ,  ?dup  if  here swap !  then ; immediate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ ff core sources - #16                                                                                                                                                                         \ file I/O                                                                                                                      256 buffer: zpad                                                                                                                : zstring  ( a1 n -- a2 )                                         zpad swap dup >r cmove  0 zpad r> + c!  zpad ;                                                                                : ior  ( n -- ior ) dup 0 >  if  drop  0  then ;                                                                                : open-file  ( a n fam -- fd ior )                                >r  zstring  r> OPEN_MODE fsopen dup ior ;                                                                                    : create-file  ( a n fam -- fd ior )                              >r  zstring  r> O_TRUNC or OPEN_MODE fscreate dup ior ;                                                                       : close-file  ( fd -- ior ) fsclose ior ;                       : read-file  ( a n fd -- n2 ior ) -rot fsread dup ior ;         : write-file  ( a n fd -- ior ) -rot fswrite ior ;              : reposition-file  ( n fd -- ior ) swap fsseek ior ;            : delete-file  ( a n -- ior ) zstring fsunlink ;                                                                                : ?fcheck  ( f -- )                                               dup 0<  if  space  s" I/O error: " type  .  cr  abort then      drop ;                                                                                                                                                                                        \ file interpretation                                                                                                           : include-file  ( fd -- )                                         >r  >limit @ >in !  save-input  default-input                   r>  stdin @ >r  stdin !                                         begin  query  interpret  stdin @ r@ =  until                    r> drop ;     \ eof in `query` restores input                                                                                 : included  ( a u -- )                                            r/o open-file ?fcheck  dup >r include-file                      r> close-file ?fcheck ;                                                                                                       : include  ( | <fname> -- ) bl word count included ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ ff core sources - #17                                                                                                                                                                         \ deferred words                                                                                                                : crash  ( -- ) s" uninitialized execution vector" type cr        abort ;                                                       : defer@  ( xt1 -- xt2 ) >body @ ;                              : defer!  ( xt1 xt2 -- ) >body ! ;                                                                                              : defer  ( | <name> -- )                                          create ['] (defer) @ here 1 cells - !  ['] crash , ;                                                                          : is  ( | <name> -- xt )                                          state @  if                                                       ' literal  ['] defer! ,                                       else                                                              ' defer!                                                      then ; immediate                                                                                                                                                                              \ <builds + does>                                                                                                               variable building                                                                                                               : <builds  ( | <word> -- )                                        create  ['] (does>) @ here 1 cells - !  here building !  0 , ;                                                                : does>  ( -- a ) r> building @ ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Look 0         \ "ff" sources 10                                                                                                               \ ff core sources - #18 (end)                                                                                                   \ command-line access                                                                                                           : #arg  ( -- u ) args @ @ ;                                     : arg  ( u1 -- a u2 ) 1+ cells args @ + @ zcount ;                                                                                                                                              \ interpreter loop and startup code                                                                                             variable h0         variable dp0                                defer startup       defer prompt                                                                                                defer quit  ( ... -- )                                                                                                          : (quit)  ( ... -- )                                              reset  clear                                                    begin  query  interpret  stdin @ 0=  if  prompt  then  again ;                                                                : cold                                                            h0 @ h !  dp0 @ dp !  reset  clear  state off                   default-input  decimal  quit ;                                                                                                : (abort)  ( ... -- ) state off  default-input  quit ;          : (startup)  prompt  (abort) ;                                  : (prompt)  s"  ok" type cr ;                                                                                                                                                                   \ initialize deferred words (startup code may  override these)                                                                  ' (key) is key                                                  ' (type) is type                                                ' (bye) is bye                                                  ' (abort) is abort                                              ' (prompt) is prompt                                            ' (startup) is startup                                          ' (findname) is findname                                        ' (newheader) is newheader                                      ' (quit) is quit                                                                                                                                                                                \ after this, OS-specific startup code follows, and `boot`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0  words                                                                  \ ff stuff - #1                                                                                                                                                                                 \ Fundamental utilities                                                                                                         : @+  ( a1 -- a2 x ) dup cell+ swap @ ;                         : !+  ( a1 x -- a2 ) over ! cell+ ;                             : noop ;                                                        : perform  ( ... a -- ... ) @ execute ;                         : under+  ( n1 x n2 -- n3 x ) rot + swap ;                      : th  ( a1 n -- a2 ) cells + ;                                  : bounds  ( a1 n -- a2 a1 ) over + swap ;                       : ?exit  ( f -- ) if  r> drop  then ;                           : tuck  ( x y -- y x y ) dup >r swap r> ;                       : callback  ( a -- ) >r ;                                       : 0>  ( n -- f ) 0 > ;                                          : 0<>  ( n -- f ) 0 <> ;                                        : >=  ( x y -- ) < 0= ;                                         : <=  ( x y -- ) > 0= ;                                                                                                          \ no, I'm not proud of this ...                                : roll  ( x1 x2 ... xn u -- x2 ... xn x1 )                        1+ dup 2 <=  if  drop  exit  then                               sp@ over cells + dup @ >r  1 cells -       ( ... u a )          swap 1 - 0  ?do  dup @ over cell+ !  1 cells -  loop            2drop  r> ;                                                                                                                                                                                   \ More double words                                                                                                             : 2@  ( a -- x y ) dup cell+ @ swap @ ;                         : 2!  ( x y a -- ) swap over ! cell+ ! ;                        : 2>r  ( x y -- ) r> -rot swap >r >r >r ;                       : 2r>  ( -- x y ) r> r> r> swap rot >r ;                        : 2r@  ( -- x y ) r> r> r> 2dup >r >r swap rot >r ;             : 2variable  ( | <word> -- ) variable  0 , ;                                                                                    : 2constant  ( x y | <word> -- )                                  <builds swap , ,  does>  dup @ swap cell+ @ ;                                                                                 : 2literal  ( x y -- ) swap literal literal ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ ff stuff - #2                                                                                                                 \ interpreter conditionals                                                                                                      : processword  ( n1 a n2 -- n3 )                                  2dup s" [if]" compare 0=  if  2drop 1+ exit  then               2dup s" [else]" compare 0=  if                                      2drop dup 1 =  if  1-  then  exit                           then                                                            s" [then]" compare 0=  if  1-  then ;                                                                                         : skipwords  ( | ... -- )                                         1 begin                                                             bl word dup c@ 0=  if                                             drop refill 0= abort" unexpected end of input"                else                                                              count processword                                             then                                                        ?dup 0=  until ;                                                                                                              : [if]  ( f | ... -- ) 0=  if  skipwords  then ; immediate      : [else]  ( | ... -- ) skipwords ; immediate                    : [then] ; immediate                                            : [defined]  ( | <word> -- f ) bl word find nip ; immediate     : [undefined]  ( | <word> -- f ) bl word find 0= nip ; immediate                                                                                                                                \ Compiling words                                                                                                               : postpone  ( | <word> -- )                                       bl word find dup 0=  if                                           drop  space  count type  true abort" ?"                       then                                                            1 =  if  ,  else  literal ['] , ,  then ; immediate                                                                                                                                           \ Definitions                                                                                                                   : :noname  ( ... -- xt ) here ['] (:) @ , ] ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ ff stuff - #3                                                                                                                                                                                 \ String utilities                                                                                                              : /string  ( a1 n1 n2 -- a2 n3 ) dup >r under+ r> - ;                                                                           : buffer:  ( n | <word> -- ) create allot ;                                                                                     : -trailing  ( a n1 -- a n2 )                                     begin  1- dup 0<  if  1+  exit  then                              2dup + c@ bl <>  until  1+ ;                                                                                                                                                                : scan  ( a1 n1 c -- a2 n2 )                                      >r begin dup 0=  if  r> drop  exit then                           over c@ r@ <>  while  1 /string                               repeat  r> drop ;                                                                                                             : skip  ( a1 n1 c -- a2 n2 )                                      >r begin dup 0=  if  r> drop  exit then                           over c@ r@ =  while  1 /string                                repeat  r> drop ;                                                                                                             : split  ( a1 n1 c -- a2 n2 a1 n3 )                               >r 2dup r> scan 2swap 2 pick - ;                                                                                              : place  ( a1 n a2 -- ) 2dup >r >r 1+ swap cmove r> r> c! ;     : string,  ( a n -- ) here over 1+ allot place ;                : ,"  ( | ..." -- ) [char] " parse count string, ;                                                                                                                                              \ Platform-independent 32-bit access                                                                                            1 cells 4 =  [if]                                               : i32@  ( a -- x ) @ ;          : i32!  ( x a -- ) ! ;          [else]  [defined] big-endian  [if]                              : i32@  ( a -- x ) count 24 lshift  swap count 16 lshift          swap count 8 lshift  swap c@ or or or ;                       : i32!  ( x a -- ) swap dup >r 24 rshift over c!  1+              r@ 16 rshift over c!  1+ r> 8 rshift over c!  1+ r> swap c! ;  [else]                                                         : i32@  ( a -- x ) count  swap count 8 lshift  swap count         16 lshift  swap c@ 24 lshift or or or ;                       : i32!  ( x a -- ) swap dup >r over c!  1+ r@ 8 rshift over c!    1+ r@ 16 rshift over c!  1+ r> 24 rshift swap c! ;            [then] [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ ff stuff - #5                                                                                                                                                                                 \ system operations                                                                                                             [defined] sys_nanosleep  [if]                                   2variable sleepbuf  \ [secs nsecs]                              : ms  ( u -- )                                                    1000 /mod sleepbuf !  1000000 * sleepbuf cell+ !                sleepbuf 0 sys_nanosleep syscall2  drop ;                     [else]                                                          : ms  ( u -- ) ;                                                [then]                                                                                                                                                                                          \ Random numbers                                                \ http://excamera.com/sphinx/article-xorshift.html                                                                              variable seed   7 seed !                                                                                                        : random    ( -- x )  \ return a 32-bit random number x           seed @                                                          dup 13 lshift xor                                               dup 17 rshift xor                                               dup 5  lshift xor                                               dup seed ! ;                                                                                                                  : randomize  ( -- )                                               s" /dev/urandom" r/o open-file ?fcheck                          dup pad 4 rot read-file ?fcheck drop pad @ seed !               close-file drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0                                                                             \ ff stuff - #6                                                                                                                                                                                 \ Display tools                                                                                                                 : .s  ( ... -- ... )                                              depth ?dup 0= if                                                    ." stack empty "                                            else                                                                dup 0  do  dup i -  pick .  loop  drop                      then ;                                                                                                                        : ?  ( a -- ) @ . ;                                                                                                             : dumpascii  ( a n -- )                                           0 do                                                              count dup 33 128 within 0=  if  drop  183  then                 emit                                                          loop  drop ;                                                  : dumpbyte  ( u -- ) dup 16 <  if   [char] 0 emit  then  . ;    : dump  ( a n -- )                                                base @ >r  hex  dup >r  0  ?do                                    i 16 mod dup 0= if                                                i 0 > if  over 16 dumpascii  16 under+  then                      cr  2dup + 8 u.r  space  then                               over + c@ dumpbyte                                            loop  r> 16 mod ?dup 0=  if  16                                 else  16 over - 3 * spaces  then                                dumpascii  r> base !  cr ;                                                                                                    : .(  [char] ) parse count type ; immediate                                                                                                                                                     \ case/of                                                       \ http://www.calcentral.com/~forth/forth/eforth/e4.src/LIB.SHTML                                                                0 constant case ( -- 0 ) immediate                                                                                              : of ( -- sys )                                                   postpone over postpone = postpone if postpone drop ; immediate                                                                : endof ( sys -- sys ) postpone else ; immediate                                                                                : esac ( 0 i*sys -- )                                             begin  ?dup while postpone then  repeat ;                                                                                     : endcase ( 0 i*sys -- ) postpone drop  esac ; immediate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ ff stuff - #7                                                                                                                                                                                 \ memory-mapped files + memory                                                                                                  1 constant MAP_SHARED    2 constant MAP_PRIVATE                 1 constant PROT_READ     2 constant PROT_WRITE                                                                                  8 cells buffer: mmargs   \ 6 + 2 cells for 64-bit off_t         mmargs off                                                                                                                      [defined] sys_mmap64  [if]  \ BSD                               : fsmmap  ( a -- n ) sys_mmap64 syscall8 ;                      [then]                                                          [defined] sys_mmap2 [if]                                        : fsmmap  ( a -- n ) sys_mmap2 syscall6 ;                       [then]                                                          [defined] sys_mmap [if]                                         : fsmmap  ( a -- n ) sys_mmap syscall6 ;                        [then]                                                                                                                          [defined] sys_munmap  [if]                                      : fsmunmap  ( a n1 -- n2 ) sys_munmap syscall2 ;                [then]                                                                                                                          [undefined] fsmmap  [if]                                        : fsmmap 2drop -1 ;                                             : fsmunmap 2drop -1 ;                                           [then]                                                                                                                          : mmaccess  ( acc -- mmacc )                                      case                                                                w/o of  PROT_WRITE  endof                                       r/o of  PROT_READ  endof                                        PROT_READ PROT_WRITE or swap                                endcase ;                                                                                                                     : mmior  ( ptr -- a ior )                                         dup abs 256 >  if  0  else  -1  then ;                                                                                        : map-file  ( fd acc size offset -- a ior )                     [defined] sys_mmap64  [if]                                        [defined] big-endian  [if]  0  [else]  0 swap  [then]           mmargs 7 th !  mmargs 6 th !    \ 64-bit off_t                [else] [defined] sys_mmap2  [if]                                    12 rshift                                                     [then]                                                            mmargs 5 th !         \ offset                                [then]                                                        [then]                                                            mmargs cell+ swap !+            \ size                          swap mmaccess !+  MAP_SHARED !+  !  \ prot, flags, fd           mmargs fsmmap mmior ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                              \ ff stuff - #8                                                                                                                                                                                 : unmap-memory  ( a size -- ior ) fsmunmap ;                                                                                    [defined] bsd  [if]  4096  [else]  32  [then]                     constant MAP_ANONYMOUS                                                                                                        : map-memory  ( size -- a ior )                                   mmargs cell+ swap !+  PROT_READ PROT_WRITE or !+                \ addr(0), size, prot                                           MAP_ANONYMOUS MAP_PRIVATE or !+  -1 !+  off \ flags, fd, off    mmargs fsmmap mmior ;                                                                                                                                                                         \ file-info access                                                                                                              256 buffer: statbuf                                                                                                             : file-size  ( fd -- n ior )                                      statbuf 256 fsstat drop  statbuf stat>size + @  0 ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ ff stuff - #9                                                                                                                                                                                 \ Vocabularies                                                                                                                  8 constant maxvocs                                                                                                              maxvocs cells buffer: vocs      variable >vocs                  vocs maxvocs cells + constant voctop                            here ," forth" align create forthwords 0 , ,                    dp constant dpboot  \ used in unexec-*.f                         \ voc: [link nameptr]                                                                                                          : context  ( -- a ) >vocs @ ;                                                                                                   : vocabulary  ( | <name> -- )                                     here  <builds  0 , ,  does>  context ! ;                                                                                      : (words:)  ( wa ra -- )                                          swap  begin  ?dup  while  dup >r  over callback                   r> >link @  repeat  drop ;                                                                                                  : words:  ( | ... -- )                                            r>  voctop context  do                                            i @ @ over (words:)                                           1 cells  +loop  drop ;                                                                                                        : .word  ( a -- ) count len-mask and type space ;               : words  words:  .word ;                                                                                                        2variable 'sifting                                              : sifting  ( | <word> -- )                                        bl word count 'sifting 2!                                       words:  dup count len-mask and 'sifting 2@ search  if             2drop .word  else  2drop drop  then ;                                                                                       : dp  ( -- a ) forthwords ;     \ reimplemented                 : only  ( -- ) voctop 1 cells - dup >vocs ! forthwords swap ! ;                                                                 : order  ( -- )                                                   voctop context  do                                                i @ dup cell+ @ count type                                      current @ =  if  [char] * emit  then                            space                                                         1 cells  +loop ;                                                                                                              : also  ( -- )                                                    context dup vocs = abort" too many wordlists"                   dup @ >r 1 cells - >vocs ! r> context ! ;                                                                                     : previous  ( -- )                                                context cell+ dup voctop <  if  >vocs !  else  drop  then ;                                                                   : definitions  ( -- ) context @ current ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ ff stuff - #10                                                                                                                                                                                : vfindname  ( a1 -- a2 1 | a1 0 )                                context  begin                                                    dup voctop <>  while                                            dup >r @ @ findnfa  if  r>  drop  true  exit  then              r> cell+                                                      repeat  drop false ;                                                                                                          : forget  ( | <word> -- )                                         bl word current @ @ findnfa  if                                   >link dup @ current @ !  h !                                  else                                                              space  count type  true abort" ?"                             then ;                                                                                                                        : vocs,  ( -- )                                                   context voctop over - 1 cells / dup , 0  do                       dup i cells + @ dup , @ ,                                     loop  drop current @ dup , @ , ;                                                                                              : vocs@  ( a1 -- a2 )                                             @+ dup >r cells voctop swap - >vocs !                           r> 0  do                                                            @+ context i cells + dup >r ! @+ r> @ !                     loop  @+ current ! @+ current @ ! ;                                                                                           : marker  ( | <word> -- )                                         <builds  vocs, here cell+ ,   \ skip this actual cell           does>  vocs@ @ h ! ;                                                                                                          : forth  ( -- ) forthwords context ! ;                                                                                          \ fixup "forth" vocabulary and initialize                       :noname                                                           forthwords cell+ @ (findname) drop forthwords !                 ['] vfindname is findname                                       forthwords current !  only ; execute                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                              \ ff stuff - #11                                                                                                                                                                                \ Structures - taken from forth-standard.org                    : begin-structure  \ -- addr 0 ; -- size                           <builds                                                           here 0 0 ,      \ mark stack, lay dummy                       does> @ ;            \ -- rec-len                            : end-structure  \ addr n --                                       swap ! ;          \ set len                                  : +field  \ n <"name"> -- ; exec: addr -- 'addr                    <builds over , +  does> @ + ;                                : field:    ( n1 "name" -- n2 ; addr1 -- addr2 ) aligned 1 cells  +field ;                                                      : cfield:   ( n1 "name" -- n2 ; addr1 -- addr2 ) 1   +field ;                                                                                                                                   \ base-independent literals                                                                                                     : (d/h#)  ( b | <number> -- n )                                   bl word count number 0= abort" bad number syntax"               state @  if  literal  else  swap  then  base ! ;                                                                              : d#  ( | <number> -- n ) base @  decimal  (d/h#) ; immediate   : h#  ( | <number> -- n ) base @  hex  (d/h#) ; immediate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                \ ff stuff - #12                                                                                                                                                                                [defined] utfencode  [if]                                       \ UTF8-aware parse                                              4 buffer: utfbuf    variable utflen     variable utfp1                                                                          : utffound  ( a -- )                                              utfp1 @ - utfp1 @ over wordbuf @ place                          utflen @ + >in +! ;                                                                                                           : utfremaining  ( a -- )                                          >limit @ >in @ - wordbuf @ place  >limit @ >in ! ;                                                                            : utfparse  ( c | ... -- a )                                      utfbuf swap utfencode utflen !  drop                            sourcebuf @ >in @ + dup utfp1 !  >limit @ >in @ -               utfbuf utflen @  search                                         nip  if  utffound  else  utfremaining  then                     wordbuf @ ;                                                   [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                              \ ff stuff - #13                                                                                                                                                                                \ system(3)                                                                                                                     [defined] sys_execve  [if]                                      4 cells buffer: systemargs      variable systemenv                                                                              : fork  ( -- pid|0 )                                              [defined] (fork)  [if]  (fork)  [then]                          [defined] sys_fork  [if]  sys_fork syscall0  [then]             [defined] sys_clone  [if]  SIGCHLD 0 sys_clone syscall2         [then] ;                                                                                                                      : execve  ( args env -- |ior ) over @ -rot sys_execve syscall3    ior ;                                                                                                                         : wifexited  ( status -- f ) h# 7f and 0= ;                     : wexitstatus  ( status -- u ) 8 rshift 255 and ;                                                                               variable waitstatus                                                                                                             : waitpid  ( pid -- status ior )                                  waitstatus 0 0 sys_wait4 syscall4 dup 0<  if  0 swap  exit      then                                                            drop  waitstatus @ dup wifexited  if  wexitstatus  0            else  -1  then ;                                                                                                              here  ," /bin/sh" 0 c,  1+ systemargs !                         here  ," -c" 0 c,  1+ systemargs 1 th !  0 systemargs 3 th !                                                                    : exec  ( a u -- )                                                zstring systemargs 2 th !                                       systemargs  dup 3 th  execve ;                                                                                                : system  ( a u -- status )                                       fork ?dup  if  nip nip  waitpid abort" waitpid failed"          else  exec  true abort" execve failed"  then ;                [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                              \ ff stuff - #14 (end)                                                                                                                                                                          \ catch/throw                                                                                                                   variable handler        handler off                                                                                             : catch  ( xt -- exn | 0 )                                        sp@ >r  handler @ >r  rp@ handler !                             execute  r> handler !  r> drop  0 ;                                                                                           : throw  ( ... n -- ... | ... n )                                 ?dup  if                                                          handler @ dup 0= abort" no handler"                             rp!  r> handler !  r> swap >r  sp!  2drop  r>                 then ;                                                                                                                                                                                        \ convenience conditionals                                                                                                      : unless  ( f -- ) postpone 0=  postpone if  ; immediate        : ->  ( x y -- | x )  postpone over  postpone =  postpone if      postpone drop ; immediate                                     : |  postpone exit  postpone then ; immediate                                                                                                                                                   \ tail recursion                                                                                                                : -;  here 1 cells - dup @ >r  ['] (else) swap !  r> >body        ,  postpone ; ; immediate                                                                                                                                                                     \ base address of image                                                                                                         ' (variable) @ h# fff invert and constant imgbase                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev    0           \ ff sources 10                                                                                                                 \ decompiler - #1                                                                                                               .( decomp )                                                                                                                     vocabulary decompiler                                           only forth  also decompiler definitions                                                                                                                                                         : (rfind)  ( cfa dp -- a|0 )                                      begin  ?dup  while                                                dup >r >cfa over =  if  drop  r>  exit  else  r> >link @        then                                                          repeat  drop  false ;                                                                                                         variable rfindcfa                                               : rfind  ( cfa -- a|0 )                                           rfindcfa ! context  begin                                         dup voctop <> while                                             >r rfindcfa @ r@ @ @ (rfind) ?dup  if  r> drop exit  then       r> cell+                                                      repeat drop false ;                                                                                                           : ?rfind  ( cfa -- a )                                            dup rfind ?dup  if  nip  else                                     ."  execution token not found: " . cr  true abort             then ;                                                                                                                        256 constant maxfwdjmps                                         maxfwdjmps cells buffer: fwdjmps                                variable #fwdjmps                                                                                                               : recbranch  ( a ba -- a )                                        2dup < if                                                         fwdjmps #fwdjmps @                                              dup maxfwdjmps > abort" too many forward branches"              th !  1 #fwdjmps +!                                           else  drop  then ;                                                                                                            : nofwdjmps?  ( a -- f )                                          #fwdjmps @  0  ?do                                                fwdjmps i th @ over >  if  drop false unloop exit  then       loop  drop true ;                                                                                                             : (findend)  ( a1 -- a2 f )                                       dup @  case                                                       ['] exit  of  dup nofwdjmps?  endof                             ['] (if)  of  cell+ dup @ recbranch  false  endof               ['] (else)  of  cell+ dup @ recbranch  false  endof             ['] (loop)  of  cell+  false   endof \ assumes branch bwd       ['] (+loop)  of  cell+  false  endof \ "                        ['] (lit)  of  cell+  false  endof                              ['] (slit)  of  cell+ count + aligned 1 cells -  false            endof                                                         false swap                                                    endcase  1 cells under+ ;                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ ff sources 10                                                                                                                 \ decompiler - #2                                                                                                                                                                               : findend  ( a1 -- a2 )                                           #fwdjmps off  begin  (findend)  until ;                                                                                       : .name  ( a -- ) count len-mask and type ;                     : .name'  ( a -- ) dup .name  c@ i-bit and  if  ."  (immediate)"  then ;                                                                                                                        : see-op  ( a1 -- a2 )                                            dup 8 u.r space dup @ dup rfind ?dup 0=  if  ." ??? " .         else                                                              .name space  case                                                 ['] (if)  of  cell+ dup @ .  endof                              ['] (else)  of  cell+ dup @ .  endof                            ['] (loop)  of  cell+ dup @ .  endof                            ['] (+loop)  of  cell+ dup @ .  endof                           ['] (lit)  of  cell+ dup @ decimal . hex  endof                 ['] (slit)  of  cell+ [char] " emit count 2dup type               [char] " emit  space  + aligned 1 cells -                     endof                                                         endcase                                                       then  cell+ ;                                                                                                                 : see-code  ( addr -- )                                           dup findend swap  begin  see-op cr  2dup <= until  2drop ;    : see-(:)  ( cfa -- )                                             ?rfind ." : " dup .name' cr  >cfa >body see-code ;                                                                            : see-(variable)  ( cfa -- )                                      ?rfind ." variable " dup .name' space >cfa dup [char] @ emit    .  ." = "  cell+ @ decimal . hex cr ;                                                                                         : see-(constant)  ( cfa -- )                                      ?rfind ." constant " dup .name' ."  = " >cfa >body @            decimal . hex cr ;                                                                                                            : see-(does)  ( cfa -- )                                          ?rfind ." does> " dup .name' space >cfa >body dup @ swap        [char] @ emit                                                   . cr see-code ;                                                                                                               : see-(deferred)  ( cfa -- )                                      ?rfind ." defer " dup .name' ."  = " >cfa >body @ dup rfind     ?dup if .name drop                                              else  ." ??? " .  then cr ;                                                                                                   : see-primitive  ( cfa -- ) ." primitive " . cr ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ ff sources 10                                                                                                                 \ decompiler - #3 (end)                                                                                                                                                                         ' (:) @        constant x(:)                                    ' (variable) @ constant x(variable)                             ' (constant) @ constant x(constant)                             ' (does>) @     constant x(does)                                ' (defer) @ constant x(deferred)                                                                                                variable where-xt                                               : scancode  ( wa a1 a2 -- )                                       dup >cfa dup @ x(:) <>  if  2drop  exit  then                     >body  dup findend swap  do                                       i @ where-xt @ =  if  unloop  .name space  exit  then         loop  drop ;                                                                                                                only forth definitions also decompiler                                                                                          : (see)  ( addr -- ) base @ swap hex  see-code  base ! ;        : seeloc  ( cfa -- pos blk ) >loc @ dup h# ffff and               swap 16 rshift ;                                              : see  ( | <word> -- )                                            base @ >r                                                       ' dup dup seeloc .loc  hex  @ case                                x(:)  of  see-(:)  endof                                        x(variable)  of  see-(variable)  endof                          x(constant)  of  see-(constant)  endof                          x(does)  of  see-(does)  endof                                  x(deferred)  of  see-(deferred)  endof                          dup see-primitive                                             endcase                                                         r> base ! ;                                                                                                                   : (where)  ( xt -- ) where-xt !  words:  scancode ;             : where  ( | <word> -- )                                          bl word find  if  (where)  else                                 count type  ."  ? " cr  abort  then ;                                                                                         previous                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ ff sources 10                                                                                                                 \ debugger - #1                                                                                                                 \ requires: decomp                                                                                                              .( dbg )                                                                                                                        vocabulary debugger                                             also debugger definitions                                       also decompiler  \ for "see-op"                                                                                                 1024 constant /rsp                                              /rsp cells buffer: rstack                                                                                                       variable rsp        variable ip                                 variable debugging                                              variable en-cont-stop   variable cont-stop  variable tracing                                                                    en-cont-stop off    tracing off                                                                                                 : +debugging  ( -- ) debugging @ 0= abort" not debugging" ;     : rpush  ( x -- ) rsp @ ! 1 cells rsp +! ;                      : rpop  ( -- x ) 1 cells negate rsp +! rsp @ @ ;                : rtop  ( -- x ) rsp @ 1 cells - @ ;                            : dbgstop  ( -- ) ['] (prompt) is prompt  debugging off ;                                                                       : doexit  ( -- )                                                    rsp @ rstack =  if                                                  dbgstop  ." DEBUG: done" cr  abort                          then                                                            rpop dup ip !                                                   cont-stop @ =  if  cont-stop off  then ;                                                                                    : docond  ( f -- ) 0=  if ip @ cell+ @ ip ! else  2 cells ip +!   then ;                                                                                                                        : doloop  ( n -- )                                                  rsp @ 2 cells - dup >r +!                                       r> rtop < if                                                        ip @ cell+ @ ip !                                           else                                                                2 cells ip +!                                               then ;                                                                                                                      : advance  ( -- ) 1 cells ip +! ;                               : dolit  ( -- x ) ip @ cell+ @  2 cells ip +! ;                 : doslit  ( -- a n )                                              ip @ cell+ count dup aligned cell+ ip +! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ ff sources 10                                                                                                                 \ debugger - #2                                                                                                                                                                                 defer dbg-cont                                                                                                                  : push-ip  ( new-ip -- )                                            ip @ rpush  ip !                                                en-cont-stop @  if                                                  en-cont-stop off                                                rtop cont-stop !  dbg-cont                                  then ;                                                                                                                      : doexec  ( xt -- )                                                 dup @ case                                                          [ ' (:) @ literal ]  of                                             cell+ push-ip                                               endof                                                           [ ' (defer) @ literal ]  of                                         cell+ @ recurse exit                                        endof                                                           [ ' (does>) @ literal ]  of                                         cell+ @+ push-ip                                            endof                                                           drop execute  exit                                          endcase ;                                                                                                                   : .debug  ( -- )                                                    base @ >r  #fwdjmps off  \ for "see-op"                         ." DEBUG: ("  rsp @ rstack - 2/ 2/ (.) type ." ) "              hex  ip @ see-op drop  ." | "  r> base !  .s  cr ;                                                                          : dbg-step  ( -- )                                                  +debugging                                                      tracing @  if  .debug  then                                     ip @ @ case                                                         ['] exit  of  doexit  endof                                     ['] (if)  of  docond  endof                                     ['] (else)  of  ip @ cell+ @ ip !  endof                        ['] (do)  of  rpush rpush  advance  endof                       ['] (loop)  of  1 doloop  endof                                 ['] (+loop)  of  doloop  endof                                  ['] (lit)  of  dolit  endof                                     ['] (slit)  of  doslit  endof                                   ['] unloop  of  2 cells negate rsp +!  advance  endof           ['] execute  of  advance  doexec  endof                         ['] i  of  rsp @ 2 cells - @  advance  endof                    ['] j  of  rsp @ 4 cells - @  advance  endof                    ['] r>  of  rpop  advance  endof                                ['] >r  of  rpush  advance  endof                               ['] r@  of  rtop  advance  endof                                ['] rp@  of  rsp @  advance  endof                              ['] rp!  of  rsp !  advance  endof                              ['] reset  of  rstack rsp !  reset  endof \ ?                   advance  doexec  exit                                       endcase ;                                                                                                                   : (dbg-cont)  ( -- ) begin  dbg-step  cont-stop @ 0= until ;    ' (dbg-cont) is dbg-cont                                        : debug-prompt  ( -- ) cr .debug ;                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ ff sources 10                                                                                                                 \ debugger - #3 (end)                                                                                                                                                                           : debuggable  ( xt1 -- xt2 )                                        dup @ case                                                          [ ' (:) @ literal ]  of endof                                   [ ' (defer) @ literal ]  of  cell+ @ recurse  endof             [ ' (does>) @ literal ]  of  cell+ @+ 1 cells -  endof          dbgstop  true abort" can not debug word"                    endcase ;                                                                                                                   : debug-word  ( xt -- ) debuggable  rstack rsp !  cell+ ip ! ;                                                                  : skipcall  ( -- )                                                  +debugging  en-cont-stop on  dbg-step  en-cont-stop off ;                                                                   : q  ( -- ) +debugging  dbgstop  previous ;                                                                                     : s  ( -- ) +debugging  tracing off  en-cont-stop off             dbg-step ;                                                                                                                    : n  ( -- ) tracing off  skipcall ;                             : t  ( -- ) tracing on  skipcall ;                                                                                              : .rs  ( -- ) +debugging                                            rstack rsp @ =  if  ." return stack empty " exit then           rstack begin  dup rsp @ < while  dup @ . cell+  repeat          drop ;                                                                                                                      also forth definitions                                                                                                          : debug  ( | <word> -- )                                          ['] debug-prompt is prompt  debugging on  '                     also debugger  debug-word ;                                                                                                   only forth definitions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  Back 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ signal handling                                                                                                               .( sig )                                                                                                                        2 constant SIGINT               28 constant SIGWINCH                                                                            0 constant SIG_DFL              1 constant SIG_IGN                                                                              32 cells buffer: signals    signals 32 cells erase                                                                              [defined] linux  [if]                                             [defined] i386  [if]  550 load  [then]                          [defined] x86_64  [if]  551 load  [then]                        [defined] arm  [if]  552 load  [then]                         [then]                                                                                                                          [defined] darwin  [defined] bsd or  [if]                          [defined] x86_64  [if]  553 load  [then]                      [then]                                                                                                                          : ignore-signal  ( sig -- ) SIG_IGN sabuf sa.handler !            sigaction ;                                                   : handle-signal  ( sig -- ) sighandler sabuf                      sa.handler !  sigaction ;                                     : default-signal  ( sig -- ) SIG_DFL sabuf sa.handler !           sigaction ;                                                   : signal?  ( sig -- f ) signals swap th dup @  swap off ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ terminal operations                                                                                                                                                                           .( term )                                                                                                                       [defined] x86_64  [defined] linux and  [if]  16  [else]          [defined] darwin  [if]  h# 2000036  [else]  54  [then] [then]   constant sys_ioctl                                                                                                             [defined] linux  [if]  21523  [else]  1074295912  [then]          constant TIOCGWINSZ                                                                                                           begin-structure /winsize                                          field: ws.rowcol      field: ws:xy                            end-structure                                                                                                                   /winsize buffer: winsize                                        : termsize  stdin @  TIOCGWINSZ winsize sys_ioctl syscall3       ?fcheck ;                                                      : rows  ( -- u ) winsize ws.rowcol i32@ h# ffff and ;           : cols  ( -- u ) winsize ws.rowcol i32@ 16 rshift h# ffff and ; create csiseq 27 c, char [ c,        : csi  csiseq 2 type ;     : .param  ( u -- ) base @ swap decimal (.) type  base ! ;       : mouseon  csi  ." ?1003h" ;                                    : mouseoff  csi  ." ?1003l" ;                                   : bold  csi  ." 1m" ;            : underline  csi  ." 4m" ;     : reverse  csi  ." 7m" ;         : normal  csi  ." m" ;         : fg  ( c -- ) csi  ." 38;5;"  .param  ." m" ;                  : bg  ( c -- ) csi  ." 48;5;"  .param  ." m" ;                  : raw  s" stty raw -echo" system drop ;                         : cooked  s" stty cooked echo" system drop ;                    : defaults  mouseoff  cooked ;                                  : gotoxy  ( r c -- )  csi  swap 1+ .param  ." ;"  1+ .param       ." H" ;                                                       : cls  csi  ." 2J"  0 0 gotoxy ;                                : clln  csi  ." 0K" ;                                           : altbuf  csi ." ?47h" ;        : stdbuf  csi ." ?47l" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev   0                                                                            \ "glob"-style string pattern matching                                                                                          defer rmatch   ( pa pu -- f )                                   2variable mstate                                                                                                                : mlen  ( -- u ) mstate @ ;                                     : fetch  ( a1 u1 -- a2 u2 c ) over c@ >r  1 /string  r> ;       : next  ( -- c ) mstate 2@ fetch -rot  mstate 2! ;              : empty  ( -- f )  mlen 0= ;                                    : mcont  ( pa pu -- f ) 2r> 2drop  rmatch ;                     : match1  ( pa pu c -- f ) empty  if  r> 2drop 2drop  false  |    next =  if  mcont  |  2drop  false ;                          : match?  ( pa pu -- f ) empty  if  r> drop  2drop  false  |      next drop  mcont ;                                            : match*  ( pa pu -- f ) ?dup 0=  if  drop  true  |               begin  mstate 2@  2over rmatch  if  2drop  2drop  true  |         mstate 2!  next drop  again ;                                                                                               : setfetch  ( pa pu c1 -- pa' pu' c1 c2 )                         >r  over c@ >r  1 /string  r> r> swap ;                       : setskip  ( pa pu -- pa' pu' )                                   [char] ] scan  ?dup 0= abort" missing ]"  1 /string ;         : (match[-])  ( pa pu c1 c2 -- pa' pu' f )                        2>r  dup 2 < abort" invalid pattern"                            fetch  2r> rot 1+ within ;                                    : (match[])  ( pa pu c1 c2 -- pa' pu' f )                         2>r  over c@  [char] - =  if  1 /string  2r>  (match[-])        else  2r> =   then  if  setskip  true  |  false ;             : match[]  ( pa pu -- f ) next                                    begin  dup >r  over 0=  abort" bad pattern"                       setfetch  [char] ]  ->  r> 2drop 2drop  false  |                (match[])  if  2r> 2drop  rmatch  |  r>  again ;                                                                            : domatch  ( pa pu -- f ) r> drop  fetch                          [char] *  ->  match*   |                                        [char] [  ->  match[]  |                                        [char] ?  ->  match?  |  match1 ;                                                                                             : (rmatch)   ( pa pu -- f )                                       ?dup 0=  if  drop  empty  |  domatch ;                                                                                        ' (rmatch) is rmatch                                                                                                            : match  ( a u pa pu -- f ) 2swap mstate 2! rmatch ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Look 0    \ "ff" sources 10                                                                                                               \ executing subprocesses                                                                                                        .( pipe )                                                                                                                                                                                       [defined] x86_64  [defined] linux and  [if]                     22 constant SYS_PIPE   33 constant SYS_DUP2                     [else]                                                          42 constant SYS_PIPE                                            [defined] darwin  [defined] bsd or  [if]  90  [else]  63  [then]  constant SYS_DUP2                                             [then]                                                                                                                          : dupfd  ( fd1 fd2 -- ior ) SYS_DUP2 syscall2 ior ;             : pipe  ( a -- ior ) SYS_PIPE syscall1 ior ;                    2variable ipipe    2variable opipe                              : close  ( fd -- ) close-file drop ;                            : pclose  ( a -- ) dup i32@ close  4 + i32@ close ;             : redir  ipipe i32@ stdin @ dupfd ?fcheck                         opipe 4 + i32@ stdout @ dupfd ?fcheck                           ipipe pclose  opipe pclose ;                                  : runchild  ( a u -- 0 0 0 -1 ) redir  exec >r  0 0 0  r> ;     : runparent  ( a u pid -- fdin fdout pid ior )                    ipipe i32@ close  opipe 4 + i32@ close                          >r  2drop  opipe i32@  ipipe 4 + i32@ r> 0 ;                  : run  ( a u -- fdrd fdwr pid ior )                               ipipe pipe ?fcheck  opipe pipe ?fcheck                          fork ?dup 0=  if  runchild  else  runparent  then ;           : runclose  ( fd1 fd2 pid -- status ior ) -rot  close  close      waitpid ;                                                     2variable cbuf      variable cpid                               : endrun  ( fd -- status ior ) close  cpid @ waitpid ;          : abortrun  ( fd -- ) endrun 2drop ;                            : capture  ( a1 u1 a2 u2 -- u3 status ior )  \ buf cmd -> len     2swap cbuf 2!  run ?dup  if  >r  2drop 0  r>  |                 ( fdrd fdwr pid ) cpid !  close  dup  cbuf 2@ rot read-file     ?dup  if  >r  abortrun  0 r>  |                                 >r  endrun  r> -rot ;                                         : 5drop  2drop 2drop drop ;                                     : feed  ( a1 u1 a2 u2 -- status ior )  \ buf cmd                  run ?dup  if  >r  5drop  0  r> |                                cpid !  swap close  dup >r  write-file ?dup  if  r> abortrun      0  |  r>  endrun ;                                          : process  ( a1 u1 a2 u2 a3 u3 -- u4 status ior ) \ str buf cmd   2swap cbuf 2!  run ?dup  if  >r  5drop  0 r>  |                 ( a1 u1 fdrd fdwr pid ) cpid !  swap >r  dup >r  write-file     ?dup  if   r> close  r> abortrun  0 0 rot  |                    r> close  cbuf 2@ r@ read-file ?dup  if  nip  r> abortrun       0 0 rot  |  r> endrun ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Snarf Cut Paste Exit Pause Next Prev Back Look 0  max-b  \ "ff" sources 10                                                                                                               \ Line-oriented block editor #1                                                                                                 .( led )                                                                                                                        vocabulary editor  also editor definitions                                                                                      64 constant /line       64 constant blocklines                  blocklines 1- constant maxrow                                   /line blocklines * constant /block                                                                                              variable row        variable column                             variable findbuf    variable insertbuf                          variable findbuf#   variable insertbuf#                         variable relist                                                                                                                 /line buffer: fbuf    fbuf findbuf !                            /line buffer: ibuf    ibuf insertbuf !                                                                                          relist on                                                                                                                       : lines  ( n1 -- n2 ) /line * ;                                 : >line  ( -- ) scr @ block row @ lines + ;                     : eotib?  ( -- f ) >limit @ >in @ <= ;                          : .row  ( u -- ) 2 .r ." :" ;                                   : (.line)  ( a r -- ) .row /line   -trailing  type cr ;         : .line  ( -- ) relist @ 0= eotib? 0= or ?exit                    cr  >line row @ (.line)  column @ 3 + spaces  ." ^ ("           /line column @ - (.) type  [char] ) emit ;                                                                                    : #tib  ( -- n ) >limit @ >in @ - ;                             : emptytib  ( -- ) >limit @ 1+ >in ! ;                          : loc  ( -- a ) >line column @ + ;                                                                                              : insertbuf!  ( | ... -- ) eotib? ?exit                           sourcebuf @ >in @ + insertbuf @ #tib /line min dup              insertbuf# !  cmove  emptytib ;                                                                                               : findbuf!  ( | ... -- ) eotib? ?exit                             sourcebuf @ >in @ + findbuf @ #tib /line min dup findbuf# !     cmove  emptytib ;                                             : list  ( u -- ) block  blocklines  0  do  dup i (.line)          /line +  loop  drop ;                                         : l  ( -- ) page scr @ list .line ;                             : n  ( -- ) 1 scr +! row off column off l ;                     : b  ( -- ) -1 scr +! row off column off l ;                    : t  ( n -- ) row ! column off .line ;                                                                                          : p  ( | ... -- ) >line /line blank insertbuf! insertbuf @ >line  insertbuf# @ cmove column off update .line ;                                                                                  : insert  ( | ... -- ) insertbuf! >loc dup                        insertbuf# @ + /line column @ - insertbuf# @ - 0 max cmove>     insertbuf @ >line column @ + insertbuf# @ cmove                 update  .line ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back 0   update     \ "ff" sources 10                                                                                                               \ Line-oriented block editor #2                                                                                                                                                                 : e  ( -- ) loc dup findbuf# @ dup >r - /line column @            - cmove >line /line + r@ - r@ blank r> negate column +!         update  .line  ;                                                                                                              : f  ( | ... -- ) findbuf! >line /line findbuf @ findbuf# @       search if drop >line - findbuf# @ + column ! .line else 2drop   then ;                                                                                                                        : copydown  ( n -- ) row @ maxrow = if drop exit then >r >line    dup r> lines + maxrow row @ - lines cmove> ;                                                                                  : u  ( | ... -- ) row @ maxrow = abort" end of block"             1 copydown 1 row +! p  ;                                                                                                      : x  ( -- ) >line insertbuf @ /line cmove /line insertbuf# ! row  @ maxrow = if >line /line blank else >line /line + >line        blocklines row @ - 1-                                           lines cmove scr @ block maxrow lines + /line blank then         update  .line ;                                                                                                               : d  ( | ... -- ) relist off f relist on e ;                    : r  ( | ... -- ) relist off e relist on insert ;               : copy  ( n1 n2 -- ) block swap block swap /block cmove ;                                                                       : addr>pos  ( a -- ) scr @ block - /line /mod row ! column ! ;                                                                  : s-scr  ( -- f) loc /block row @ lines - column @ - findbuf      @ findbuf# @ search if drop findbuf# @ + addr>pos true else     2drop false then ;                                                                                                            : s  ( n | ... -- ) findbuf! s-scr if drop l exit then            maxblock min 1+ scr                                             @ 1+ do i block /block findbuf @ findbuf# @ search if drop i    scr ! addr>pos l unloop exit else 2drop then loop ;                                                                           : g  ( n1 n2 -- ) 1 copydown lines swap block + insertbuf !       /line insertbuf# ! p ;                                                                                                        : bring  ( n1 n2 n3 -- ) relist off over - 1+ 0 do 2dup i +       g 1 row +! loop 2drop relist on .line ;                                                                                       : w  row @ 3 + blocklines min  row @ 2 - 0 max  do                i lines scr @ block +  i (.line)  loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ "ff" sources 10                                                                                                               \ Line-oriented block editor #3 (end)                                                                                           : k  ( -- ) findbuf @ >r insertbuf @ findbuf ! r> insertbuf !     findbuf# @ >r insertbuf# @ findbuf# ! r> insertbuf# ! ;                                                                       : till  ( | ... -- ) findbuf! >line /line findbuf @ findbuf# @    search if >r >loc r@ cmove >line /line + r@ - r> blank          .line else 2drop then ;                                                                                                       : cut  ( -- ) loc /line column @ - blank   .line ;              : show  ( n1 n2 -- ) 1+ swap do i list loop ;                                                                                   : wipe  ( -- ) scr @ block /block blank ;                       : i  ( | ... -- ) insert ;                                      : q  flush  previous ;                                          : #  ( u -- ) 0 max  maxblock min  scr !  l ;                   : a  ( | ... -- ) p  row @ 1+ blocklines min row ! ;                                                                            : location  ( a u -- scr row -1 | a2 0 0 )                        pad place  pad find 0=  if  0  false  |                         >loc @ dup 16 rshift swap  h# ffff and /line /                  true ;                                                                                                                        : jump  ( a u -- ) location  if  row !  scr !  |                  drop space count type  true abort" ?" ;                                                                                       : v  ( | word -- ) bl word count jump  .line ;                                                                                  also forth definitions                                                                                                          : ed  also editor ;                                             : edit  ( u -- ) scr ! ed  l ;                                  : view  ( | word -- ) bl word count jump  l ;                                                                                   only forth definitions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ Dumping executables                                                                                                             ELF                                           171 - 173         Macho-O                                       175 - 177                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10                                                                                                             \ Dumping executables (ELF) - #1                                                                                                \ requires: stuff                                                                                                               .( unexec-elf )                                                                                                                 vocabulary unexec                                               also unexec definitions                                         6 constant AX       7 constant WAX                              1 constant LOAD     1 constant PROGBITS                         8 constant NOBITS                                               \ extract prg-header and base address from ELF data in image    1 cells 8 = [if]        \ elf64                                 32 constant e_phoff                                             8 constant p_offset                                             16 constant p_vaddr                                             24 constant p_paddr                                             32 constant p_filesz                                            40 constant p_memsz                                             48 constant p_align                                             56 constant phentsize                                           [else]                                                          28 constant e_phoff                                             4 constant p_offset                                             8 constant p_vaddr                                              12 constant p_paddr                                             16 constant p_filesz                                            20 constant p_memsz                                             28 constant p_align                                             32 constant phentsize                                           [then]                                                          imgbase e_phoff + @ imgbase + constant prghdraddr               prghdraddr p_vaddr + @ constant baseaddr                        prghdraddr p_filesz + @ constant textsize                       512 constant baseoffset   \ /elfprefix                          prghdraddr p_align + @ constant elfalign                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ Dumping executables (ELF) - #2                                                                                                \ requires: stuff                                                                                                                                                                               : addralign  ( u1 -- u2 )                                         elfalign 1- swap over +  swap invert and ;                    \ compute data/bss segment sizes                                : memsize  ( -- u )                                               here baseaddr - addralign textsize - ;                        \ adjust program-header for data, bss + note segments           : fixup-prghdr  ( a -- )                                          prghdraddr imgbase - + phentsize +  \ 2nd program-header        p_filesz +  memsize swap ! ;  \ modify filesize               \ copy elf-header + load-headers and modify + write             : gen-elf/prghdr  ( fd -- )                                       imgbase pad baseoffset cmove                                    pad fixup-prghdr                                                pad  baseoffset  rot write-file ?fcheck ;                     \ write text + data segments                                    : gen-text/data  ( fd -- )                                        imgbase baseoffset + textsize memsize +                           baseoffset - rot write-file ?fcheck ;                       \ create file with executable permissions                       : xcreate-file  ( a n -- fd ior )                                 zstring w/o O_TRUNC or OPENX_MODE fscreate dup ior ;          \ variant of "boot" for use in unexec'd programs                : xboot  clear  sp@ cell+ s0 !  here h0 !  startup  bye ;                                                                        \ boot "xboot" on startup using initial `dp`                    \ (not used by vocabulary system)                              c" xboot" findname drop dpboot !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ Dumping executables - ELF - #3 (end)                                                                                                                                                          also forth definitions                                                                                                          defer presave   ' noop is presave                               : saved  ( a n | -- )                                             presave                                                         2dup delete-file drop  \ delete in case it is running           xcreate-file ?fcheck                                            dup gen-elf/prghdr                                              dup gen-text/data                                               close-file ?fcheck ;                                          : save  ( | <fname> -- ) bl word count saved ;                                                                                  previous previous                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10                                                                                                             \ Dumping executables (Mach-O) - #1                                                                                             \ requires: stuff                                                                                                               .( unexec-macho )                                                                                                               vocabulary unexec                                               also unexec definitions                                                                                                         h# feedfacf constant x86_64-magic                               : le4@  ( a -- x )                                                dup c@ over 1+ c@ 8 lshift or over 2 + c@ 16 lshift or          swap 3 + c@ 24 lshift or ;                                    : be4@  ( a -- x )                                                dup c@ 24 lshift over 1+ c@ 16 lshift or over 2 + c@            8 lshift or swap 3 + c@ or ;                                  defer w4@                                                       1 cells 8 =  [if]                                                 [defined] little-endian  [if]  ' le4@                           [else]  ' be4@  [then]  is w4@                                [else]  ' @ is w4@  [then] ;                                    imgbase w4@ constant magic                                      : macho64  ( -- f ) magic x86_64-magic = ;                      24 constant >vmaddr                                             24 1 cells + constant >vmsize                                   24 2 cells + constant >offset                                   24 3 cells + constant >filesize                                 macho64  [if]  8  [else]  7  [then] 4 * constant >lcommands     >lcommands dup 4 + imgbase + w4@ + constant >text-lcmd          >text-lcmd dup 4 + imgbase + w4@ + constant >data-lcmd          >text-lcmd >vmaddr + imgbase + @ constant baseaddr              >text-lcmd >filesize + imgbase + @ constant textsize            512 constant baseoffset   \ /machoprefix                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10                                                                                                             \ Dumoing executables (Mach-O) - #2                                                                                                                                                             4096 constant machoalign                                                                                                        : addralign  ( u1 -- u2 )                                         machoalign 1- swap over +  swap invert and ;                  \ compute used data segment segment size                        : datasize  ( -- u ) here baseaddr - addralign textsize - ;     \ adjust filesize of __DATA lcmd                                : fixup-lcmds  ( a -- )                                           >data-lcmd + >filesize + datasize  swap ! ;                   \ copy macho-header + load-commands and modify + write          : gen-hdr/lcmds  ( fd -- )                                        imgbase pad baseoffset cmove                                    pad fixup-lcmds                                                 pad baseoffset rot write-file ?fcheck ;                       \ write text + data segments                                    : gen-text/data  ( fd -- )                                        imgbase baseoffset + textsize datasize +                          baseoffset - rot write-file ?fcheck ;                       \ create file with executable permissions                       : xcreate-file  ( a n -- fd ior )                                 zstring w/o O_TRUNC or OPENX_MODE fscreate dup ior ;          \ variant of "boot" for use in unexec'd programs                : xboot  clear  sp@ cell+ s0 !  here h0 !  startup  bye ;                                                                        \ boot "xboot" on startup using initial `dp` (not used by       \ vocabulary system)                                           c" xboot" findname drop dpboot !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10                                                                                                             \ Dumping executables (Mach-O) - #3 (end)                                                                                                                                                       also forth definitions                                                                                                          defer presave   ' noop is presave                               : saved  ( a n | -- )                                             presave                                                         2dup delete-file drop  \ delete in case it is running           xcreate-file ?fcheck                                            dup gen-hdr/lcmds                                               dup gen-text/data                                               close-file ?fcheck ;                                          : save  ( | <fname> -- ) bl word count saved ;                                                                                  previous previous                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10                                                                                                               \ Block file management                                                                                                          mmap(2) based                                  181              File based                                     182              Minimal, file based                            185                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Block files 180                                                                                             \ Block file management (mmap based)                                                                                            .( blkmm )                                                                                                                      : msync  ( a u -- ior ) MS_SYNC sys_msync syscall3 ior ;                                                                        64 constant /line   64 constant blocklines                      /line blocklines * constant /block                                                                                              \ block file management                                         variable memfd      variable /mem       variable >mem           create bfname 2 cells allot                                     : bfname@  ( -- a u ) bfname cell+ @  bfname @ ;                : bfname!   ( a u -- ) bfname !  bfname cell+ ! ;               : memopen  ( a u -- ) r/w open-file                               abort" error while opening block file"                          dup  memfd !  file-size ?fcheck /mem ! ;                      : memmap  memfd @ r/w /mem @ 0 map-file ?fcheck >mem ! ;        : memunmap  >mem @ /mem @ unmap-memory ?fcheck ;                : memclose  memfd @ close-file ?fcheck  memfd off ;             : memfile  ( a u -- ) memopen  memmap ;                         : blockfile  ( | fname -- ) memfd @  if  memunmap  memclose       then                                                            bl word count  2dup  here  swap cmove  here over bfname!        dup allot  memfile ;                                          : ?mem  memfd @  unless  bfname@ memfile  then ;                                                                                \ block management                                              variable scr                                                    : block  ( u -- a ) ?mem  /block * >mem @ + ;                   : load  ( u -- ) >r  save-input  r> dup blk !  block sourcebuf !  >in off  /block >limit !  interpret  restore-input              0=  if  ."  unable to restore input"  abort  then               blk @ ?dup  if  block sourcebuf !  then ;                     : thru  ( b#1 b#2 -- ) 1+ swap  do  i load  loop ;              : copy  ( b#1 b#2 -- ) block swap block swap /block cmove ;     variable bdest                                                  : ncopy  ( b#from b#to #bdest -- ) bdest !  over - 1+  0  do        dup block  bdest @ i + copy  1+  loop  drop ;               : ncopy>  ( b#from b#to #bdest -- ) over + 1- bdest !             tuck swap - 1+  0  do  dup  bdest @ i - copy  1-  loop drop ; : flush  memfd @ 0= ?exit  >mem @ /mem @ msync ?fcheck ;        : update ( flush ) ;                                            : maxblock ( -- u ) /mem @ /block / 1- ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Block files 180                                                                                             \ Block file management (file based) - #1                                                                                       .( blk )                                                                                                                        variable scr        variable recent-buffer                      variable buffer-map                                             variable buffers-base       variable max-buffers                variable blockfile      variable bfname                         64 constant /line     16 constant blocklines                    1024 constant /block                                            16 constant #buffers                                                                                                            : buffer-addr  ( n -- a ) /block * buffers-base @ + ;           : buffer-block  ( n -- a ) 2 cells * buffer-map @ + ;           : buffer-dirty  ( n -- a ) buffer-block cell+ ;                                                                                 defer ?blockfile                                                : (?blockfile)  ( -- )                                            blockfile @ 0=  if  bfname @ count r/w open-file ?fcheck        blockfile !  then ;                                           ' (?blockfile) is ?blockfile                                    : update  ( -- ) recent-buffer @ buffer-dirty on ;                                                                              defer wrblock       defer rdblock                               : (wrblock)  ( a blk -- )                                         /block * blockfile @ reposition-file ?fcheck                    /block blockfile @ write-file ?fcheck ;                       : (rdblock)  ( a blk -- )                                         /block * blockfile @ reposition-file ?fcheck                    /block blockfile @ read-file ?fcheck  drop ;                  ' (wrblock) is wrblock      ' (rdblock) is rdblock              : save-buffer  ( n -- )                                           dup buffer-block @ over buffer-addr swap wrblock                buffer-dirty off ;                                            : save-buffers  ( -- )                                            blockfile @  if                                                   max-buffers @ 0  do                                               i buffer-dirty @  if  i save-buffer  then                     loop                                                          then ;                                                        : empty-buffers  ( -- ) buffer-map @ max-buffers @ 2 cells *      erase ;                                                       : flush  save-buffers  empty-buffers ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Block files 180                                                                                             \ Block file management (file based) - #2                                                                                       : next-buffer  ( n1 -- n2 ) 1+ max-buffers @ mod ;              : buffer  ( n -- a )                                              max-buffers @ 0  do                                               recent-buffer @ i + next-buffer dup buffer-dirty @ 0=  if         dup recent-buffer ! dup                                         >r buffer-block ! r> buffer-addr unloop exit  then            drop                                                          loop                                                            recent-buffer @ next-buffer dup save-buffer dup recent-buffer   ! dup >r buffer-block ! r> buffer-addr ;                      : block  ( n -- a )                                               ?blockfile                                                      max-buffers @ 0  do                                               dup i buffer-block @ =  if                                        drop  i buffer-addr i recent-buffer ! unloop  exit  then    loop                                                            dup buffer dup >r swap rdblock r> ;                           : load  ( n -- )                                                  >r save-input r> dup blk ! block sourcebuf !                    >in off /block >limit !  interpret  restore-input               0=  if  s"  unable to restore input" type cr abort  then        blk @ ?dup  if  block sourcebuf !  then ;                     : thru  ( n1 n2 -- ) 1+ swap  do  i load  loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Block files 180                                                                                             \ Block file management (file based) - #3 (end)                                                                                 : .row  ( n -- ) 2 .r [char] | emit ;                           : .blkhdr  ( n -- ) s"   +BLOCK: " type 4 u.r                     s" -----------------------------------------------------+"      type cr ;                                                     : list  ( n -- )                                                  base @ >r decimal dup scr ! dup .blkhdr                         block blocklines 0  do                                            i .row dup /line type [char] | emit cr /line +                loop                                                            drop r> base !                                                  s"   +----------------------------------------------------------------+" type cr ;                                            : .buffers  ( -- ) base @ cr                                      ."   Buffer  Block  Dirty  Address" cr                          ."   -----------------------------" cr                          max-buffers @ 0  do                                               decimal  6 spaces i 2 .r 3 spaces i buffer-block @ 4 .r         4 spaces i buffer-dirty @  if  [char] X else [char] -  then     emit 3 spaces hex i buffer-addr 8 .r cr                       loop  base ! ;                                                : initblocks                                                      #buffers max-buffers !                                          r0 @ max-buffers @ /block * - buffers-base !                    s" _blockfile" 1- over c!  bfname !                             buffers-base @ max-buffers @ 2 cells * - buffer-map ! ;                                                                        \ call `initblocks` on startup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Block files 180                                                                                             \ Block file management (file based, minimal)                                                                                   4096 constant /block                                                                                                            variable blkfd                                                                                                                  : bblkbase  ( -- a ) r0 @ /block - ;                            : blockfile  ( | name -- ) bl word count r/o open-file ?fcheck    blkfd ! ;                                                     : block  ( b# -- a ) /block * blkfd @ reposition-file             ?fcheck  bblkbase /block blkfd @ read-file ?fcheck drop         bblkbase ;                                                    : load  ( b# -- )                                                 blk @  if  ."  recursive load" cr abort  then                   >r save-input r> dup blk ! block sourcebuf !                    >in off /block >limit !  interpret                              restore-input                                                   0=  if  ."  unable to restore input" cr abort  then ;         : thru  ( u1 u2 -- ) 1+ swap  do  i load  loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ code to set up environment and boot system                                                                                    : boot                                                            clear  h @ h0 !  dp @ dp0 !  dp current !  warnings on          cold ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                       Look alignpos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #1                                                                                                             \ requires: sig term                                                                                                            .( ed )                                                                                                                         vocabulary editor                                               only forth  also editor definitions                                                                                                                                                             \ parameters + constants                                                                                                        blocklines 1- constant (maxrow)    /line 1- constant (maxcol)   8 constant tabwidth                                             500 constant search#                                            1 constant B1       2 constant B2       3 constant B3           /block 2* 1 cells - constant /snarfbuf                          2000 constant scratch#                                          1 constant auto#                                                                                                                \ utilities                                                                                                                     : toggle  ( a -- ) dup @ 0= swap ! ;                            : diff  ( n1 n2 -- u ) - abs ;                                  : trim  ( a u -- ) -trailing  bl skip ;                         variable /ln        variable rdfd                               : readc  ( a -- u ior ) 1  rdfd @  read-file ;                  : read-line  ( a u1 fd -- u2 f ior )                              /ln off   rdfd !  begin  ?dup  unless  drop  /ln @  true  0 |     over readc ?dup  if  ( a u1 u2 ior ) >r  rot 2drop  true        r>  |                                                           0=  if  2drop  /ln @  false  0  |                               over c@ 10 =   if  drop 0  else  1 /ln +!  1 /string  then    again ;                                                       : crnl  13 emit  10 emit ;                                      : readenter  begin  key 13 =  until ;                           : swapped  ( a1 a2 -- ) over @ over @ ( a1 a2 x1 x2 )  >r         swap !  r> swap ! ;                                           : canonical  ( a u -- )  0  ?do  dup c@ bl <  if  bl over c!      then  1+  loop  drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #2                                                                                                             \ window management                                                                                                             variable row      variable col                                  : lines  ( u -- u' ) /line * ;                                  : >pos  ( r c -- a ) swap lines + scr @ block + ;               : >block  ( -- a ) row @ col @ >pos ;                           : offset  ( a -- u ) scr @ block - ;                            : /pos  ( r c -- u ) >pos offset ;                              : /rest  ( -- u ) >block scr @ 1+ block swap - ;                : /linerest  ( -- u ) /line col @ - ;                           : offset>pos  ( u -- r c ) /line u/mod swap ;                   : maxcol  ( -- u ) (maxcol) cols 1- min ;                       : maxrow  ( -- u ) (maxrow) rows 3 - min ;                      : statusrow  ( -- u ) maxrow 1 + ;                              : msgrow  ( -- u )  statusrow 1+ ;                              : pos  row @ col @ gotoxy ;                                     : moveto  ( r c -- ) 2dup gotoxy col ! row ! ;                  : psave  ( -- r c ) row @ col @ ;                               : prestore  ( r c -- ) moveto ;                                 : resize  psave  termsize  maxrow min row !  maxcol min col !     pos ;                                                         : nextblock  scr @ 1+ maxblock min scr ! ;                      : prevblock  scr @ 1- 0 max scr ! ;                                                                                             \ plumbing                                                                                                                      variable plumbers                                               : plumb  ( a u -- f ) plumbers @  begin  ?dup 0=  if  2drop       false  |  >r  2dup  r@ @ execute  if  r> drop 2drop  true  |    r> cell+ @  again ;                                           : (plumber)  ( xt -- ) here >r  ,  plumbers @ ,  r> plumbers ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #3                                                                                                             defer redraw        defer redrawb                                                                                               \ selection                                                                                                                     variable selstart       variable selend     variable selected   variable sweeping                                               : startw  ( a1 -- a2 ) begin  dup scr @ block = ?exit  dup c@     bl =  if  1+  |  1-  again ;                                  : endw  ( a1 -- a2 ) scr @ 1+ block over - bl scan drop ;       : below  ( r c -- a u ) >pos dup startw  swap  endw  over - 0     max ;                                                         : nearest  ( -- a ) >block selstart @ <  if  selstart  |          >block selend @ >  if  selend   |                               >block selstart @ diff  >block selend @ diff <  if  selstart    |  selend ;                                                   : selection  ( -- a u ) selstart @ selend @ 1+ over - ;         : select  ( a u -- ) over selstart !  + selend !  1 selected !    ;                                                             : unselect  selected @  if  selected off  redraw  then ;        : insidesel  ( r c -- f ) selected @ 0=  if  2drop  false  |      >pos  selstart @ selend @ 2 + within ;                        : sweep  nearest sweeping ! ;                                   : extendsel  >block sweeping @ !  selstart @ selend @ >  if         selstart selend swapped  sweep  then ;                      : +selection  selected @  unless  r> drop  then ;                                                                                                                                               \ snarf buffer                                                                                                                  : snarf#  ( -- b# ) maxblock 2 - ;                              : /snarfed  ( -- u ) snarf# block @ ;                           : >snarf  ( -- a ) snarf# block ;                               : snarf  ( a u -- ) ?dup  unless  drop  |                         /snarfbuf min  dup >snarf !  >snarf cell+  swap cmove ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Editor sources 11                                                                                                             \ block editor - #4                                                                                                             \ output                                                        : scroll  nextblock  redrawb  pos ;                             : newline  row @ maxrow >=  if  row off  scroll  else  1 row +!   then  col off  pos ;                                          : out  ( c -- ) dup >block c!  emit  1 col +!                     col @ maxcol >  if  newline  then ;                           : linemark  cols /line >  if  h# 250b emit  then ;              : selblock  ( -- f ) selected @  if  selstart @  scr @ block      dup /block + within  else  false  then ;                      : selcolor  selected @  1  ->  reverse  |  2  ->  1 bg  |  drop   2 bg ;                                                        : before  ( a u1 -- a u2 ) over selstart @ swap - 0 max min ;   : inside  ( a u1 -- a u2 ) over selend @ swap - 1+ 0 max min ;  : showln  ( a u -- ) 2dup before 2dup type  nip /string           ?dup  unless  drop  |  selcolor  2dup inside 2dup type  nip     /string  normal  type ;                                       : showline  ( u -- ) dup 0 gotoxy  /line * scr @ block + /line    cols min  over c@ [char] \ =  if  underline  then               selblock  if  showln  else  type  then  normal   linemark ;   : (showblock)  psave  maxrow 1+  0  ?do  i showline  loop         prestore ;                                                    : redrawl  psave  row @ showline  prestore ;                    ' (showblock) is redrawb                                                                                                        variable msg                                                    : <m  msgrow 0 gotoxy  clln ;                                   : m>  pos  msg on  ;                                                                                                            \ location stack                                                8 constant #locstack    #locstack cells constant /locstack      /locstack buffer: locstack                                      locstack /locstack + constant locstack>                         locstack /locstack erase                                        variable locsp          locstack locsp !                        : pushloc  ( loc -- ) locsp @ tuck !  cell+ dup locstack>         >=  if  drop  locstack  then  locsp ! ;                       : poploc  ( -- loc ) locsp @ 1 cells - dup locstack <  if         drop  locstack> 1 cells -  then  dup locsp ! @ ;              : saveloc  ( r c -- ) /pos  scr @ 16 lshift or  pushloc ;       : restoreloc  poploc dup h# ffff and offset>pos col ! row !       16 rshift scr ! ;                                                                                                             \ jumping                                                       2variable origin                                                : remember  origin 2@ saveloc ;                                 : jumplink  ( a u -- f ) base @ >r  decimal  number  r> base !    0=  if  2drop  false  |                                         dup  0 maxblock 1+ within 0=  if  drop  false  |                remember  scr !  selected  off  redrawb  true ;               ' jumplink (plumber)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #5                                                                                                             \ behaviour                                                                                                                     variable crow       variable ccol       variable buttons        : blockup  prevblock  selected off  redrawb ;                   : blockdown  nextblock  selected off  redrawb ;                 : firstrow  ( -- f ) row @ 0= ;       : lastrow  ( -- f ) row @   rows 2 - = ;                                                  : firstcol  ( -- f ) col @ 0= ;         : lastcol  ( -- f ) col   @ maxcol >= ;                                                 : up  firstrow 0=  if  -1 row +!  else  scr @  if  maxrow row !   blockup  then  pos  then ;                                    : down  lastrow ?exit  row @ maxrow <  if  1 row +!  else         row off  blockdown  then  pos ;                               : left  col @  if  -1 col +!  pos  |  firstrow  if  scr @ 0=      ?exit   then  up  maxcol col !  pos ;                         : right  lastcol  if  lastrow ?exit  col off  down  else  1 col   +!  pos  then ;                                               : bol  col off  pos ;                                           : eol  /line 1-  begin  ?dup  while  row @ over >pos c@ bl <>     if 1+ maxcol min col !  pos  |  1-  repeat  col off  pos ;    : valid?  ( xc -- f ) 32 127 within ;                           : shift>  >block dup 1+ /linerest 1- cmove> ;                   : insspace  lastcol ?exit  psave  shift>                          bl >block c!  row @ showline prestore ;                       : insert  ( xc -- ) dup valid?  unless  drop  |                   lastcol lastrow and  if  drop  |  shift>  out  redrawl ;      : shiftdown  scr @ block row @ /line * + dup >r                   dup /line +  blocklines row @ - 1- /line * cmove>  r> /line     blank ;                                                       : insline  row @ maxrow >= ?exit  shiftdown  redrawb ;          : ?blanksel  selected @  if  selection snarf  selection blank     unselect  r> drop  then ;                                     : delete  ?blanksel  >block dup 1+ swap                           /linerest  1- cmove  bl row @ /line 1- >pos c!  redrawl ;     : backspace  ?blanksel  left  delete ;                          : shiftup  row @ /line * scr @ block +  dup /line +  swap         blocklines 1- row @ - /line *  cmove ;                        : blank?  ( -- f ) >block /linerest bl skip nip 0= ;            : delline  row @ 0 >pos col @ snarf  shiftup  blocklines 1-       0 >pos /line blank  col off  redrawb ;                        : delrest  lastrow ?exit  blank?  if  delline  |                  >block /linerest 2dup snarf  blank  redrawb ;                 : instab  col @ tabwidth mod  tabwidth swap - col @ + /line min   col !  pos ;                                                  : (splitline)  shiftdown  row @ 1+ 0 >pos  row @ 0                >pos  col @ cmove  row @ 1+ col @ >pos                          row @ 1+ 0 >pos  /linerest cmove  row @ 1+ /linerest >pos col   @ blank ;                                                     : splitline  lastrow ?exit  (splitline)  redrawb ;              : joinlines  lastrow ?exit  row @ 1+ 0 >pos  >block  /linerest    2dup snarf cmove  psave  1 row +!  shiftup                      prestore  redrawb ;                                           : insertnl  lastrow ?exit  (splitline)  1 row +!  col off         redrawb ;                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Editor sources 11                                                                                                             \ block editor - #6                                                                                                             \ cut + paste the selection                                                                                                     : snarf-selection  +selection  selection snarf ;                : cut-selection  +selection  selection snarf  delete ;          : paste-selection  >snarf @+ ?dup  unless  drop  |                >block swap /rest min cmove  selected off  redrawb ;          : inblock  ( a -- f )  scr @ block scr @ 1+ block within ;      : shiftselnew  ( a -- ) dup >block <  if  >block over -           else   >block swap over -  then  select ;                     : shiftsel  ( off -- ) >block + dup inblock  unless  drop  |      selected @  unless  shiftselnew  else  nearest !  then          redrawb ;                                                     : leftsel  -1 shiftsel  left ;                                  : rightsel  1 shiftsel  right ;                                 : upsel  /line negate shiftsel  up ;                            : downsel  /line shiftsel  down ;                                                                                               \ import + export                                                                                                               variable icnt       variable iscr                               : icnt+  ( u -- ) icnt @ + dup /block >  if  1 iscr +!  iscr ?    /block -  then  icnt ! ;                                      : impstr  ( a1 u -- a2 ) >r pad over r@ cmove  r@ icnt+  r> + ; : advance  ( a1 u1 -- a2 ) /line mod ?dup  if  /line swap - 2dup  blank  dup icnt+  +  then ;                                   : importln  ( a1 u f -- a2|0 ) over  if  drop  tuck impstr  swap  advance |                                                       if  drop  dup /line blank  /line icnt+  /line +  |  2drop 0 ; : import-file  ( b# fd -- ) swap iscr !  >r                       iscr @ dup .  block  begin  pad 1024 r@ read-line ?fcheck       importln   ?dup 0= until  r> drop ;                           : imported  ( b# a u | -- ) r/o open-file ?fcheck dup >r          import-file  r> close-file ?fcheck ;                                                                                          create nl  10 c,                                                : exportb  ( fd b# -- ior ) block swap  blocklines  0  do  >r     dup /line r@                                                    write-file ?fcheck  nl 1 r@ write-file ?fcheck  /line +  r>     loop  2drop ;                                                 : export-file  ( b#1 b#2 fd -- ) -rot  1+ swap  ?do  dup i        exportb  loop  drop ;                                         : exported  ( b#1 b#2 a u -- ) w/o create-file ?fcheck dup >r     export-file  r> close-file ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #7                                                                                                             \ evaluation + editing contexts                                                                                                 defer editloop                                                  : wait  ."  - press ENTER "  readenter ;                        : editmode  raw  mouseon  ['] (abort) is abort ;                : break  state off  default-input  cr  editmode                   ." aborted"  wait  clear  redraw  editloop ;                  : evalmode  defaults  msgrow 0 gotoxy clln  ['] break is abort    ;                                                             variable stopped                                                : stop  stopped on ;                                            : cleanup  msgrow 0 gotoxy  clln  defaults  flush  SIGWINCH       ignore-signal ;                                               : terminate  cls  0 0 gotoxy  cleanup  memunmap  memclose  bye    ;                                                                                                                             \ B2 execution                                                                                                                  variable pausing        pausing on                              : dopause  pausing @  if  ."  ok"  wait  then ;                 : upcase?  ( c -- f ) [char] A [char] [ within ;                : evalstr  ( a u -- ) trim ?dup  unless  drop  |                  over c@ upcase? >r  evalmode  evaluate  editmode  r>  unless      dopause  then  redraw ;                                                                                                     \ B3 search                                                                                                                     2variable searching                                             : searchscr  ( -- a u f ) >block /rest 1 /string                  searching 2@ search ;                                         : searchb  ( b# -- a u f ) block /block searching 2@ search ;   : ?visible  selstart @ scr @ block - dup maxrow /line * >=  if    <m ." match at :"  .   ." (not visible)" m>  |  drop ;        : searchok  ( a u -- ) remember                                   drop searching @ 1- select  redrawb  ?visible ;               : searchfail  <m  ." not found in blocks "  scr @ 1+ . ." - "     scr @   search# + (.) type  ." : "  searching 2@ 20 min         type  m> ;                                                    : dosearch  searchscr  if  searchok  |                            2drop  scr @ search# +  scr @ 1+  do  i searchb  if  i scr !    unloop  searchok  |  2drop  loop  searchfail ;                : searchstr  ( a u -- ) searching 2!  dosearch ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Look 0    \ Editor sources 11                                                                                                             \ block editor - #8                                                                                                             \ mouse + selection behaviour                                                                                                   variable pressed        variable pcrow      variable pccol                                                                      : mousestate  buttons @ pressed !  crow @ pcrow !  ccol @ pccol   ! ;                                                           : newsel  pcrow @ pccol @ >pos dup selstart ! selend !            sweep  buttons @ selected ! ;                                 : deselect  buttons @ B1 =  if  selected  off  then ;           : selupdate  pressed @ 0= buttons @ and  if  deselect  |          selected @ buttons @ =  if  extendsel  |  newsel ;            : selrange  ( -- u ) selend @ selstart @ - ;                    : mousemove  crow @ maxrow > ?exit  ccol @ maxcol > ?exit         crow @ row !  ccol @ col !  pos ;                             : subject  ( -- a u )                                             crow @ ccol @ insidesel  if  selection  |  crow @               ccol @ below ;                                                : ?unselect ( m -- ) selected @ =  if  unselect  then ;         : bexec  subject ?dup  if  B2 ?unselect   evalstr  |  drop ;    : acquire  ( a u -- ) trim 2dup plumb  if  2drop  |  searchstr    ;                                                             : bsearch  subject ?dup 0=  if  drop  |                           B3 ?unselect  acquire ;                                       : release  pressed @  B2  ->  bexec  |  B3  ->  bsearch  |        drop ;                                                        : domouse                                                         buttons @  0  ->  release  |                                    B2 B3 or and  if  row @ col @ origin 2!  then                   mousemove  selupdate  redrawb ;                               : alignpos  row @ col @ 2dup origin 2!  ccol ! crow ! ;         : keyexec  alignpos  subject ?dup  if  evalstr  |  drop ;       : keysearch  alignpos  subject ?dup  if  acquire  |  drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0   220        \ Editor sources 11                                                                                                             \ block editor - #9                                                                                                             \ status + stack lines                                                                                                          256 constant /sbuf      /sbuf 32 + buffer: sbuf                 variable >sbuf          variable status                         : sbholds  ( a u -- ) >r  sbuf >sbuf @ + r@ cmove  r> >sbuf +!    ;                                                             : sbhold  ( c -- ) sbuf >sbuf @ + c!  1 >sbuf +! ;              : fillsbuf  depth dup  0  ?do                                       dup i - pick (.) sbholds  >sbuf @ /sbuf >=  if  unloop  drop  exit  then   bl sbhold  loop  drop ;                          : .stack  >sbuf off  fillsbuf                                     >sbuf @ /sbuf >=  if  ." ... ("  depth u.  ." items)"  |        >sbuf @ cols >=  if  ." ... "  >sbuf @ cols 4 - dup >r - sbuf   +  r> type  |  sbuf >sbuf @ type ;                            : +sp  sp@ s0 @ u<  unless                                          <m ." stack underflow" m>  clear  r> drop  then ;           : stack  msg @ ?exit  +sp  msgrow 0 gotoxy  clln  .stack  pos ; : bstatus  >sbuf off  row @ (u.) sbholds  [char] / sbhold  col @  (u.) sbholds                                                    s"  (" sbholds  rows (u.) sbholds  [char] / sbhold  cols (u.)   sbholds                                                         [char] ) sbhold  blocklines rows - 0 max ?dup  if  [char] +     sbhold (u.) sbholds  then  bl sbhold  scr @ (u.) sbholds        [char] : sbhold  row @ col @ /pos (u.) sbholds                  s"  u:" sbholds  unused (u.) sbholds                            selected @  if  s"  {" sbholds  selection nip (u.) sbholds      [char] } sbhold  then                                           /snarfed  ?dup  if  s"  s{" sbholds  (u.) sbholds  then         s" } " sbholds                                                  context @ dup cell+ @ count sbholds  current @ =  if              [char] * sbhold  then ;                                     : .status  status @ 0= ?exit                                      psave  statusrow 0 gotoxy  reverse  maxcol 1 + spaces           13 emit  bstatus  sbuf  >sbuf @ maxcol 1+ min type  normal      prestore  status off ;                                        : (redraw)  redrawb  status on  .status  stack ;                ' (redraw) is redraw                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0  functions   \ Editor sources 11                                                                                                             \ block editor - #10                                                                                                                                                                            \ keyboard processing                                                                                                           : tilde  begin  key [char] ~ <>  while  repeat ;                : ins  key  104  ->  insspace  |  drop ;                        : shiftarrow  key  68  ->  leftsel  |  67  ->  rightsel  |  65    ->  upsel  |  66 ->  downsel  |  drop ;                       : shiftseq  key  59  ->  key drop ( 50 )  shiftarrow  |  drop ; : other  ( c -- )                                                 65  ->  up  |  66  ->  down  |                                  68  ->  left  |  67  ->  right  |                               49  ->  shiftseq  |                                             53  ->  tilde  blockup  |  54  ->  tilde  blockdown  |          80  ->  delete  |                                               52  ->  ins  |  drop ;                                        : button  ( r c b -- ) buttons !  ccol !  crow !  domouse         buttons @ pressed @ <>  if  status on  then  mousestate ;     : mouse  key >r  key 33 -  key 33 -  swap  r> 1+ 3 and  button    ;                                                             : control  key  [char] M  ->  mouse  |  status on  other ;      : fkey  key drop ; \ ignored                                    : special  key  [char] [  ->  control  |                          status on  [char] O  ->  fkey  |  drop ;                      : handle  ( xc -- )                                               27  ->  special  |                                              26  ->  stop  |                                                 status on                                                       24  ->  cut-selection  |                                        3  ->  snarf-selection  |                                       22  ->  paste-selection  |                                      127  ->  backspace  |                                           unselect                                                        13  ->  insertnl  |                                             0  ->  insspace  |                                              1  ->  bol  |  5  ->  eol  |                                    9  ->  instab  |                                                4  ->  delete  |                                                12  ->  insline  |                                              11  ->  delrest  |                                              19  ->  splitline  |                                            10  ->  joinlines  |                                            15  ->  keyexec  |  16  -> keysearch  |                         insert ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #11                                                                                                                                                                            \ main input loop                                                                                                               variable standalone                                             : newsize  resize  redrawb ;                                    : (editloop)  reset  begin  key  SIGWINCH signal?  if  drop       newsize  status on  else                                        handle  then  stopped @  if   cleanup  cls  prompt  quit then   .status  stack  msg off  again ;                              ' (editloop) is editloop                                                                                                        : (ed)  ?mem  editmode  SIGWINCH handle-signal  termsize          stopped off  cls  redraw  editloop ;                                                                                          \ default tag                                                                                                                   create tag                                                        ," \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0"                                                                    : initblock  ( b# -- ) block dup /block blank  tag count >r swap  r> cmove ;                                                    : initblocks  ( b1 b2 -- ) 1+ swap  do  i initblock  loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #12                                                                                                                                                                            \ usage information                                                                                                             : usage  ." usage: fa [-h] [-n] [-i] [-b FILENAME]"               cr bye ;                                                                                                                      \ startup                                                                                                                       variable noauto         variable interactive                    : setblkfile  ( u1 -- u2 ) dup 1+ arg bfname 2!  ;              : doarg  ( u1 a u2 -- u3 )                                        2dup s" -b" compare 0=  if  2drop  setblkfile  2  |             2dup s" -h" compare 0=  if  usage  |                            2dup s" -i" compare 0=  if  interactive on  noauto on  1  |     2dup s" -n" compare 0=  if  2drop  drop  noauto on  1  |        number  if  scr !  drop  1  |                                   usage ;                                                       : cmdline  #arg  1  ?do  i dup arg doarg  +loop ;                                                                               : run-editor                                                      [defined] sigprepare  [if]  sigprepare  [then]                  cmdline ?mem  noauto @  unless  auto# load  then                interactive @  unless  (ed)  else  ." ok " cr abort  then ;                                                                   \ plumbing for word-location                                                                                                    : location  ( a u -- scr row -1 | a2 0 0 )                        pad place  pad find 0=  if  0 false  |                          >loc @ dup 16 rshift swap  h# ffff and offset>pos drop          true ;                                                        : jumptodef  ( a u -- f ) location 0=  if  2drop  false  |        remember  col off  row !  scr !  redraw  true ;               ' jumptodef (plumber)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources 11                                                                                                             \ block editor - #13                                                                                                            also forth definitions                                                                                                          \ initialization                                                                                                                : ed  (ed) ;                                                    : edit  ( u -- ) scr !  selected off  (ed) ;                    : install  ['] run-editor is startup  standalone on ;                                                                           \ high-level commands                                                                                                           : Next  blockdown ;     : Prev  blockup ;                       : Exit  standalone @  if  terminate  else  stop  then ;         : Load  evalmode scr @ dup >r load  editmode  redraw              r>  <m ." block " . ." loaded" m> ;                           : Wipe  scr @ dup block /block snarf  initblock  redrawb ;      : Snarf  snarf-selection ;              : Cut  cut-selection ;  : Paste  origin 2@ col ! row !  paste-selection ;               : Pause  pausing toggle  <m ." pausing " pausing @  if  ." on"    else  ." off" then  m> ;                                      : Back  restoreloc  redraw ;                                    : Look  origin 2@ col ! row !  selected @  if                       selection  else  origin 2@ below  then  searchstr ;         : xcliprd  >snarf cell+                                           /block  s" env DISPLAY=:0 xclip -o" capture                     or  abort" accessing X selection failed"  >snarf !              >snarf @+ canonical  <m /snarfed . ." bytes snarfed" m> ;     : xclipwr  selection  s" env DISPLAY=:0 xclip -i -l 1" feed       abort" setting X selection failed"  drop  <m selection nip      . ." bytes written" m> ;                                      : Xclip  selected @  if  xclipwr  else  xcliprd  then ;                                                                         \ utilities                                                                                                                     : patch  ( u | fname -- ) bl word count r/o open-file ?fcheck     >r  block /block r@ read-file ?fcheck drop  r> close-file       drop ;                                                        : import  ( b# | fname -- ) bl word count imported ;            : export  ( b#1 b#2 | fname -- ) bl word count  exported ;      : plumber  ( xt -- ) (plumber) ;                                : view  ( | word -- ) bl word count location  if  col off  row !  edit  |  drop space count type  true abort" ?" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back           \ Editor sources 11                                                                                                             \ block editor - #14                                                                                                            \ (unused block)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back  0  1110  \ Editor sources 11                                                                                                             \ block editor - #15 (end)                                                                                                      \ block formatting                                                                                                              variable fmtindent      2 fmtindent !                           variable fmtwidth       64 fmtwidth !                                                                                           editor definitions                                                                                                              variable fcol    variable ptr                                                                                                   : cins  ( c -- ) ptr @ c!  1 ptr +!  1 fcol +! ;                : insbl  ( u -- ) 0  ?do  bl cins  loop ;                       : insword  ( a u -- )                                             >r  ptr @  r@ cmove  r@ ptr +!  r> fcol +! ;                  : paragraph  fcol off  fmtindent @ insbl ;                      : scanword  ( a1 u1 -- a2 u2 u3 )                                 dup >r bl scan dup r> swap - ;                                : fillup  fmtwidth @ fcol @ - 0 max insbl  fcol off ;           : skipws  ( a1 u1 -- a2 u2 )                                      dup >r bl skip r> over - fmtwidth @ < ?exit                     fillup  fmtwidth @ insbl  paragraph ;                         : fmtline  ( a u -- ) ?dup 0=  if  drop |                         scanword dup >r col @ + fmtwidth @ >=  if  fillup  then         over r@ - r> insword  bl cins  skipws -;                                                                                      forth definitions                                                                                                               : fmt  ( a1 u a2 -- u2 ) dup >r ptr !  bl skip  paragraph         fmtline  ptr @ r> - ;                                                                                                         : Fmt  +selection  selection pad fmt  selection blank             unselect  pad selstart @ rot  cmove  unselect ;                                                                                                                                               only forth definitions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back  0                                                                        \ editor - loader screen                                                                                                        160 load  \ signals                                             162 load  \ terminal                                            164 load  \ pipes                                                                                                               200 214 thru                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0                                                                             \ dump editor sources                                                                                                           160 160 export sig.f                                            170 170 export term.f                                           200 214 export ed.f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11                                                                                             \ The "ff" Editor Manual                                                                                                        This describes the "ff" editor, a Forth block editor with mouse interface. The editor uses 64x64 character blocks to store      "screens", where each screen can hold arbitrary code or data.                                                                   The editor is mostly keyboard driven but also provides a        convenient mouse interface, inspired by the "acme" editor       from Plan 9. A three-button mouse is recommended, but not       strictly necessary, the editor can also be used purely by key   presses.                                                                                                                                                                                         Display                                        221              Basic editing                                  222              Keyboard operations                            223              Mouse operations                               224              Editor commands                                225              Editor vocabulary                              226              Initialization                                 227              Miscellaneous Notes                            228              The Line Editor                                229 - 230                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ The Display                                                                                                                   When the editor is started you see up to 64 lines of text with  a reverse-colored status bar below. If the size of the terminal window is not sufficient, then you will only see as many lines  of a screen as fit into the window. To see the complete screen, you will have to enlarge the terminal window or decrease the    terminal font size.                                                                                                             The status bar shows some information about where you currently are and a few other useful details:                                                                                             [ROW/COL (ROWS/COLS)+REM SCR:POS u:UNUSED {SEL} s{SNARF} VOC]                                                                   "ROW/COL": current row and column of the cursor.                                                                                "(ROWS/COLS)+REM": total number of rows and columns available     if the window is not large enough to show all rows, then "REM"  gives the number of lines not visible.                                                                                        "SCR:POS": current screen and offset in the screen, measured      from the current cursor position.                                                                                             "u:UNUSED": number of unused bytes in the dictionary.                                                                           "{SEL}": number of bytes in the selection (if a selection         exists).                                                                                                                      "s{SNARF}": number of bytes in the "snarf" buffer (if any).                                                                     "VOC": shows the topmost active vocabulary.                                                                                     Below the status bar is a message window, displaying the        contents of the stack and informational messages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Basic Editing                                                                                                                 Editing should be straightforward, once some idiosyncrasies of  this particular system have been understood. Most importantly,  this is a block editor. There are no files, only 64x64 characterblocks. Each block has a number and is automatically saved to   disk when modified. This is done by the virtual memory system   and should happen instantly. The arrow keys can be used to      navigate on the screen and all operations overwrite existing    text. For convenience single character input shifts all         following text in the same line to the right and backspace      shifts to the left. These are the only exceptions.                                                                              You can position the cursor using the mouse. Text may be        selected by "sweeping" the mouse with one of the buttons        pressed.                                                                                                                        There is no "undo" feature. Text shifted out on the right or    below the 64th screen line is lost. Together with the instant   saving of changes this requires some care when editing.                                                                         The "screen" is visible representation of a block and is what   you edit. In this documentation "screen" and "block" basically  mean the same.                                                                                                                  The underlying block file is of the simplest possible format:   each block consists of 64 rows of 64 bytes each. Note that      multibyte (UTF-8) characters will display as single characters  on the display, but still require multiple bytes in the block   (this will be indicated by the indented right delimiter bar.)                                                                   Any line beginning with "\" will be shown in underlined mode,   to visually emphasize comments and special sections. The first  line in a block is by convention reserved for "command",        which can be thought of as "buttons" (see below for more on     this.)                                                                                                                          You can suspend editing at any time by pressing ^Z or clicking  `Exit` with button #2. To start the editor again, enter `ed`    or `<BLOCK> edit`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Keyboard operations                                                                                                           Most keys simply insert the pressed character, shifting existingtext on the same line to the right. The ENTER key shifts the    line below one row further down and positions the cursor at the start of the next line.                                                                                                         Special keys are:                                                                                                               ARROW KEYS: move cursor, moving to previous/next block if         necessary.                                                    Sh-ARROW KEYS: when pressed in combination with the shift key,    the arrows extend the current selection.                      BACKSPACE: deletes the character below the cursor, moves one      column to the left and shifts following text left.            INSERT: insert a space (" ") and shifts text to the right.      DELETE: deletes character under cursor and shifts follwing text   left.                                                   s     PAGEUP/PRIOR: move to previous block.                           PAGEDOWN/NEXT: move to next block.                              TAB: move cursor to next column that is a multiple of 8.                                                                        ^A (control-A): move cursor to start of line.                   ^E: move cursor to end of line (after last non-blank character.)^C: copy selection into snarf buffer.                           ^V: paste selection in snarf buffer at current cursor position. ^X: copy selection into snarf buffer and blank selected area.   ^Z: suspend the editor, entering `quit`.                        ^K: snarf and blank rest of line, on empty line, shift lines      below up one row.                                             ^L: insert an empty line and shift all lines below one row        down.                                                         ^S: split current line at cursor position, shifting remaining     text on the line below and all lines below that.              ^J: join next line onto current, at current cursor position.    ^O: equivalent to pressing B2 at the current cursor position.   ^P: equivalent to pressing B3 at the current cursor position.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Mouse operations                                                                                                              The editor supports a number of mouse-driven operations, which  make navigation and selection of text easier than using the     keyboard. Pressing the left mouse button (B1) will position the cursor at the location of the mouse pointer. Pressing B1 and    "sweeping" with the mouse, keeping the button pressed will      select a range of text. The number of currently selected bytes  will be shown in the status bar as "{<BYTES>}". By pressing     the ^C key combination or by using the "Snarf" command, the     selection will be copied into the "snard" buffer (indicated     by "s{<BYTES>}" in the status bar.) ^X/"Cut" will copy and blankthe selection, ^V/"Paste" will copy the contents of the snarf   buffer at the current cursor location overwriting any existing  text at that position.                                                                                                          Pressing the middle button (B2) on a word will execute the word below the mouse pointer, delimited by blanks on either side.    Sweeping the mouse while holding B2 will execute the selected   range of text.                                                                                                                  Finally, pressing the right button (B3) on a word or sweeping   a range of text will perform so called "plumbing", a user       extensible operation that depends on the selected text. The     predefined plumbing operations are:                                                                                               <NNN> (any integer between 0 and the maximal number of            blocks): jump to that block.                                                                                                  <WORD>: if the word is visible in the current search order,       jump to the definition of that word.                                                                                        Otherwise, the selected word or text is searched in the current or subsequent blocks, up to 500 blocks from the current block.  If the same text can be found, the block is shown and the cursorpositioned at the first occurrence of the searched text in that block.                                                                                                                          When code is executed with B2, the terminal is temporarily      switched into the normal echoing mode. When the execution       finished, the terminal switches back to "raw" mode.                                                                             Pressing B2 or B3 inside an existing selection is equivalent to sweeping with ther respective button.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Editor commands                                                                                                               Several commands are pre-defined to be easily accessible with   the B2 button. Some of them are alternatives to mouse-chords,   some change the editor configuration.                                                                                           Load: load the current block.                                   Wipe: blank the current block and add a standard comment in the   first line containing some useful commands.                   Snarf: copy the current selection into the snarf buffer.        Cut: copy the current selection into the snarf buffer and blank   the selection.                                                Paste: copy the contents of the snarf buffer to the current       cursor location.                                              Exit: suspend the editor.                                       Pause: toggle "pause" mode. When on (the default), wait for       the user pressing ENTER before re-entering edit mode.         Next: jump to the next block.                                   Prev: jump to the previous block.                               Back: jump back to the location before the last jump            Look: search the selection or the word under the cursor.        Xclip: copies the current selection into the X primary            selection, or copies the current X selection into the           snarf buffer (requires the xclip(1) program.)                 Fmt: format currently selected area of text as paragraphs,        sparated by empty lines, which the beginning of each paragraph  indented by 2 spaces.                                                                                                         Own commands can be defined by simply creating the appropriate  Forth word, taking no arguments and returning no result.        As described earlier, commands beginning with an uppercase      letter should avoid throwing errors so that the terminal        is not left in an inconsistent state.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ The editor vocabulary                                                                                                         Some words that interact programmatically with the editor are   available in the "forth" vocabulary. Access to the complete     set of editor words is provided by using the "editor"           vocabulary, which you should study to understand more of how    it works and how to extend it.                                                                                                  Words in the "forth" vocabulary:                                                                                                ed  ( -- )                                                        Open the editor at the last opened screen.                                                                                    edit  ( blk# -- )                                                 Open the editor and jump to the given screen.                                                                                 import  ( blk# | filename -- )                                    Read lines from the given file and copy them into the argument  and subsequent blocks.                                                                                                        export  ( blk1# blk2# | filename -- )                             Write the lines from the given range of blocks to a file.                                                                     patch  ( blk# | filename -- )                                     "Patch" the given block by loading up to 4096 bytes from the    given file.                                                                                                                   plumber  ( xt -- )                                                Add a "plumber" to the plumbing list. "xt" is executed with     a string (address + len) on the stack and should either         perform some operation and return true or should return         false to give the string to the next plumber in the plumbing    list.                                                                                                                         view  ( | word -- )                                               Locate the definition of "word" and open the editor at that     location.                                                                                                                     make  ( | filename -- )                                           Save the current state of the executable to the given file.                                                                   copy  ( blk1# blk2# -- )                                          Copy block blk1# to blk2#.                                                                                                    ncopy, ncopy>  ( blk1# blk2# -- )                                 Copy a range of blocks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Initialization                                                                                                                  "ff" normally starts in interactive mode. You can invoke the  editor at any time with "ed" or "<BLK> edit". If you want to    start the editor automatically, use "make <FNAME>" to generate  a binary that starts in edit mode. In this mode, block #1       is executed after command line processing and before edit mode  commences.                                                                                                                      Available command line arguments:                                                                                               -h              show usage information                          -n              do not load block #1 on startup                 -i              enter interactive mode instead of entering edit                 mode                                            -b FILENAME     use FILENAME as block file instead of the                       default ("ff.blk")                                                                                              By default "ff" expects a block file named "ff.blk" in the      current directory. If you want to change the location of the    block file, use the "blockfile" word and save the executable:                                                                     $ ff                                                            blockfile /usr/local/ff.blk                                     save /usr/local/bin/ff                                          bye                                                                                                                                                                                           Note:                                                                                                                           The "scratch" area is block 2000 and following. Unless you have enlarged the default blockfile, invoking "ff" with a filename   will crash.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ Miscellaneous Notes                                                                                                           When evaluating code, note that "\" (skip line) will skip all   remaining text, regardless of the number of lines the selected  text spans, as there are no line-breaks in blocks and the code  is executed using "evaluate".                                                                                                   "Pausing" (waiting for ENTER) never takes place when executed   code begins with an uppercase character.                                                                                        A selection swept with one of the mosue buttons always includes the cursor position.                                                                                                            The editor does not have any "Undo" feature and changes are     (usually) instantly saved to the memory mapped block file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  Back          \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ The Line Editor                                                                                                                 On platforms where the terminal interface does not work, a    very simple command-driven line editor is available. It is      modelled after the editing tool described in "Starting Forth"   and provides a minimal interface to modyfing blocks.                                                                              The words `ed` and `edit` work as in the screen editor and    begin an editing session. During editing, the following commandsare additionally available. After each change, the current line is shown with an indicator position at the current position     in the line.                                                                                                                    q                                                                 Leave the editor.                                                                                                             b                                                                 Move to previous screen and list it.                                                                                          n                                                                 Move to next screen and list it.                                                                                              #  ( u -- )                                                       Move to given screen.                                                                                                         cut                                                               Deletes everything on the line, from the current position to    the end.                                                                                                                      d  ( | ... -- )                                                   Searches the given text in the current line and deletes it. If  no text is given, delete the text in the find buffer.                                                                         e  ( -- )                                                         Deletes last found text.                                                                                                      f  ( | ... -- )                                                   Searches given text in current line, or searches the text in    the find buffer (from a previous search).                                                                                     i  ( | ... -- )                                                   Insert the given text (or the contents of the insert buffer).                                                                 k                                                                 Swaps contents of find and insert buffers.                                                                                    l                                                                 List current screen.                                                                                                          p  ( | ... -- )                                                   Replaces current line with the given text (or the text in the   insert buffer).                                                                                                               r  ( | ... -- )                                                   Replaces last found text with the given text or the contents    of the insert buffer.                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Editor sources + documentation 11 - Editor Manual 220                                                                         \ The Line Editor (continued)                                                                                                   s  ( u | ... -- )                                                 Searches the given text (or the contents of the find-buffer)    in the current and subsequent screens up to and including       the argument screen                                                                                                           t  ( u -- )                                                       Set the current line.                                                                                                         till  ( | ... -- )                                                Erases text from the position where the given text (or the      contents of the find buffer) can be found.                                                                                    u  ( | ... -- )                                                   Inserts the text (as with `p`) below the current line,          shifting the remaining lines down.                                                                                            a  ( | ... -- )                                                   Replaces the current line (as with `p`) and moves to the next   line.                                                                                                                         w                                                                 Display the current line and the two lines above and below.                                                                   g  ( u1 u2 -- )                                                   Copies the line u2 from screen u1 at the current line after     shifting the current and remaining lines down.                                                                                bring  ( u1 u2 u3 -- )                                            Copy the lines u2 to u3 into the current screen (as with `g`).                                                                v  ( | word -- )                                                  Jump to the screen and line where "word" is defined.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back  0        \ Editor sources + documentation 11                                                                                             \ Editor TODOs                                                                                                                  * TODO `Back` still not right                                     - seems to save intermediate positions (?)                    * TODO extend links to block-position ("BBB]PPP")                 - allow "BBB:PPP" on cmdline                                    - allow ":BBB"                                                * TODO window-resizing sometimes swaps row/col                    - borked csi sequences, gotoxy sequence incomplete              - possibly also caused by race-condition with inthandler?     * TODO sometimes mouse input inserts garbage                      - actually on resize, caused by dwm's window mgmt               - probably SIGWINCH while reading mouse event                   - try using conread directly and detecting EINTR                - easy to reproduce in slow terminals (or over ssh)               - consume "[Mxxx" sequence directly after SIGWINCH?         * TODO selection disables underlined text that follows            - needs correct style restore after `showln`                    - use xt-vectors for global/line style                        * TODO reconsider using altbuf                                  * TODO Add some sort of search+replace                          * TODO Backspace: move cursor to start of old selection         * TODO B1 twice on same position: select word below             * TODO Selection should not include cursor position at end      * TODO ^E with a single character in column 0 does not move       to column 2                                                   * TODO Look: if selection active, search starting from selend                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Look :#0                                                                                                                                                                                                                                                                              abc                                                                                                                                                                                                                                                                                                                                                           fill                       ejfkhd                                                                                                                          akskaslkas                                                      jfl kj                                                          jfl                                                             slk                                                                                                                             dls                                                              s                           Foo                                                                                                                   123                                                                 clear                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    asas                                                            asasa jdskjd                                                                                                                    ljsdkjsjjjjjjjjjjjjjjj                 jjjjjjjjjjjjjjdksjds0934                                                                 9                                                               34903940394039403940394                                                                                                                        abc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0  mdp         \ Meta compiler core 12                                                                                                         \ Meta compiler - #1                                                                                                            .( meta )                                                                                                                       \ dict-entry: [len(1) name(?) link cf pf(?)]                    \ requires: endian                                                                                                              vocabulary meta     vocabulary target                                                                                           only forth also meta definitions                                                                                                variable tbase          variable torigin                        variable mdp            variable mh                             variable mkh                                                                                                                    \ code for building the final image                             4096 constant minkernel     variable kernelsize                 variable entrypoint                                             variable codebuffer                                             variable imagestart         variable imageend                   variable codeaddr           variable codesize                   variable bssaddr            variable bsssize                    : copyimage  ( a u -- ) here swap dup >r cmove  r> allot ;      : imagesize  ( -- u ) imageend @ imagestart @ - ;               : writeimage  ( a u -- )                                          zstring w/o OPENX_MODE fsopen dup ior ?fcheck                   >r  imagestart @ imagesize r@ write-file ?fcheck                r> close-file ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Meta compiler - #2                                                                                                            : >name ;                                                       : tcells  ( u1 -- u2 ) twordsize @ * ;                          : tcell+  ( u1 -- u2 ) 1 tcells + ;                             : tallot  ( n -- ) mh +! ;                                      : tkallot  ( n -- ) mkh +! ;                                    : t,  ( x -- ) mh @ w!  1 tcells tallot ;                       : tc,  ( c -- ) mh @ c!  1 tallot ;                             : reloc  ( a1 -- a2 ) dup 0= ?exit  tbase @ - torigin @ + ;     : unreloc  ( a1 -- a2 ) dup 0= ?exit torigin @ - tbase @ + ;    : taligned  ( n1 -- n2 ) twordsize @ 1- tuck + swap invert and    ;                                                             : talign  mh @ taligned mh ! ;                                  : tloc,  blk @ 16 lshift  >in @ or t, ;                         : theader  ( a u -- )                                             space  2dup type  dup >r mh @ place  mh @  r> 1+ tallot         talign mdp @ reloc t,  tloc,  mdp !  ;                        : tcount  ( a1 -- a2 u ) count len-mask and ;                                                                                   : tfind  ( a -- a 0 | xt 1 )                                      count  mdp @  begin  ?dup  while                                  >r 2dup r@ tcount compare 0=  if                                  2drop  r> tcount + taligned 2 tcells + reloc                    1  exit  then                                                 r> tcount + taligned w@ unreloc repeat  drop  1-  0 ;                                                                       : t'  ( a1 -- xt )                                                tfind 0=  if  space  count type  true abort"  ?"  then ;      : ([t'])  ( a n -- xt ) drop  1- t' ;                           : [t']  ( | word -- a )                                           bl word count sliteral  postpone ([t']) ; immediate           : tliteral  ( x -- ) [t'] (lit) t, t, ;                         : tsliteral  ( a n -- )                                           [t'] (slit) t,  dup >r tc,  mh @ r@ cmove  r> tallot talign ;  \ not visible during cross-compilation                         : tcreate  ( a u -- ) theader  [t'] (variable) unreloc w@ t, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Meta compiler - #3                                                                                                            \ colon compiler for target definitions                         : tcompile  ( a -- )   \ counted string holding word              \ immediate word in meta vocabulary?                            dup find  0>  if  nip execute  ?stack  exit  else  drop  then   \ otherwise look up in target, compile word or literal          tfind  if  t,  exit  then                                       count number 0=  if  space type  true abort"  ?"  then          tliteral ;                                                    : t]  state on   \ "[" is re-used                                 begin  bl word dup c@ 0=  if  drop  refill  else                  tcompile  state @  then  while  repeat ;                                                                                    \ initialization                                                : metacompile  ( a1 a2  -- )                                      dup tbase !  dup mkh !  kernelsize @ + mh !                     dup torigin ! codeaddr !  mdp off ;                                                                                           \ finalization                                                  variable dictsize                                               defer set-codesize     \ align code top address as necessary    ' noop is set-codesize                                          : finalize  ( heap code -- )                                      codebuffer !                                                    mh @ codebuffer @ - dictsize !  \ size of used dictionary       space                                                           set-codesize    \ format specific                               ( heap ) codesize @ dictsize @ - - bsssize !                    codeaddr @ codesize @ + 512 ( /elfprefix ) - bssaddr !          cr cr ." dictionary size: 0x" dictsize ? ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Meta compiler - #4                                                                                                            \ target definitions (in "meta"):                                                                                               also forth                                                                                                                      : lastname  ( -- a n ) current @ @ >name count ;                : variable  ( | name -- )                                         <builds  lastname theader mh @ reloc ,  [t'] (variable)         unreloc  w@ t,  0 t,  does>  @ tcell+ ;                       : constant  ( x | name -- )                                       <builds  lastname theader  dup ,  [t'] (constant)               unreloc w@ t,  t,  does>  @ ;                                 : create  ( | name -- )                                           <builds  lastname theader  mh @ reloc ,  [t'] (variable)        unreloc w@ t,  does>  @ tcell+ ;                              : buffer:  ( u | name -- )                                        <builds  lastname theader  mh @ reloc ,  [t'] (variable)        unreloc w@ t,  tallot  does>  @ tcell+ ;                      : '  ( | name -- xt ) bl word t' ;                              : :  ( | name ... -- )                                            bl word count theader  [t'] (:) unreloc w@ t,  t] ;           : ;  [t'] exit t,  state off ; immediate                        : ]  t] ;                                                       : immediate  mdp @ dup c@  i-bit or  swap c! ;                  : [char]  ( | word -- xc ) char tliteral ; immediate            : (s")  ( | ..." -- ) [char] " parse count tsliteral ;          : s"  ( | ..." -- a n ) (s") ; immediate                        : ."  ( | ..." -- ) (s")  [t'] type t, ; immediate              : ,  ( x -- ) t, ;          : c,  ( x -- ) tc, ;                : abort"  ( f | ..." -- ) (s")  [t'] (?abort) t, ; immediate    : ,"  ( | ..." -- )                                               [char] " parse count dup >r mh @ place r> 1+ tallot ;         : [']  ( | word -- xt ) bl word t' tliteral ; immediate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Meta compiler - #5 (end)                                                                                                      : if  [t'] (if) t,  mh @ 0 t, ; immediate                       : %else     \ needed below for `endof`                            [t'] (else) t,  mh @ >r  0 t,  mh @ reloc swap w!  r> ;       : else  %else ; immediate                                       : then  mh @ reloc swap w! ; immediate                          : begin  mh @ ; immediate                                       : while  [t'] (if) t,  mh @  0 t, ; immediate                   : again  [t'] (else) t,  reloc t, ; immediate                   : repeat  [t'] (else) t,  swap reloc t,  mh @ reloc swap w! ;     immediate                                                     : until  [t'] (if) t,  reloc t, ; immediate                     : do  ( n1 n2 -- ) [t'] (do) t,  0 mh @ ; immediate             : ?do  true abort" ?do not available in meta compiler" ;          immediate                                                     : loop  ( -- )                                                    [t'] (loop) t,  reloc t,  ?dup  if  mh @ reloc swap w!  then ;  immediate                                                     : +loop  ( n -- )                                                 [t'] (+loop) t,  reloc t, ?dup  if  mh @ reloc swap w! then ;   immediate                                                     : defer  ( | word -- )      \ note: does not init with ' crash    bl word count theader  [t'] (defer) unreloc w@ t,  0 t, ;     : is  ( xt | word -- )                                            bl word t'  state @  if  tliteral  [t'] defer! t,               else  tcell+ unreloc w!  then ; immediate                     : of  ( -- sys )                                                  [t'] over t,  [t'] = t,  [t'] (if) t,  mh @ 0 t,                [t'] drop t, ; immediate                                      : endof  ( sys -- sys ) %else ; immediate                       : tesac ( 0 i*sys -- )                                            begin  ?dup while  mh @ reloc swap w!  repeat ;               : endcase ( 0 i*sys -- ) [t'] drop t,  tesac ; immediate        : cells  tcells ;                                                                                                               only forth definitions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ generic assembler - portable part                                                                                             \ requires: endian meta                                                                                                         .( generic )                                                                                                                    vocabulary generic                                              : ahere  ( -- a ) mkh @ ;                                       : a,  ( x -- ) ahere c!  1 tkallot ;                            : aw,  ( x -- ) ahere w!  1 tcells tkallot ;                    [defined] target-little-endian [if]                             : a2,  ( x -- ) ahere le2!  2 tkallot ;                         : a4,  ( x -- ) ahere le4!  4 tkallot ;                         : a8,  ( x -- ) ahere le8!  8 tkallot ;                         [else]                                                          : a2,  ( x -- ) ahere be2!  2 tkallot ;                         : a4,  ( x -- ) ahere be4!  4 tkallot ;                         : a8,  ( x -- ) ahere be8!  8 tkallot ;                         [then]                                                          : code  ( | name -- )                                             bl word count theader mkh @ reloc t, also generic ;           : end-code  previous ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Endian-neutral memory access - #1                                                                                             .( endian )                                                                                                                     : hisign  ( n1 -- n2 ) 0<  if  -1  else 0  then ;                                                                               \ big endian                                                    : be2@  ( a -- x ) dup c@ 8 lshift  swap 1+ c@ or ;             : be2!  ( x a -- ) over 8 rshift over c!  1+ c! ;               : be4@  ( a -- x )                                                dup c@ 24 lshift over 1+ c@ 16 lshift or over 2 + c@            8 lshift or swap 3 + c@ or ;                                  : be4!  ( x a -- )                                                swap dup >r 24 rshift over c! r@ 16 rshift over 1+ c!           r@ 8 rshift over 2 + c! r> swap 3 + c! ;                      1 cells 4 =  [if]                                               : be8@  ( a -- x ) 4 + be4@ ;                                   : be8!  ( x a -- ) over hisign over !  swap 4 + ! ;             [else]                                                          : be8@  ( a -- x ) dup be4@ 32 lshift swap 4 + be4@ or ;        : be8!  ( x a -- ) over 32 rshift over be4! 4 + be4! ;          [then]                                                                                                                          \ little endian                                                 : le2@  ( a -- x ) dup c@ swap 1+ c@ 8 lshift or ;              : le2!  ( x a -- ) 2dup c!  swap 8 rshift swap 1+ c! ;          : le4@  ( a -- x )                                                dup c@ over 1+ c@ 8 lshift or over 2 + c@ 16 lshift or          swap 3 + c@ 24 lshift or ;                                    : le4!  ( x a -- )                                                swap dup >r over c! r@ 8 rshift over 1+ c! r@ 16 rshift         over 2 + c! r> 24 rshift swap 3 + c! ;                        1 cells 4 =  [if]                                               : le8@  ( a -- x ) le4@ ;                                       : le8!  ( x a -- ) 2dup le4! swap hisign swap 4 + le4! ;        [else]                                                          : le8@  ( a -- x ) dup le4@ swap 4 + le4@ 32 lshift or ;        : le8!  ( x a -- ) 2dup le4! swap 32 rshift swap 4 + le4! ;     [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler core 12                                                                                                         \ Endian-neutral memory access - #2 (end)                                                                                                                                                       defer w4@   defer w4!   defer w2!   defer w2@                   defer w8@   defer w8!   defer w!    defer w@                    variable target/e                                               variable twordsize      1 cells twordsize !                     : w2,  ( x -- ) here w2!  2 allot ;                             : w4,  ( x -- ) here w4!  4 allot ;                             : w8,  ( x -- ) here w8!  8 allot ;                             : w,  ( x -- ) here w!  twordsize @ allot ;                     : wordsize  ( u -- ) twordsize ! ;                              : little                                                          ['] le2@ is w2@  ['] le2! is w2!                                ['] le4@ is w4@  ['] le4! is w4!                                ['] le8@ is w8@  ['] le8! is w8!                                twordsize @  case                                                 2  of  ['] le2@ is w@  ['] le2! is w!  endof                    4  of  ['] le4@ is w@  ['] le4! is w!  endof                    8  of  ['] le8@ is w@  ['] le8! is w!  endof                  endcase  target/e off ;                                       : big                                                             ['] be2@ is w2@  ['] be2! is w2!                                ['] be4@ is w4@  ['] be4! is w4!                                ['] be8@ is w8@  ['] be8! is w8!                                twordsize @  case                                                 2  of  ['] be2@ is w@  ['] be2! is w!  endof                    4  of  ['] be4@ is w@  ['] be4! is w!  endof                    8  of  ['] be8@ is w@  ['] be8! is w!  endof                  endcase  target/e on ;                                        : report-endianness                                               ." host is "  1 cells 8 * . ." bits "                           [defined] big-endian  [if]  ." (big-endian)"                    [else]  ." (little-endian)"  [then]                             ." , target is "  twordsize @ 8 * . ." bits "                   target/e @  if  ." (big-endian)"                                else  ." (little-endian)"  then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler 12                                                                                                              \ Executable formats                                             ELF                                            330 - 334        Mach-O                                         335 - 339        Flat                                           340              Multiboot                                      341                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev     :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler 12 - Executable formats 325                                                                                     \ ELF binary generation - #1                                                                                                     \ Assuming one text, one data and one bss section               \ and no frills.                                                                                                               \ requires: endian meta                                                                                                         .( elf )                                                                                                                        \ machine parameters                                            variable mparams        variable >machine   variable mdef       : machine  ( | name -- )                                          <builds  here cell+ ,  mparams off  mdef on                     does>  @ >machine !  ;                                        : slot  ( | name -- )                                             <builds  mparams @ ,  1 mparams +!                              does>  ( x -- | -- a )                                          mdef @  if  drop ,  else  @ cells >machine @ +  then ;        slot elfdata   slot elfalign                                    slot elfflags  slot elfmachine  slot elfbase                    slot elfclass                                                   1 constant LSB          2 constant MSB                          1 constant ELFCLASS32   2 constant ELFCLASS64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12 - Executable formats 325                                                                                     \ ELF binary generation - #2                                                                                                    machine i386-elf                                                 LSB elfdata    h# 1000 elfalign                                 0 elfflags     3 elfmachine                                     h# 8048000 elfbase  ELFCLASS32 elfclass                        machine x86_64-elf                                               LSB elfdata    h# 10000 elfalign \ defaults seems to be 2M      0 elfflags     62 elfmachine                                    h# 400000 elfbase  ELFCLASS64 elfclass                         machine arm-elf                                                  LSB elfdata    h# 8000 elfalign                                 h# 5000002 elfflags    40 elfmachine                            h# 8000 elfbase  ELFCLASS32 elfclass                           machine armeb-elf                                                MSB elfdata    h# 8000 elfalign                                 h# 5000002 elfflags    40 elfmachine                            h# 8000 elfbase  ELFCLASS32 elfclass                           machine sparc-elf                                                MSB elfdata    h# 10000 elfalign                                0 elfflags     2 elfmachine                                     h# 10000 elfbase  ELFCLASS32 elfclass                          machine mips-elf                                                 MSB elfdata    h# 10000 elfalign                                0 elfflags     8 elfmachine                                     h# 400000 elfbase  ELFCLASS32 elfclass                         machine mipsel-elf                                               LSB elfdata    h# 10000 elfalign                                0 elfflags     8 elfmachine                                     h# 400000 elfbase  ELFCLASS32 elfclass                         machine ppc-elf                                                  MSB elfdata    h# 10000 elfalign                                0 elfflags     20 elfmachine                                    h# 10000000 elfbase  ELFCLASS32 elfclass                       machine riscv32-elf                                              LSB elfdata    h# 10000 elfalign                                0 elfflags     h# f3 elfmachine                                 h# 10000 elfbase  ELFCLASS32 elfclass                          machine riscv64-elf                                              LSB elfdata    h# 10000 elfalign                                0 elfflags     h# f3 elfmachine                                 h# 10000 elfbase  ELFCLASS64 elfclass                          machine m68k-elf                                                 MSB elfdata    h# 1000 elfalign                                 0 elfflags     4 elfmachine                                     h# 2000 elfbase  ELFCLASS32 elfclass                           machine sh4-elf                                                  LSB elfdata    h# 1000 elfalign                                 0 elfflags     42 elfmachine                                    h# 400000 elfbase  ELFCLASS32 elfclass                         machine sh4eb-elf                                                MSB elfdata    h# 1000 elfalign                                 0 elfflags     42 elfmachine                                    h# 400000 elfbase  ELFCLASS32 elfclass                         mdef off                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler 12 - Executable formats 325                                                                                     \ ELF binary generation - #3                                                                                                    0 constant ELFOSABI_SYSV        2 constant ELFOSABI_NETBSD      3 constant ELFOSABI_LINUX       9 constant ELFOSABI_FREEBSD     12 constant ELFOSABI_OPENBSD                                    variable elfosabi                                               2variable elfnote    2variable elfosdesc   2variable elfosname  variable W^X    W^X off                                                                                                         create linux_osname ," GNU" 0 c,                                : linux_osdata  ( -- a )                                          here  0 w4, 2 w4, 6 w4, 0 w4, ;  \ OS: Linux, ABI: 2.6.0      : select-linux                                                    ELFOSABI_LINUX elfosabi !                                       linux_osname count 1+ elfosname 2!                              linux_osdata 16 elfosdesc 2! ;                                create none_osname ," ff-elf" 0 c,                              : select-none       \ plain elf for qemu kernels (for example)    ELFOSABI_SYSV elfosabi !                                        none_osname count 1+ elfosname 2!                               pad 0 elfosdesc 2! ;                                          create freebsd_osname ," FreeBSD" 0 c,                          create freebsd_osdata 0 ,   \ ???                               : select-freebsd                                                  ELFOSABI_FREEBSD elfosabi !                                     freebsd_osname count 1+ elfosname 2!                            freebsd_osdata 4 elfosdesc 2! ;                               create netbsd_osname ," NetBSD" 0 c,                            : netbsd_osdata  ( -- a ) here 105000000 w4, ; \ NetBSD 1.5     : select-netbsd                                                   ELFOSABI_NETBSD elfosabi !                                      netbsd_osname count 1 + elfosname 2!                            netbsd_osdata 4 elfosdesc 2! ;                                create openbsd_osname ," OpenBSD" 0 c,                          create openbsd_osdata 0 ,                                       : select-openbsd                                                  ELFOSABI_OPENBSD elfosabi !  W^X on                             openbsd_osname count 1 + elfosname 2!                           openbsd_osdata 4 elfosdesc 2! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ ELF binary generation - #4                                                                                                    : notesize  ( -- u )                                              elfosname 2@ nip aligned                                        elfosdesc 2@ nip aligned + 3 4 *  + ;                         512 constant /elfprefix                                         : elfbaseaddr  ( -- a ) elfbase @ /elfprefix + ;                : elfmagic  [ hex ] 7f c,  45 c,  4c c,  46 c,  [ decimal ] ;   2 constant EXEC                                                 52 constant ehsize32        64 constant ehsize64                32 constant phentsize32     56 constant phentsize64             3 constant phnum                                                1 constant LOAD         4 constant NOTE                         1 constant PROGBITS     8 constant NOBITS                       6 constant AX           7 constant WAX                          5 constant RE           7 constant RWE                          6 constant RW                                                   1 constant EV_CURRENT                                           1 constant ELF_NOTE_TYPE_OSVERSION                              : elf64  ( -- f ) elfclass @ ELFCLASS64 = ;                     : elf32  ( -- f ) elfclass @ ELFCLASS32 = ;                     : elfoffset  ( -- u ) here imagestart @ - ;                     \ ELF header                                                    : elfheader                                                       elfmagic                                                        elfclass @ c,                                                   elfdata @ c,  EV_CURRENT c,                                     elfosabi @ c, 0 c,     \ e_ident                                 7 allot         \ padding                                      EXEC w2,          \ e_type                                      elfmachine @ w2,  \ e_machine                                   EV_CURRENT w4,    \ e_version                                   entrypoint @ w,  \ e_entry                                      elf64  if  ehsize64  else  ehsize32  then w,      \ e_phoff     0 w,             \ e_shoff                                      elfflags @ w4,    \ e_flags                                     elf64  if  ehsize64  else  ehsize32  then w2,     \ e_ehsize    elf64  if  phentsize64  else  phentsize32  then w2,             \ e_phentsize                                                   phnum w2,         \ e_phnum                                     0 w2,             \ e_shentsize                                 0 w2,             \ e_shnum                                     0 w2, ;           \ e_shstrndx                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ ELF binary generation - #5 (end)                                                                                              \ program headers                                               variable dataflags                                              : prgheaders                                                      \ code:                                                         LOAD w4,         \ p_type                                       elf64  if  RE w4,  then  \ p_flags (elf64)                      0 w,            \ p_offset                                      elfbase @ dup w, w, \ p_vaddr + p_paddr                         kernelsize @ dup w, w, \ p_filesz, p_memsz                      elf32  if  RE w4,  then   \ p_flags (elf32)                     elfalign @ w,   \ p_align                                       \ data/bss:                                                     W^X @  if  RW  else  RWE  then  dataflags !                     LOAD w4,         \ p_type                                       elf64  if  RW w4,  then  \ p_flags (elf64)                      kernelsize @ w,  \ p_offset                                     elfbase @ kernelsize @ + dup w, w,  \ p_vaddr + p_paddr         codesize @ kernelsize @ - w,  \ p_filesz                        codesize @ bsssize @ + w,  \ p_memsz                            elf32  if  dataflags @ w4,  then   \ p_flags (elf32)            elfalign @ w,   \ p_align                                       \ note:                                                         NOTE w4,         \ p_type                                       elf64  if  RW w4,  then  \ p_flags (elf64)                      elf64  if  6   else  7  then  twordsize @ * elfoffset + w,       \ p_offset                                                     bssaddr @ bsssize @ + dup w, w, \ p_vaddr + p_paddr             notesize dup w, w,  \ p_filesz, p_memsz                         elf32  if  RW w4,  then  \ p_flags (elf32)                      4 w, ;          \ p_align                                     \ note segment                                                  : notesegment  ( desc descsz name namesz -- )                     dup w4,         \ namesz                                        2 pick w4,      \ descsz                                        ELF_NOTE_TYPE_OSVERSION w4, \ type                              dup >r here swap cmove  r> allot  align    \ name               dup >r here swap cmove  r> allot  align ;  \ desc             : addnote  elfosdesc 2@ elfosname 2@ notesegment ;              \ copy text section                                             : copydata                                                        codebuffer @ codesize @ /elfprefix - copyimage ;               \ align codesize (including elfheader) up to elf alignment     : elfaligned  ( a1 -- a2 )                                        elfalign @ 1-  swap over + swap invert and ;                  :noname  dictsize @ /elfprefix +                                  elfaligned codesize ! ; is set-codesize                       : genimage                                                        here imagestart !  here /elfprefix erase                        elfheader  prgheaders  addnote                                  /elfprefix elfoffset - allot ( pad )                            copydata  here imageend ! ;                                                                                                   create target-elf                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ Mach-O binary generation - #1                                                                                                  \ Assuming one text, one data, one bss section and no frills.                                                                  \ requires: endian meta                                                                                                         .( macho )                                                                                                                      512 constant /machoprefix                                       4096 constant pagesize                                          variable machobase                                              7 constant CPU_TYPE_X86                                         h# 01000007 constant CPU_TYPE_X86_64                            3 constant CPU_SUBTYPE_I386_ALL                                 h# 80000003 constant CPU_SUBTYPE_X86_64_ALL                     2 constant MH_EXECUTE       1 constant MH_NOUNDEFS              1 constant LC_SEGMENT           h# 19 constant LC_SEGMENT_64    5 constant LC_UNIXTHREAD                                        1 constant VM_PROT_READ     2 constant VM_PROT_WRITE            4 constant VM_PROT_EXECUTE                                      1 constant I386_THREAD_STATE                                    4 constant X86_THREAD_STATE64                                   16 constant I386_THREAD_STATE_COUNT                             42 constant X86_THREAD_STATE64_COUNT                            h# 1000 constant baseaddr_i386                                  h# 100000000 constant baseaddr_x86_64                           h# feedface constant i386-magic                                 h# feedfacf constant x86_64-magic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ Mach-O binary generation - #2                                                                                                 variable cputype    variable cpusubtype     variable lc_segment : machobaseaddr  ( -- a ) machobase @ /machoprefix + ;          : machooffset  ( -- u ) here imagestart @ - ;                   : macho64  ( -- f ) twordsize @ 8 = ;                           : magic  macho64  if  x86_64-magic  else  i386-magic  then  w4,   ;                                                              \ align value up to page size                                  : machoaligned  ( a1 -- a2 )                                      pagesize 1-  swap over + swap invert and ;                                                                                    defer machocpustate                                             : i386-cpustate                                                   I386_THREAD_STATE w4, \ flavor                                  I386_THREAD_STATE_COUNT w4,   \ count                           10 tcells allot  entrypoint @ w4,  5 tcells allot ; \ regs    : x86_64-cpustate                                                 X86_THREAD_STATE64 w4, \ flavor                                 X86_THREAD_STATE64_COUNT w4,   \ count                          16 tcells allot  entrypoint @ w8,  4 tcells allot ; \ regs    : i386-macho                                                      CPU_TYPE_X86 cputype !  CPU_SUBTYPE_I386_ALL cpusubtype !       baseaddr_i386 machobase !  LC_SEGMENT lc_segment !              ['] i386-cpustate is machocpustate ;                          : x86_64-macho                                                    1 cells 8 <>                                                      abort" 64-bit darwin file can only be generated by 64-bit host"                                                               CPU_TYPE_X86_64 cputype !  CPU_SUBTYPE_X86_64_ALL cpusubtype !  baseaddr_x86_64 machobase !  LC_SEGMENT_64 lc_segment !         ['] x86_64-cpustate is machocpustate ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ Mach-O binary generation - #3                                                                                                 variable totalsize                                              : machoheader                                                     magic                                                           cputype @ w4,                                                   cpusubtype @ w4,                                                MH_EXECUTE w4,    \ filetype                                    4 w4,             \ ncmds                                       here totalsize ! 0 w4,    \ size of all LCs                     MH_NOUNDEFS w4,             \ flags                             macho64  if  0 w4,  then ;    \ reserved                      : ,str16  ( a u -- ) here swap cmove  16 allot ;                : wm,  ( x -- ) macho64  if  w8,  else  w4,  then ;             : fixsize  ( a1 a2 -- ) here rot - swap w4! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ Mach-O binary generation - #4                                                                                                 : loadcmds                                                        \ pagezero:                                                     here              \ remember start of LC                        lc_segment @ w4, \ cmd                                          here 0 w4,        \ cmdsize (take addr)                         s" __PAGEZERO" ,str16 \ segname                                 0 wm,            \ vmaddr                                       machobase @ wm,  \ vmsize                                       0 wm, 0 wm, 0 w4, 0 w4,   \ fileoff filesize maxprot initprot   0 w4, 0 w4,       \ nsects flags                                fixsize                                                         \ code segment:                                                 here                                                            lc_segment @ w4,    \ cmd                                       here 0 w4,        \ cmdsize                                     s" __TEXT" ,str16   \ segname                                   machobase @ wm,     \ vmaddr                                    kernelsize @ wm,  \ vmsize                                      0 wm,             \ offset                                      kernelsize @ wm,    \ filesize                                  VM_PROT_READ VM_PROT_EXECUTE or dup w4, w4, \ maxprot initprot  0 w4,             \ nsects                                      0 w4,             \ flags                                       fixsize                                                         \ data/bss segment:                                             here                                                            lc_segment @ w4,    \ cmd                                       here 0 w4,        \ cmdsize                                     s" __DATA" ,str16 \ segname                                     machobase @ kernelsize @ + wm,    \ vmaddr                      codesize @ kernelsize @ - machoaligned bsssize @ + wm, \ vmsz   kernelsize @ wm,  \ offset                                      codesize @ kernelsize @ - wm,    \ filesize                     VM_PROT_READ VM_PROT_WRITE or dup w4, w4, \ maxprot initprot    0 w4,             \ nsects                                      0 w4,             \ flags                                       fixsize                                                         \ unixthread segment:                                           here                                                            LC_UNIXTHREAD w4,     \ cmd                                     here 0 w4,            \ cmdsize                                 machocpustate                                                   fixsize                                                         here imagestart @ - totalsize @ ! ;   \ fixup sizeofcmds                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12 - Executable formats :#325                                                                                 \ Mach-O binary generation - #5 (end)                                                                                           : copydata                                                        codebuffer @ codesize @ /machoprefix - copyimage ;            :noname  dictsize @ /machoprefix +                                machoaligned codesize ! ; is set-codesize                     : genimage                                                        here imagestart !  here /machoprefix erase                      machoheader  loadcmds  /machoprefix machooffset - allot \ pad   copydata  here imageend ! ;                                                                                                   create target-macho                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler 12 - Executable formats 325                                                                                     \ flat file generation                                                                                                          \ requires: meta                                                                                                                .( flat )                                                                                                                       : copydata  codebuffer @ codesize @ copyimage ;                 : genimage  here imagestart !  copydata  here imageend ! ;                                                                      :noname  dictsize @ codesize ! ; is set-codesize                                                                                create target-flat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12 - Executable formats 325                                                                                     \ GRUB "multiboot" file generation                                                                                              \ requires: meta endian                                                                                                         .( multiboot )                                                                                                                  h# 1BADB002 constant mb-magic                                   h# 00010000 constant mb-flags                                   h# 100000 constant multibootbase                                mb-magic mb-flags + negate constant mb-checksum                 512 constant mb-prefix      \ same as /elfprefix                                                                                : copydata  codebuffer @ codesize @ copyimage ;                 : multibootbaseaddr  ( -- a ) multibootbase mb-prefix + ;                                                                       : mb-header                                                       mb-magic w4,      \ magic                                       mb-flags w4,      \ flags                                       mb-checksum w4,   \ checksum                                    multibootbase w4,       \ header_addr                           multibootbase w4,       \ load_addr                             0 w4,             \ load_end_addr                               bssaddr @ bsssize @ + w4,     \ bss_end_addr                    entrypoint @ w4, ; \ entry_addr                                                                                               : mb-offset  ( -- u ) here imagestart @ - ;                                                                                     : genimage                                                        here imagestart !  here mb-prefix erase  mb-header              mb-prefix mb-offset - allot ( pad )                             copydata  here imageend ! ;                                                                                                   :noname  dictsize @ codesize ! ; is set-codesize                                                                                create target-multiboot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Metacompilation template                                                                                                      \ load this with `metaconf` set to the correct                  \ configuration block:                                                                                                          only forth definitions                                          marker meta-new                                                 320 321 thru    \ endian neutral operations                     warnings off    \ metacompiler redefines many words             300 304 thru    \ meta compiler core                            : k  1024 * ;                                                   256 k constant /cbuffer                                         4 k k constant heapsize                                         2 k constant stacksize                                          256 constant rstacksize                                          \ force 64-bit alignment                                       here  /cbuffer 8 + allot  7 + 7 invert and constant cbuffer     cbuffer /cbuffer erase                                          also meta  also forth                                           metaconf @ load                                                 cr report-endianness cr                                         only forth  also meta definitions  also forth                   310 load        \ "generic" base                                also generic definitions  also forth                            load-generic                                                    baseaddr cbuffer metacompile                                    only forth  also target definitions  also meta                  cr .( compiling kernel ... )                                    360 363 thru    \ kernel                                        target-configuration                                            cr .( compiling core ... )                                      100 117 thru    \ core                                          185 load        \ minimal blockfile access                      load-startup                                                    only forth  also meta  warnings on  hex                         heapsize cbuffer finalize                                       ( meta `'`: ) ' _start unreloc w@  [defined] target-cortex        [if]  1+  [then]      \ odd for thumb                           dup entrypoint !                                              cr .( entry point: 0x) .                                        mdp @ reloc dup ' dp unreloc tcell+ w!  \ dp: last header       .(  dp: 0x) .                                                   mh @ reloc dup ' h unreloc tcell+ w!    \ h: heap start         .(  h: 0x) .                                                    bssaddr @ bsssize @ + dup ' s0 unreloc tcell+ w! \ s0: heap end dup .(  s0: 0x) .                                               stacksize rstacksize + tcells - dup ' r0 unreloc \ r0: stack     tcell+ w!  .( r 0: 0x) .                                       decimal                                                         genimage                                                        cr .( writing file ) output-filename 2dup type                    writeimage                                                    only forth definitions                                          cr .(  cleaning up.)                                            meta-new                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              variable metaconf                                                                                                               \ Metacompilation shortcuts                                                                                                     : mconf  ( b# | name -- ) <builds  ,  does>  @ metaconf !         345 load ;                                                                                                                    500 mconf make-i386-linux                                       501 mconf make-i386-freebsd                                     502 mconf make-i386-netbsd                                      503 mconf make-i386-openbsd                                     510 mconf make-arm-linux                                        511 mconf make-arm-freebsd                                      512 mconf make-arm-netbsd                                       513 mconf make-arm-openbsd                                      520 mconf make-x86_64-linux                                     521 mconf make-x86_64-freebsd                                   522 mconf make-x86_64-netbsd                                    523 mconf make-x86_64-openbsd                                   524 mconf make-x86_64-darwin                                    525 mconf make-sh4-linux                                        526 mconf make-riscv-linux                                      527 mconf make-riscv64-linux                                    528 mconf make-cortex-linux                                     529 mconf make-m68k-linux                                                                                                       347 mconf make-i386-bare-pc                                     348 mconf make-arm-bare-rpi                                     349 mconf make-sparc-bare-leon                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Meta compiler 12                                                                                                              \ Metacompile-configuration for bare PC                                                                                         .( configuration is bare PC/i386 )                                                                                              4 wordsize                                                      little                                                          create target-little-endian                                     create target-i386                                              341 load     \ multiboot                                        minkernel kernelsize !                                          multibootbaseaddr constant baseaddr                             : load-generic  382 384 thru ;                                  : target-configuration                                            351 load      \ bare                                            s" i386" tcreate                                                s" little-endian" tcreate ;                                   : load-startup  561 load ;                                      : output-filename  ( -- a u ) s" ff.bin" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Meta compiler 12                                                                                                              \ Metacompile-configuration for bare bones Raspberry/PI                                                                         .( configuration is bare RaspberryPI/i386 )                                                                                     4 wordsize                                                      little                                                          create target-little-endian                                     create target-arm                                               330 334 thru     \ elf                                          select-none    arm-elf                                          minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  401 404 thru ;                                  : target-configuration                                            351 load      \ bare                                            s" arm" tcreate                                                 s" elf" tcreate                                                 s" little-endian" tcreate ;                                   : load-startup  571 load ;                                      : output-filename  ( -- a u ) s" ffarm.elf" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler 12                                                                                                              \ Metacompile-configuration for bare bones Sparc/LEON                                                                           .( configuration is bare LEON GRIP/Sparc )                                                                                      4 wordsize                                                      big                                                             create target-big-endian                                        create target-sparc                                             340 load        \ flat                                          minkernel kernelsize !                                          h# 40000000 constant baseaddr                                   : load-generic  441 443 thru ;                                  : target-configuration                                            351 load      \ bare                                            s" sparc" tcreate                                               s" flat" tcreate                                                s" big-endian" tcreate ;                                      : load-startup  581 load ;                                      : output-filename  ( -- a u ) s" ffleon.bin" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Platform-specific code 13                                                                                                     \ UNIX I/O                                                                                                                      .( unix )                                                                                                                       : halt  ( u -- ) sys_exit syscall1 ;                            : fsread  ( fd a u -- n ) sys_read syscall3 ;                   : fswrite  ( fd a u -- n ) sys_write syscall3 ;                                                                                 : fsopen  ( cstr flags mode -- fd )                             [defined] target-openat  [if]                                     >r >r >r -100 r> r> r> sys_openat syscall4                    [else]                                                            sys_open syscall3                                             [then] ;                                                                                                                        : fscreate  ( cstr flags mode -- fd ) fsopen ;                  : fsclose  ( fd -- n ) sys_close syscall1 ;                     : fsunlink  ( cstr -- n ) sys_unlink syscall1 ;                                                                                 : fsseek  ( fd pos -- n )                                       [defined] target-lseek64pad  [if]                                 >r  0  r>                                                       0  [defined] target-big-endian  [if]  swap  [then]              0 ( SEEK_SET ) sys_lseek  syscall5                            [else] [defined] target-lseek64  [if]                             0  [defined] target-big-endian  [if]  swap  [then]              0  sys_lseek  syscall4                                        [else]                                                            0  sys_lseek  syscall3                                        [then] [then] [then] ;                                                                                                          : fsstat  ( fd a u -- n ) drop sys_fstat syscall2 ;             : conread  ( channel a -- c 1|0 ) dup >r 1 fsread  r> c@ swap ; : conwrite  ( channel a u -- ) fswrite drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform-specific code 13                                                                                                     \ stub system calls for "bare" PC hardware                                                                                      .( bare )                                                                                                                       : unimp1  drop  -1 ;                                            : unimp2  drop drop -1 ;                                        : unimp3  drop drop drop -1 ;                                                                                                   defer halt                                                      defer fsread     defer fswrite    defer fsopen                  defer fscreate   defer fsclose    defer fsunlink                defer fsseek     defer fsstat                                                                                                   : (halt)  begin again ;  ' (halt) is halt                       ' unimp3 is fsread      ' unimp3 is fswrite                     ' unimp3 is fsopen      ' unimp3 is fscreate                    ' unimp1 is fsclose     ' unimp1 is fsunlink                    ' unimp2 is fsseek      ' unimp3 is fsstat                                                                                      defer conread       defer conwrite                                                                                              0 constant OPEN_MODE                                            0 constant O_TRUNC                                                                                                              0 constant r/o      0 constant r/w      0 constant a/o          0 constant w/o                                                                                                                  0 constant stat>size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ generic kernel -  #1                                                                                                           \ dict-entry: [bits/len(1) name(?) link cf pf(?)]                                                                              code (variable)  ( -- a ) dup w cell+ next  end-code                                                                            variable h      variable dp     variable args                   variable r0     variable s0                                     code _start                                                       osargs y!         \ save argc+argv ptr                          args # x! y !     \ and store                                   dp # @ x!         \ fetch last word in dictionary and enter     \ add len + align to extract pf                                 c@ + 1+ aligned cell+ cell+ cell+ ap!                           r0 # @ rp!        \ reset rp, or initial (:) will crash         s0 # @ sp!        \ reset sp, as we need it before first                          \ `clear`                                     next                                                          end-code                                                        code (lit)  ( -- x ) dup ap @ skip  next  end-code              code (:)  x!  ap >r  w cell+ ap!  x  next  end-code             code exit  x!  r> ap! x  next  end-code                         code (constant)  ( -- x ) dup w cell+ @  next  end-code         code reset  x!  r0 # @ rp!  x  next  end-code                   code @  ( a -- x ) @  next  end-code                            code !  ( x a -- ) x! drop !  drop  next  end-code              code c@  ( a -- c ) c@  next  end-code                          code c!  ( c a -- ) x! drop c!  drop  next  end-code            code sp@  ( -- a ) dup sp  next  end-code                       code sp!  ( ... a -- ... ) x! drop y!  x sp!  y  next  end-code code rp@  ( -- a ) dup rp  next  end-code                       code rp!  ( a -- ) rp! drop  next  end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ generic kernel -  #2                                                                                                          code (does>)  ( -- a )                                            dup  ap >r  w cell+ @ ap!  w cell+ cell+  next                end-code                                                        code (else)  x!  ap @ ap!  x  next  end-code                    code (if)  ( f -- )                                               x!  ap @ y! ap cell+ ap!  x 0=  if  y ap!  then  drop next    end-code                                                        code (slit)  ( -- a u )                                           dup ap c@ x!  ap 1+ dup  + aligned ap!  x  next               end-code                                                        code (do)  ( hi lo -- ) >r drop >r drop  next  end-code         code (loop)                                                       y!  rp cell- cell- @ 1+ x!  rp cell- @                          <  if  x z!  rp cell- cell- x! z !  ap @ ap!  y  next  then     skip  rp cell- cell- rp!  y  next                             end-code                                                        code (+loop)  ( n -- )                                            x!  rp cell- cell- @ + x!  rp cell- @                           <  if  x z!  rp cell- cell- x! z !  ap @ ap!  drop  next  then  skip  rp cell- cell- rp!  drop  next                          end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10                                                                                                               \ generic kernel -  #3                                                                                                          code r@  ( -- x ) dup rp cell- @  next  end-code                code >r  ( x -- ) >r drop  next  end-code                       code r>  ( -- x ) dup r>  next  end-code                        code i  ( -- n ) dup rp cell- cell- @  next  end-code           code j  ( -- n ) dup rp x! cell- cell- cell- cell- @  next  end-code                                                            code +  ( n1 n2 -- n ) x! drop +  next  end-code                code -  ( n1 n2 -- n ) x! drop -  next  end-code                code *  ( n1 n2 -- n ) x! drop *  next  end-code                code /mod  ( n1 n2 -- n3 n4 )                                     x! drop /mod y! x dup y  next                                 end-code                                                        code u/mod  ( u1 u2 -- u3 u4 )                                    x! drop u/mod y! x dup y  next                                end-code                                                        code and  ( n1 n2 -- n ) x! drop and  next  end-code            code or  ( n1 n2 -- n ) x! drop or  next  end-code              code xor  ( n1 n2 -- n ) x! drop xor  next  end-code            code swap  ( x y -- y x ) x! drop y! x dup y  next  end-code    code drop  ( x -- ) drop  next  end-code                        code dup  ( x -- x x ) dup  next  end-code                      code over  ( x y -- x y x ) x! sp @ y!  x dup  y  next            end-code                                                      code = ( x y -- f )                                               x! drop =  if  -1 #  else  0 #  then  next                    end-code                                                        code u<  ( u1 u2 -- f )                                           y! drop x! y u<  if  -1 #  else  0 #  then  next              end-code                                                        code <  ( n1 n2 -- f )                                            y! drop x! y <  if  -1 #  else  0 #  then  next               end-code                                                        code lshift  ( x u -- y ) x! drop lshift  next  end-code        code rshift  ( x u -- y ) x! drop rshift  next  end-code        code rshifta  ( x u -- y ) x! drop rshifta  next  end-code      code execute  ( ... a -- ... ) w! @ x! drop jump  end-code      code (defer)  y!  w cell+ @ w!  @ x!  y jump  end-code          code unloop  x!  rp cell- cell- rp!  x  next  end-code          code brk  break  next  end-code                                 code pause  pause  next  end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ generic kernel -  #4                                                                                                          code lock?  ( a -- f )                                            x! 1 # trylock 0=  if  -1 #  else  0 #  then  next            end-code                                                                                                                        [defined] target-i386  [if]                                     variable isr1_on                                                code portc!  ( x p -- ) x! drop portc!  drop  next  end-code    code portc@  ( p -- x ) y! 255 # x!  y portc@ and  next           end-code                                                      code ticks  ( -- hi lo ) dup ticks y! x dup  y  next  end-code  code lidt  ( a -- ) lidt  drop  next  end-code                  code sti  sti  next  end-code                                   code isr1                                                         cli  dup  x dup  isr1_on # x! 1 # !                             32 # x!  32 # portc!  \ EOI, for PIC interrupts                 drop x!  drop  sti  iret                                      end-code                                                        [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10                                                                                                               \ Assemblers                                                    x86                                             600 - 623       Arm                                             630 - 691       SPARC                                           693 - 699       MIPS                                            700 - 704       RISC-V                                          705 - 710       PowerPC                                         711 - 722                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13                                                                                                     \ i386                                                            "generic" implementation                      382 - 384                                                                       \ OS-specific system calls and code                               Linux system calls                            385               Linux signal handlers                         550               BSD system calls                              386 - 387         FreeBSD                                       388               OpenBSD                                       389               NetBSD                                        390                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ generic i386 operations - #1                                                                                                   \ TOS: eax                                                      \ SP:  esp                                                      \ RP:  ebp                                                      \ AP:  esi                                                      \ W:   edi                                                      \ x, y, z: ebx, ecx, edx                                                                                                       .( i386/generic )                                                                                                               hex                                                             : dup  50 a, ;      \ push eax                                  : drop  58 a, ;     \ pop eax                                   : #  ( x -- )                                                     ?dup 0=  if  31 a, c0 a,  \ xor eax, eax                        else  b8 a,  a4,  then ;   \ mov eax, <imm>                   : cell+  83 a,  c0 a,  1 tcells a, ;     \ add eax, <1 cells>   : cell-  83 a,  e8 a,  1 tcells a, ;     \ sub eax, <1 cells>   : jump  ff a, e3 a, ;   \ jmp ebx                               : next      \ clobbers y                                          8b a, 3e a,           \ mov edi, [esi]                          83 a, c6 a, 04 a,     \ add esi, 4                              8b a, 1f a,           \ mov ebx, [edi]                          jump ;         \ jmp ebx                                      [defined] target-linux  [defined] target-darwin or                [defined] target-freebsd or  [if]                             : osargs  89 a, e0 a, ;     \ mov eax, esp                      [else]                                                          : osargs  89 a, d8 a, ;     \ mov eax, ebx                      [then]                                                          : sp  89 a, e0 a, ;     \ mov eax, esp                          : rp  89 a, e8 a, ;     \ mov eax, ebp                          : ap  89 a, f0 a, ;     \ mov eax, esi                          : w  89 a, f8 a, ;     \ mov eax, edi                           : x  89 a, d8 a, ;     \ mov eax, ebx                           : y  89 a, c8 a, ;     \ mov eax, ecx                           : z  89 a, d0 a, ;     \ mov eax, edx                           : @  8b a, 0 a, ;       \ mov eax, [eax]                        : c@                                                              8a a, 0 a,            \ mov al, [eax]                           25 a, ff a, 0 a, 0 a, 0 a, ; \ and eax, 0xff                  : !  89 a, 03 a, ;      \ mov [ebx], eax                        : c!  88 a, 03 a, ;     \ mov [ebx], al                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Architectures :#13 - i386 :#380                                                                                               \ generic i386 operations - #2                                                                                                  : sp!  89 a, c4 a, ;    \ mov esp, eax                          : rp!  89 a, c5 a, ;    \ mov ebp, eax                          : ap!  89 a, c6 a, ;    \ mov esi, eax                          : w!  89 a, c7 a, ;    \ mov edi, eax                           : x!  89 a, c3 a, ;    \ mov ebx, eax                           : y!  89 a, c1 a, ;    \ mov ecx, eax                           : z!  89 a, c2 a, ;    \ mov edx, eax                           : +  01 a, d8 a, ;      \ add eax, ebx                          : -  29 a, d8 a, ;      \ sub eax, ebx                          : *  f7 a, eb a, ;      \ imul ebx  (clobbers z)                : and  21 a, d8 a, ;    \ and eax, ebx                          : or  09 a, d8 a, ;     \ or eax, ebx                           : xor  31 a, d8 a, ;    \ xor eax, ebx                          : /mod   \ tos /mod x -> tos=q, x=r, clobbers z                   99 a,         \ cdq                                             f7 a, fb a,   \ idiv ebx                                        89 a, d3 a, ; \ mov ebx, edx                                  : u/mod     \ tos u/mod x -> tos=q, x=r, clobbers z               31 a, d2 a,       \ xor edx, edx                                f7 a, f3 a,       \ div ebx                                     89 a, d3 a, ;     \ mov ebx, edx                              : 1+  40 a, ;       \ inc eax                                   : aligned                                                         83 a, c0 a, 1 tcells 1- a,     \ add eax, 3                     83 a, e0 a, 1 tcells 1- invert a, ;   \ and eax, ~3           : skip  83 a, c6 a, 1 tcells a, ; \ add esi, 4                  : >r                                                              89 a, 45 a, 00 a,     \ mov [ebp], eax                          83 a, c5 a, 1 tcells a, ;   \ add ebp, 4                      : r>                                                              83 a, 0ed a, 1 tcells a,     \ sub ebp, 4                       8b a, 45 a, 00 a, ;   \ mov eax, [ebp]                        : lshift    \ clobbers y                                          89 a, d9 a,       \ mov ecx, ebx                                d3 a, e0 a, ;     \ shl eax, cl                               : rshift    \ clobbers y                                          89 a, d9 a,       \ mov ecx, ebx                                d3 a, e8 a, ;     \ shr eax, cl                               : rshifta   \ clobbers y                                          89 a, d9 a,       \ mov ecx, ebx                                d3 a, f8 a, ;     \ sar eax, cl                               : syscall  cd a, 80 a, ;    \ int 0x80                          : syssave                                                         56 a, 57 a, 55 a, ;   \ push esi, edi, ebp                    : sysrestore                                                      5d a, 5f a, 5e a, ;   \ pop ebp, edi, esi                     : break  cd a, 03 a, ;  \ int 3                                 : trylock  86 a, 03 a, ;  \ xchg al, [ebx]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Architectures :#13 - i386 :#380                                                                                               \ generic i386 operations - #3 (end)                                                                                            : portc!                                                          89 a, da a,   \ mov edx, ebx                                    ee a, ;        \ out dx, al                                   : portc@                                                          89 a, c2 a,   \ mov edx, eax                                    ec a, ;       \ in al, dx                                     : ticks  \ clobbers z                                             0f a, 31 a,  \ rdtsc                                            89 a, d3 a, ; \ mov ebx, edx                                  : lidt  0f a, 01 a, 18 a, ; \ lidt [eax]                        : cli  fa a, ;  \ cli                                           : sti  fb a, ;  \ sti                                           : iret  cf a, ; \ iret                                          : pause  f4 a, ;  \ hlt                                         variable cond                                                   : <                                                               39 a, c3 a,           \ cmp ebx, eax                            7d cond ! ;            \ jge                                  : =                                                               39 a, c3 a,           \ cmp ebx, eax                            75 cond ! ;            \ jne                                  : u<                                                              39 a, c3 a,           \ cmp ebx, eax                            73 cond ! ;            \ jae                                  : 0=                                                              85 a, c0 a,           \ test eax, eax                           75 cond ! ;           \ jne                                   : cs?                                                             73 cond ! ;           \ jnc                                   : patchj  ( from to -- ) over 2 + - swap 1+ c! ;                : %if  ( -- a ) ahere  cond @ a, 0 a, ;                         : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  eb a, 0 a, ;  \ jmp                  : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                                                                                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ syscall implementation for i386/Linux                                                                                         .( i386/linux )                                                                                                                 code syscall0  ( n -- x ) syscall  next  end-code               code syscall1  ( x n -- y )                                       y!  drop x!  y syscall  next                                  end-code                                                        code syscall2  ( x y n -- z )                                     z!  drop y!  drop x!  z syscall  next                         end-code                                                        code syscall3  ( x y z n -- p )                                   >r  drop z!  drop y!  drop x!  r> syscall  next               end-code                                                        code syscall4  ( x y z p n -- q )                                 >r  drop >r  drop z!  drop y!  drop x!  ap dup  r> ap!          r> syscall  x!  drop ap!  x  next                             end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   y!  drop x!  5 tcells # + x!  syssave  y dup                    x @ rp!  x cell- x! @ w!  x cell- x! @ ap!                      x cell- x! @ z!  x cell- x! @ y!  x cell- @ x!                  drop syscall  sysrestore  next                                end-code                                                        3 constant sys_read                                             4 constant sys_write                                            1 constant sys_exit                                             5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          19 constant sys_lseek                                           162 constant sys_nanosleep                                      192 constant sys_mmap2                                          91 constant sys_munmap                                          108 constant sys_fstat                                          2 constant sys_fork                                             11 constant sys_execve                                          114 constant sys_wait4                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     20 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                              350 load   \ unix                                               create linux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ syscall implementation common to i386/*BSD - #1                                                                               code syscall0  ( n -- y )                                         dup  syscall  cs?  if  -1 #  then  x!  drop  x  next          end-code                                                                                                                        code syscall1  ( x n -- y )                                       dup  syscall  cs?  if  -1 #  then  x!  drop  drop  x  next    end-code                                                                                                                        code syscall2  ( x y n -- z )                                     x!  drop  y!  drop  z!  y dup  z dup  dup                       x syscall  cs?  if  -1 #  then  drop drop drop  next          end-code                                                                                                                        code syscall3  ( x y z n -- p )                                   x!  drop y!  drop z!  drop w!                                   y dup  z dup  w dup  dup  x syscall  cs?  if  -1 #  then        x!  drop drop drop drop  x next                               end-code                                                                                                                        code syscall4  ( x y z p n -- q )                                 >r  drop x!  drop y!  drop z!  drop w!                          x dup  y dup  z dup  w dup  dup  r> syscall                     cs?  if  -1 #  then  x!  drop drop drop drop drop  x  next    end-code                                                                                                                        code syscall5  ( x y z p q n -- r )                               >r  drop >r  drop x!  drop y!  drop z!  drop w!                 r> dup  x dup  y dup  z dup  w dup  dup  r> syscall             cs?  if  -1 #  then  x!  drop drop drop drop drop drop          x  next                                                       end-code                                                                                                                        code syscall8  ( a n -- x )     \ parameters are in a[0]...a[7]   y!  drop x!  7 tcells # +  x!                                   x @ dup                                                         x cell- x! @ dup                                                x cell- x! @ dup                                                x cell- x! @ dup                                                x cell- x! @ dup                                                x cell- x! @ dup                                                x cell- x! @ dup                                                x cell- x! @ dup                                                dup  y syscall  cs?  if  -1 #  then  x!                         drop drop drop drop drop drop drop drop drop  x  next         end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Architectures 13 - i386 380                                                                                                   \ syscall implementation common to i386/*BSD - #2 (end)                                                                         1 constant sys_exit     2 constant sys_fork                     3 constant sys_read     4 constant sys_write                    5 constant sys_open     6 constant sys_close                    10 constant sys_unlink  59 constant sys_execve                  73 constant sys_munmap                                          197 constant sys_mmap64     \ 64-bit off_t                                                                                      1 1024 or 512 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT   0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 8 or 512 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT    2 8 or constant r/a  \ O_RDWR | O_APPEND                        420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 1024 constant O_TRUNC                                                                                                           4 constant MS_SYNC                                                                                                              350 load   \ unix                                                                                                               create bsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ syscall implementation for i386/FreeBSD                                                                                       7 constant sys_wait4                                            478 constant sys_lseek                                          189 constant sys_fstat                                          240 constant sys_nanosleep                                      65 constant sys_msync                                                                                                           48 constant stat>size                                                                                                           386 387 thru        \ bsd                                                                                                       create freebsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ syscall implementation for i386/OpenBSD                                                                                       11 constant sys_wait4                                           53 constant sys_fstat                                           199 constant sys_lseek                                          240 constant sys_nanosleep                                      256 constant sys_msync                                                                                                          68 constant stat>size                                                                                                           386 387 thru        \ bsd                                                                                                       create openbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ syscall implementation for i386/NetBSD                                                                                        7 constant sys_wait4                                            19 constant sys_lseek                                           440 constant sys_fstat                                          240 constant sys_nanosleep                                      277 constant sys_msync                                                                                                          88 constant stat>size                                                                                                           386 387 thru        \ bsd                                                                                                       create netbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13                                                                                                     \ ARM                                                             "generic" implementation                      401 - 404                                                                       \ OS-specific system calls and code                               Linux system calls                            405               Linux signal handling                         552               BSD system calls                              406 - 407         FreeBSD                                       408               OpenBSD                                       409               NetBSD                                        410                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ generic arm operations - #1                                   \                                                               \ requires: generic                                             \                                                               \  TOS: r0                                                      \  SP:  r13 (sp)                                                \  RP:  r14 (lr)                                                \  AP:  r12 (ip)                                                \  W:   r11 (fp)                                                \                                                               \ temporaries: x=r2, y=r3, z=r4                                                                                                 .( arm/generic )                                                                                                                hex                                                             : dup  e52d0004 a4, ;       \ str r0 [ r13 -4 # ] !             : drop  e49d0004 a4, ;      \ ldr r0 [ r13 ] 4 #                : #  ( x -- )                                                     dup 0 d# 256 within  if                                           e3a00000 or a4,  exit  then      \ mov r0 xx #                \ XXX small negatives -> mvn r0 xx' #                           e51f0000 a4,      \ ldr r0 [ pc 8 # ]                           ea000000 a4,  a4, ;     \ b +4                                : cell+  e2800000 1 tcells or a4, ;     \ add r0 r0 <cell> #    : cell-  e2400000 1 tcells or a4, ;     \ sub r0 r0 <cell> #    : jump  e1a0f002 a4, ;      \ mov pc r2                         : next                                                            e49cb000 1 tcells or a4,  \  ldr r11 [ r12 ] <cell> #           e59bf000 a4, ; \ ldr pc [ r11 ]                               : osargs                                                          [undefined] target-bsd  [if]  e1a0000d a4,  [then] ;            \  mov r0 sp                                                  : sp  e1a0000d a4, ; \ mov r0 sp                                : rp  e1a0000e a4, ; \   mov r0 r14                             : ap  e1a0000c a4, ; \ mov r0 r12                               : w  e1a0000b a4, ; \ mov r0 r11                                : x  e1a00002 a4, ; \  mov r0 r2                                : y  e1a00003 a4, ; \ mov r0 r3                                 : z  e1a00004 a4, ; \  mov r0 r4                                : @  e5900000 a4, ; \ ldr r0 [ r0 ]                             : c@  e5d00000 a4, ; \ ldr b r0 [ r0 ]                          : !  e5820000 a4, ;  \ str r0 [ r2 ]                            : c!  e5c20000 a4, ;    \  str b r0 [ r2 ]                      : sp!  e1a0d000 a4, ;   \ mov sp r0                             : rp!  e1a0e000 a4, ; \ mov r14 r0                              : ap!  e1a0c000 a4, ; \ mov r12 r0                              : w!  e1a0b000 a4, ; \ mov r11 r0                               : x!  e1a02000 a4, ;    \ mov r2 r0                             : y!  e1a03000 a4, ;    \  mov r3 r0                            : z!  e1a04000 a4, ;    \ mov r4 r0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures :#13 - arm :#400                                                                                                \ generic arm operations - #2                                                                                                   : +  e0800002 a4, ;     \ add r0 r0 r2                          : -  e0400002 a4, ;     \ sub r0 r0 r2                          : *  e0000290 a4, ; \ mul r0 r0 r2                              : and  e0000002 a4, ;   \ and r0 r0 r2                          : or  e1800002 a4, ;    \ orr r0 r0 r2                          : xor  e0200002 a4, ;   \ eor r0 r0 r2                          : /mod  \ tos /mod x -> tos=q, x=r, clobbers y z                \ from: http://www.peter-cockerell.net/aalp/html/ch-6.html:     \ r0 = lhs, r1 = rhs -> r2 = div, r3 = mod                        e1a01002 a4,  \ mov r1 r2                                       e0305001 a4,  \ eor s r5 r0 r1               \ divsgn           e1b06000 a4,  \ mov s r6 r0                   \ modsgn          42600000 a4,  \  rsb mi r0 r0 0 #                               e3310000 a4,  \ teq r1 0 #                                      42611000 a4,  \  rsb mi r1 r1 0 #                               ea000006 a4,  \ b l# udiv32                                     e3350000 a4,  \ l: sdiv32r  teq r5 0 #                          42622000 a4,  \ rsb mi r2 r2 0 #                                e3360000 a4,  \ teq r6 0 #                                      42633000 a4,  \ rsb mi r3 r3 0 #                                e1a00002 a4,  \ mov r0 r2                                       e1a02003 a4,  \ mov r2 r3                                       ea00000e a4,  \  b l# smdone                                   \ l: udiv32      r0 = lhs, r1 = rhs -> r2 = div, r3 = mod        e3a02000 a4,  \ mov r2 0 #                                      e3a03000 a4,  \ mov r3 0 #                                      e3a04020 a4,  \ mov r4 d# 32 #                                  e2544001 a4,  \ sub s r4 r4 1 #                                 afffff3 a4,   \ b eq l# sdiv32r                                 e1b00080 a4,  \  mov s r0 r0 lsl 1 #                            5affffff a4,  \  b pl l# udiv32_2                               e1b00080 a4,  \ l: udiv32_2  mov s r0 r0 lsl 1 #                e0a33003 a4,  \ adc r3 r3 r3                                    e1530001 a4,  \ cmp r3 r1                                       20433001 a4,  \ sub cs r3 r3 r1                                 e0a22002 a4,  \ adc r2 r2 r2                                    e2544001 a4,  \ sub s r4 r4 1 #                                 1afffff8 a4,  \ b ne l# udiv32_2                                eaffffe9 a4,  \  b l# sdiv32r                                  \   l: smdone                                                    ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Architectures :#13 - arm :#400                                                                                                \ generic arm operations - #3                                                                                                   : u/mod   \ tos u/mod x -> tos=q, x=r, clobbers y z             \ uses a different algorithm, as the code above doesn't do a    \ full unsigned 32 bit divide                                     e1a05000 a4,  \ mov r5 r0                                       e1a04002 a4,  \ mov r4 r2                                       e15200a5 a4,  \ cmp r2 r5 lsr 1 #                               91a02082 a4,  \ l: usm1  mov ls r2 r2 lsl 1 #                   e15200a5 a4,  \ cmp r2 r5 lsr 1 #                               9afffffc a4,  \ b ls l# usm1                                    e3a00000 a4,  \ mov r0 0 #                                      e1550002 a4,  \ l: usm2  cmp r5 r2                              20455002 a4,  \ sub cs r5 r5 r2                                 e0a00000 a4,  \ adc r0 r0 r0                                    e1a020a2 a4,  \ mov r2 r2 lsr 1 #                               e1520004 a4,  \ cmp r2 r4                                       2afffff9 a4,  \ b cs l# usm2                                    e1a02005 a4, ; \ mov r2 r5                                    : 1+  e2800001 a4, ;    \ add r0 r0 1 #                         : aligned                                                         e2800000 1 tcells 1- tuck or a4,  \ add r0 r0 <cell-1> #        e3c00000 or a4, ; \   bic r0 r0 <cell-1> #                    : skip  e28cc000 1 tcells or a4, ;  \  add r12 r12 4 #          : >r  e48e0004 a4, ;    \ str r0 [ r14 ] 4 #                    : r>  e53e0004 a4, ;    \ ldr r0 [ r14 -4 # ] !                 : lshift  e1a00210 a4, ; \ lsl r0 r0 r2                         : rshift  e1a00230 a4, ; \ lsr r0 r0 r2                         : rshifta  e1a00250 a4, ; \ asr r0 r0 r2                        : syscall# e1a07000 a4, ;   \ mov r7 r0                         : syscall  ef000000 a4, ;   \ swi 0 #                           : sysarg    ( u -- )                                              d# 12 lshift e1a00000 or a4, ; \ mov r<n> r0                  : break  e7f001f0 a4, ;     \ dcd h# e7f001f0 #                 : trylock                                                         e3a01001 a4,  \ mov r1 1 #                                      e1920f9f a4,  \ ldrex r0 [ r2 ]                                 e3300000 a4,  \ teq r0 0 #                                      e3a00000 a4,  \ mov r0 0 #                                      1a000003 a4,  \ b ne l1                                         e1820f91 a4,  \ strex r0 r1 [ r2 ]                              e3300000 a4,  \ teq r0 0 #                                      3a00001 a4,   \ mov eq r0 1 #                                   13a00000 a4, ; \ mov ne r0 0 #  l1:                           : pause                                                           ee070f90 a4, ; \ mcr p15 0 # r0 c7 c0 4 #                       \ (ARMv7: WFI - 03200002, or: WFE - e320f002)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Architectures :#13 - arm :#400                                                                                                \ generic arm operations - #4                                                                                                   variable cond                                                   : <                                                               e1520000 a4,  \ cmp r2 r0                                       aa000000 cond ! ; \  b ge                                     : =                                                               e1520000 a4,  \ cmp r2 r0                                       1a000000 cond ! ; \ b ne                                      : u<                                                               e1520000 a4, \ cmp r2 r0                                       2a000000 cond ! ; \ b cs                                      : 0=                                                              e3300000 a4,  \ teq r0 0 #                                      1a000000 cond ! ; \ b ne                                      : cs? 3a000000 cond ! ; \ b cc                                  : patchj  ( from to -- )                                          over - 2 rshifta 2 - ffffff and over w4@ or  swap w4! ;       : %if  ( -- a ) ahere  cond @ a4, ;                             : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  ea000000 a4, ;  \ b                  : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ syscall implementation for ARM/Linux                                                                                          .( arm/linux )                                                                                                                  code syscall0  ( n -- y )                                         syscall#  syscall  next                                       end-code                                                        code syscall1  ( x n -- y )                                       syscall#  drop  syscall  next                                 end-code                                                        code syscall2  ( x y n -- z )                                     syscall#  drop 1 sysarg  drop  syscall  next                  end-code                                                        code syscall3  ( x y z n -- p )                                   syscall#  drop x!  drop 1 sysarg  drop  syscall  next         end-code                                                        code syscall4  ( x y z p n -- q )                                 syscall#  drop y!  drop x!  drop 1 sysarg  drop  syscall        next                                                          end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   syscall#  drop x! 5 tcells # + x!                               x @ 5 sysarg  x cell- x! @ z!  x cell- x! @ y!                  x cell- x! @ dup  x cell- x! @ 1 sysarg  x cell- @ >r           drop x!  r>  syscall  next                                    end-code                                                                                                                        3 constant sys_read                                             4 constant sys_write                                            1 constant sys_exit                                             5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          19 constant sys_lseek                                           162 constant sys_nanosleep                                      192 constant sys_mmap2                                          91 constant sys_munmap                                          197 constant sys_fstat  \ actually fstat64                      2 constant sys_fork                                             11 constant sys_execve                                          114 constant sys_wait4                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     48 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                              350 load        \ unix                                          create linux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Architectures :#13 - arm :#400                                                                                                \ syscall implementation common to ARM/*BSD #1                                                                                  code syscall0  ( n -- y )                                         syscall cs?  if  -1 #  then  next                             end-code                                                        code syscall1  ( x n -- y )                                       1 sysarg  drop  syscall cs?  if  -1 #  then  next             end-code                                                        code syscall2  ( x y n -- z )                                     2 sysarg  drop 1 sysarg  drop                                   syscall cs?  if  -1 #  then  next                             end-code                                                        code syscall3  ( x y z n -- p )                                   3 sysarg  drop 2 sysarg  drop 1 sysarg                          drop syscall cs?  if  -1 #  then  next                        end-code                                                        code syscall4  ( x y z p n -- q )                                 4 sysarg  drop 3 sysarg  drop 2 sysarg  drop 1 sysarg           drop syscall cs?  if -1  #  then  next                        end-code                                                        code syscall5  ( x y z p n -- q )                                 5 sysarg  drop 4 sysarg  drop 3 sysarg  drop 2 sysarg           drop  1 sysarg  drop syscall cs?  if -1  #  then  next        end-code                                                        code syscall8  ( a n -- x )     \ parameters are in a[0]...a[7]   y!  drop x! 7 tcells # + x!                                     y dup  @ 8 sysarg                                               x cell- x! @  7 sysarg                                          x cell- x! @  6 sysarg                                          x cell- x! @  5 sysarg                                          x cell- x! @  4 sysarg                                          x cell- x! @  3 sysarg                                          x cell- x! @  2 sysarg                                          x cell- @  1 sysarg                                             drop syscall cs?  if  -1 #  then  next                        end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ syscall implementation common to ARM/*BSD #2 (end)                                                                            1 constant sys_exit                                             2 constant sys_fork                                             3 constant sys_read                                             4 constant sys_write                                            5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          59 constant sys_execve                                          73 constant sys_munmap                                          197 constant sys_mmap64     \ 64-bit off_t                      240 constant sys_nanosleep                                                                                                      1 1024 or 512 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT   0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 8 or 512 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT    2 8 or constant r/a  \ O_RDWR | O_APPEND                        420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                                                                                              350 load       \ unix                                                                                                           create bsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ syscalls for ARM/FreeBSD                                                                                                      .( ARM/FreeBSD )                                                                                                                7 constant sys_wait4                                            19 constant sys_lseek                                           189 constant sys_fstat                                          65 constant sys_msync                                                                                                           48 constant stat>size                                                                                                           406 407 thru    \ bsd                                                                                                           create freebsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ syscalls for ARM/OpenBSD                                                                                                      .( ARM/OpenBSD )                                                                                                                11 constant sys_wait4                                           53 constant sys_fstat                                           199 constant sys_lseek                                          256 constant sys_msync                                                                                                          68 constant stat>size                                                                                                           406 407 thru    \ bsd                                                                                                           create openbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - arm 400                                                                                                    \ syscalls for ARM/NetBSD                                                                                                       .( ARM/NetBSD )                                                                                                                 7 constant sys_wait4                                            19 constant sys_lseek                                           440 constant sys_fstat                                          277 constant sys_msync                                                                                                          88 constant stat>size                                                                                                           406 407 thru    \ bsd                                                                                                           create netbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Platform specific code 13                                                                                                     \ x86_64                                                          "generic" implementation                      421 - 423                                                                       \ OS-specific system calls and code                               Linux system calls                            425               Linux signal handling                         551               BSD signal handling                           553               BSD system call numbers                       427               SysV system calls                             428               SysV/BSD system calls                         433               FreeBSD                                       429               OpenBSD                                       430               NetBSD                                        431               Darwin                                        432                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ generic x86_64 operations #1                                  \                                                               \ requires: generic                                             \                                                               \ TOS: rax                                                      \ SP:  rsp                                                      \ RP:  rbp                                                      \ AP:  rsi                                                      \ W:   rdi                                                      \                                                               \ x, y, z: rbx, rcx, rdx                                                                                                        hex                                                             : dup  50 a, ;      \ push rax                                  : drop  58 a, ;     \ pop rax                                   : #  ( x -- )                                                     ?dup 0=  if  48 a, 31 a, c0 a,  \ xor rax, rax                  else  48 a, b8 a,  a8,  then ;   \ mov rax, <imm>             : cell+  48 a, 83 a,  c0 a,  1 tcells a, ; \ add rax, <1 cells> : cell-  48 a, 83 a,  e8 a,  1 tcells a, ; \ sub rax, <1 cells> : jump  ff a, e3 a, ;   \ jmp rbx                               : next      \ clobbers y                                          48 a, 8b a, 3e a,           \ mov rdi, [rsi]                    48 a, 83 a, c6 a, 1 tcells a,     \ add rsi, 8                  48 a, 8b a, 1f a,           \ mov rbx, [rdi]                    jump ;         \ jmp rbx                                      : osargs  48 a, 89 a, e0 a, ;     \ mov rax, rsp                : sp  48 a, 89 a, e0 a, ;     \ mov rax, rsp                    : rp  48 a, 89 a, e8 a, ;     \ mov rax, rbp                    : ap  48 a, 89 a, f0 a, ;     \ mov rax, rsi                    : w  48 a, 89 a, f8 a, ;     \ mov rax, rdi                     : x  48 a, 89 a, d8 a, ;     \ mov rax, rbx                     : y  48 a, 89 a, c8 a, ;     \ mov rax, rcx                     : z  48 a, 89 a, d0 a, ;     \ mov rax, rdx                     : @  48 a, 8b a, 0 a, ;       \ mov rax, [rax]                  : c@                                                              8a a, 0 a,            \ mov al, [rax]                           48 a, 25 a, ff a, 0 a, 0 a, 0 a, ; \ and rax, 0xff            : !  48 a, 89 a, 03 a, ;      \ mov [rbx], rax                  : c!  88 a, 03 a, ;     \ mov [rbx], al                         : sp!  48 a, 89 a, c4 a, ;    \ mov rsp, rax                    : rp!  48 a, 89 a, c5 a, ;    \ mov rbp, rax                    : ap!  48 a, 89 a, c6 a, ;    \ mov rsi, rax                    : w!  48 a, 89 a, c7 a, ;    \ mov rdi, rax                     : x!  48 a, 89 a, c3 a, ;    \ mov rbx, rax                     : y!  48 a, 89 a, c1 a, ;    \ mov rcx, rax                     : z!  48 a, 89 a, c2 a, ;    \ mov rdx, rax                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - x86_64 420                                                                                                 \ generic x86_64 operations #1                                                                                                  : +  48 a, 01 a, d8 a, ;      \ add rax, rbx                    : -  48 a, 29 a, d8 a, ;      \ sub rax, rbx                    : *  48 a, f7 a, eb a, ;      \ imul rbx  (clobbers z)          : and  48 a, 21 a, d8 a, ;    \ and rax, rbx                    : or  48 a, 09 a, d8 a, ;     \ or rax, rbx                     : xor  48 a, 31 a, d8 a, ;    \ xor rax, rbx                    : /mod   \ tos /mod x -> tos=q, x=r, clobbers z                   48 a, 99 a,         \ cqo                                       48 a, f7 a, fb a,   \ idiv rbx                                  48 a, 89 a, d3 a, ; \ mov rbx, rdx                            : u/mod     \ tos u/mod x -> tos=q, x=r, clobbers z               48 a, 31 a, d2 a,       \ xor rdx, rdx                          48 a, f7 a, f3 a,       \ div rbx                               48 a, 89 a, d3 a, ;     \ mov rbx, rdx                        : 1+  48 a, ff a, c0 a, ;       \ inc rax                       : aligned                                                         48 a, 83 a, c0 a, 1 tcells 1- a,     \ add rax, 7               48 a, 83 a, e0 a, 1 tcells 1- invert a, ;   \ and rax, ~7     : skip  48 a, 83 a, c6 a, 1 tcells a, ; \ add rsi, 8            : >r                                                              48 a, 89 a, 45 a, 00 a,     \ mov [rbp], rax                    48 a, 83 a, c5 a, 1 tcells a, ;   \ add rbp, 8                : r>                                                              48 a, 83 a, 0ed a, 1 tcells a,     \ sub rbp, 8                 48 a, 8b a, 45 a, 00 a, ;   \ mov rax, [rbp]                  : lshift    \ clobbers y                                          48 a, 89 a, d9 a,       \ mov rcx, rbx                          48 a, d3 a, e0 a, ;     \ shl rax, cl                         : rshift    \ clobbers y                                          48 a, 89 a, d9 a,       \ mov rcx, rbx                          48 a, d3 a, e8 a, ;     \ shr rax, cl                         : rshifta   \ clobbers y                                          48 a, 89 a, d9 a,       \ mov rcx, rbx                          48 a, d3 a, f8 a, ;     \ sar rax, cl                         : syscall  0f a, 05 a, ;    \ syscall                           : r8!  49 a, 89 a, c0 a, ;  \ mov r8, rax                       : r9!  49 a, 89 a, c1 a, ;  \ mov r9, rax                       : r10!  49 a, 89 a, c2 a, ;  \ mov r10, rax                     : break  cd a, 03 a, ;  \ int 3                                 : trylock  86 a, 03 a, ;  \ xchg al, [rbx]                      : pause  f4 a, ;    \ hlt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ generic x86_64 operations #3 (end)                                                                                                                                                            variable cond                                                   : <                                                               48 a, 39 a, c3 a,           \ cmp rbx, rax                      7d cond ! ;            \ jge                                  : =                                                               48 a, 39 a, c3 a,           \ cmp rbx, rax                      75 cond ! ;            \ jne                                  : u<                                                              48 a, 39 a, c3 a,           \ cmp rbx, rax                      73 cond ! ;            \ jae                                  : 0=                                                              48 a, 85 a, c0 a,           \ test rax, rax                     75 cond ! ;           \ jne                                   : cs?  73 cond ! ;           \ jnc                              : patchj  ( from to -- ) over 2 + - swap 1+ c! ;                : %if  ( -- a ) ahere  cond @ a, 0 a, ;                         : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  eb a, 0 a, ;  \ jmp                  : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ syscall implementation for x86_64/Linux                                                                                       428 load        \ sysv                                                                                                          code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   y!  drop x!  5 tcells # +  x!  ap dup  y dup                    x @ r9!  x cell- x! @ r8!  x cell- x! @ r10!                    x cell- x! @ z!  x cell- x! @ ap!  x cell- @ w!                 drop syscall  x! drop ap!  x  next                            end-code                                                                                                                        0 constant sys_read                                             1 constant sys_write                                            2 constant sys_open                                             3 constant sys_close                                            5 constant sys_fstat                                            8 constant sys_lseek                                            9 constant sys_mmap                                             11 constant sys_munmap                                          35 constant sys_nanosleep                                       57 constant sys_fork                                            59 constant sys_execve                                          60 constant sys_exit                                            61 constant sys_wait4                                           87 constant sys_unlink                                          26 constant sys_msync                                                                                                           1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                                                                                     48 constant stat>size                                                                                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                                                                                              350 load        \ unix                                                                                                          create linux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ syscall table common to x86_64/*BSD                                                                                           240 constant sys_nanosleep                                      1 constant sys_exit                                             2 constant sys_fork                                             3 constant sys_read                                             4 constant sys_write                                            5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          59 constant sys_execve                                          73 constant sys_munmap                                          197 constant sys_mmap64     \ 64-bit off_t                                                                                      1 1024 or 512 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT   0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 8 or 512 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT    2 8 or constant r/a  \ O_RDWR | O_APPEND                        420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 1024 constant O_TRUNC                                           4 constant MS_SYNC                                                                                                              350 load        \ unix                                                                                                          create bsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Xclip 0   \ Architectures 13 - x86_64 420                                                                                                 \ System calls common to SysV x86_64 based implementations                                                                       \ registers:  rdi(w) rsi(ap) rdx(z) r10 r8 r9                   \ syscall clobbers rcx, so r10 must be used                                                                                    code syscall0  ( n -- y ) syscall  next  end-code                                                                               code syscall1  ( x n -- y )                                       x!  drop w!  x syscall  next                                  end-code                                                                                                                        code syscall2  ( x y n -- z )                                     x!  drop y!  drop w!  ap dup  y ap!  x syscall                  x!  drop ap!  x  next                                         end-code                                                                                                                        code syscall3  ( x y z n -- p )                                   >r  drop z!  drop y!  drop w!  ap dup  y ap!                    r> syscall  x!  drop ap!  x  next                             end-code                                                                                                                        code syscall4  ( x y z p n -- q )                                 >r  drop r10!  drop z!  drop y!  drop w!  ap dup                y ap!  r> syscall  x!  drop ap!  x  next                      end-code                                                                                                                        code syscall5  ( x y z p r n -- s )                               >r  drop r8!  drop r10!  drop z!  drop y!  drop w!  ap dup      y ap!  r> syscall  x!  drop ap!  x  next                      end-code                                                                                                                        code syscall8  ( a n -- x ) \ parameters are in a[0]...a[7]        >r  drop x!  7 tcells # +  x!  ap dup                           x @ dup  x cell- x!  @ dup  x cell- x!                          @ r9!  x cell- x! @ r8!  x cell- x! @ r10!                      x cell- x! @ z!  x cell- x! @ ap!  x cell- @ w!                 r> syscall  x!  drop drop drop ap!  x  next                  end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - x86_64 420                                                                                                 \ syscall implementation for x86_64/FreeBSD                                                                                     433 load        \ SysV                                                                                                          7 constant sys_wait4                                            19 constant sys_lseek                                           189 constant sys_fstat                                          26 constant sys_msync                                                                                                           48 constant stat>size                                                                                                           427 thru    \ bsd                                                                                                               create freebsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ syscall implementation for x86_64/OpenBSD                                                                                     433 load        \ SysV                                                                                                          11 constant sys_wait4                                           199 constant sys_lseek                                          53 constant sys_fstat                                           256 constant sys_msync                                                                                                          80 constant stat>size                                                                                                           427 load    \ bsd syscall numbers                                                                                               create openbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Architectures 13 - x86_64 420                                                                                                 \ syscall implementation for x86_64/NetBSD                                                                                      433 load        \ SysV                                                                                                          7 constant sys_wait4                                            19 constant sys_lseek                                           440 constant sys_fstat                                          277 constant sys_msync                                                                                                          88 constant stat>size                                                                                                           427 load    \ bsd system call table                                                                                             create netbsd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ syscall implementation for x86_64/Darwin                                                                                      433 load        \ sysv                                                                                                          h# 2000007 constant sys_wait4                                   h# 20000c7 constant sys_lseek                                   h# 20000bd constant sys_fstat                                   h# 2000001 constant sys_exit                                    h# 2000002 constant _sys_fork   \ internal                      h# 2000003 constant sys_read                                    h# 2000004 constant sys_write                                   h# 2000005 constant sys_open                                    h# 2000006 constant sys_close                                   h# 200000a constant sys_unlink                                  h# 200003b constant sys_execve                                  h# 2000049 constant sys_munmap                                  h# 20000c5 constant sys_mmap64     \ 64-bit off_t               h# 2000041 constant sys_msync                                                                                                   1 1024 or 512 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT   0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 8 or 512 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT    2 8 or constant r/a  \ O_RDWR | O_APPEND                        72 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 1024 constant O_TRUNC                                           4 constant MS_SYNC                                                                                                              350 load        \ unix                                                                                                          \ custom syscall0 that checks rdx, needed for `fork`:           \ (see libsyscall/custom/__fork.s in the xnu sources)           code (fork)  ( -- y )                                             dup _sys_fork # syscall cs?  if  -1 #  else                     y!  h# ffffffff # x! z and 0=  if  y  else  0 #  then  then     next                                                          end-code                                                                                                                        create darwin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0 428     \ Architectures 13 - x86_64 420                                                                                                 \ System calls common to SysV x86_64 based implementations      \ (with C-flag checking for BSD)                                                                                                 \ registers:  rdi(w) rsi(ap) rdx(z) r10 r8 r9                   \ syscall clobbers rcx, so r10 must be used                                                                                    code syscall0  ( n -- y )                                         syscall  cs?  if  -1 #  then  next                            end-code                                                                                                                        code syscall1  ( x n -- y )                                       x!  drop w!  x syscall  cs?  if  -1 #  then  next             end-code                                                                                                                        code syscall2  ( x y n -- z )                                     x!  drop y!  drop w!  ap dup  y ap!  x syscall                   cs?  if  -1 #  then  x!  drop ap!  x  next                   end-code                                                                                                                        code syscall3  ( x y z n -- p )                                   >r  drop z!  drop y!  drop w!  ap dup  y ap!                    r> syscall  cs?  if  -1 #  then  x!  drop ap!  x  next        end-code                                                                                                                        code syscall4  ( x y z p n -- q )                                 >r  drop r10!  drop z!  drop y!  drop w!  ap dup                y ap!  r> syscall  cs?  if  -1 #  then                          x!  drop ap!  x  next                                         end-code                                                                                                                        code syscall5  ( x y z p r n -- s )                               >r  drop r8!  drop r10!  drop z!  drop y!  drop w!  ap dup      y ap!  r> syscall  cs?  if  -1 #  then                          x!  drop ap!  x  next                                         end-code                                                                                                                        code syscall8  ( a n -- x ) \ parameters are in a[0]...a[7]        >r  drop x!  7 tcells # +  x!  ap dup                           x @ dup  x cell- x!  @ dup  x cell- x!                          @ r9!  x cell- x! @ r8!  x cell- x! @ r10!                      x cell- x! @ z!  x cell- x! @ ap!  x cell- @ w!                 r> syscall  cs?  if  -1 #  then                                 x!  drop drop drop ap!  x  next                              end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Platform specific code 13                                                                                                     \ SPARC                                                           "generic" implementation                      441 - 443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - SPARC 440                                                                                         \ generic sparc operations #1                                                                                                   \  TOS: %r1                                                     \  SP:  %g2                                                     \  RP:  %g3                                                     \  AP:  %g4                                                     \  W:   %g5                                                     hex                                                             : %lo  ( n -- u ) 3ff and ;                                     : %hi  ( n -- u ) d# 10 rshift ;                                : dup  8420a004 a4, c220a000 a4, ; \ dec #4, %g2; st %r1, (%g2) : drop  c200a000 a4, 8400a004 a4, ; \ ld (%g2), %r1;inc #4, %g2 : #  ( x -- )                                                     dup d# -4095 0 within  if                                         negate 82202000 or a4,  exit  then \ sub %g0, #xxxx, %r1      dup d# 0 d# 4096 within  if                                       82102000 or a4,  exit  then  \ or %g0, #xxxx, %r1             dup %hi 03000000 or a4,   \ sethi #xxxx, %r1                    %lo 82106000 or a4, ;     \ or %r1, #yyyy, %r1                : cell+  82006000 1 tcells or a4, ;     \ inc #<cell>, %r1      : cell-  82206000 1 tcells or a4, ;     \ dec #<cell>, %r1      : jump                                                            81c46000 a4,   \ jmp (%r1)                                      01000000 a4, ; \ nop                                          : next      \ clobbers x                                          ca012000 a4,  \ ld (%g4), %g5                                   88012000 1 tcells or a4,  \ inc #<cell>, %g4                    e2016000 a4,  \ ld (%g5), %l1                                   jump ;                                                        [defined] bsd [if]                                              : osargs  ;  \ nop (%g1/%r1 already contains ptr)               [else]                                                          \ XXX: is this offset wordsize dependent?                       : osargs  8203a040 a4, ;    \ add %sp, #64, %r1                 [then]                                                          : sp  82100002 a4, ;     \ mov %g2, %r1                         : rp  82100003 a4, ;     \ mov %g3, %r1                         : ap  82100004 a4, ;     \ mov %g4, %r1                         : w  82100005 a4, ;     \ mov %g5, %r1                          : x  82100011 a4, ;     \ mov %l1, %r1                          : y  82100012 a4, ;     \ mov %l2, %r1                          : z  82100013 a4, ;     \ mov %l3, %r1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - SPARC 440                                                                                         \ generic sparc operations #2                                                                                                                                                                   : @  c2006000 a4, ;       \ ld (%r1), %r1                       : c@  c2086000 a4, ;    \ ldub (%r1), %r1                       : !  c2246000 a4, ;      \ st %r1, (%l1)                        : c!  c22c6000 a4, ;     \ stb %r1, (%l1)                       : sp!  84100001 a4, ;    \ mov %r1, %g2                         : rp!  86100001 a4, ;    \ mov %r1, %g3                         : ap!  88100001 a4, ;    \ mov %r1, %g4                         : w!  8a100001 a4, ;    \ mov %r1, %g5                          : x!  a2100001 a4, ;    \ mov %r1, %l1                          : y!  a4100001 a4, ;    \ mov %r1, %l2                          : z!  a6100001 a4, ;    \ mov %r1, %l3                          : +  82004011 a4, ;      \ add %r1, %l1, %r1                    : -  82204011 a4, ;      \ sub %r1, %l1, %r1                    : *  82584011 a4, ;      \ smul %r1, %l1, %r1                   : and  82084011 a4, ;    \ and %r1, %l1, %r1                    : or  82104011 a4, ;     \ or %r1, %l1, %r1                     : xor  82184011 a4, ;    \ xor %r1, %l1, %r1                    : /mod   \ tos /mod x -> tos=q, x=r, clobbers y, z                80900001 a4,  \ tst %r1                                         1c800006 a4,  \ bpos l1                                         01000000 a4,  \ nop                                             a6202001 a4,  \ sub %g0, #1, %l3                                81800013 a4,  \ wry %g0, %l3                                    10800003 a4,  \ ba l2                                           01000000 a4,  \ nop                                             81800000 a4,  \ l1: wry %g0, %g0                                a4784011 a4,  \ l2: sdiv %r1, %l1, %l2                          a65c8011 a4,  \ smul %l2, %l1, %l3                              a6204013 a4,  \ sub %r1, %l3, %l3                               82100012 a4,  \ mov %l2, %r1                                    a2100013 a4, ; \ mov %l3, %l1                                 : u/mod     \ tos u/mod x -> tos=q, x=r, clobbers z               81800000 a4,      \ wry %g0, %g0                                a4704011 a4,      \ udiv %r1, %l1, %l2                          a6548011 a4,      \ umul %l2, %l1, %l3                          a6204013 a4,      \ sub %r1, %l3, %l3                           82100012 a4,      \ mov %l2, %r1                                a2100013 a4, ;    \ mov %l3, %l1                              : 1+  82006001 a4, ;       \ inc #1, %r1                        : aligned                                                         82006000 1 tcells 1- tuck or a4,      \ inc #<cell-1>, %r1      82286000 or a4, ;    \ bclr #<cell-1>, %r1                    : skip  88012000 1 tcells or a4, ;  \ inc #<cell>, %g4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - SPARC 440                                                                                         \ generic sparc operations #3 (end)                                                                                                                                                             : >r                                                              c220e000 a4,      \ st %r1, (%g3)                               8600e000 1 tcells or a4, ;    \ inc #<cell>, %g3              : r>                                                              8620e000 1 tcells or a4,  \ dec #<cell>, %g3                    c200e000 a4, ;    \ ld (%g3), %r1                             : lshift  83284011 a4, ;    \ sll %r1, %l1, %r1                 : rshift  83304011 a4, ;    \ srl %r1, %l1, %r1                 : rshifta  83384011 a4, ;   \ sra %r1, %l1, %r1                 : syscall                                                         91d02000 [defined] target-linux  [if] h# 10 or [then]  a4, ; \ ta %g0, 10/0                                                   : sysarg  ( u -- )                                                d# 25 lshift  90100001 or a4, ;  \ mov %r1, %o<0...>          : sysresult  82100008 a4, ;     \ mov %o0, %r1                  : break  91d02001 a4, ;     \ ta %g0, 1                         : trylock  c26c6000 a4, ;   \ ldstub (%l1), %r1                 : pause ;                                                       variable cond                                                   : <                                                               80a44001 a4,          \ cmp %l1, %r1                            0b cond ! ;            \ bge                                  : =                                                               80a44001 a4,          \ cmp %l1, %r1                            9 cond ! ;            \ bne                                   : u<                                                              80a44001 a4,          \ cmp %l1, %r1                            0d cond ! ;            \ bae                                  : 0=                                                              80900001 a4,          \ tst %r1                                 9 cond ! ;           \ bnz                                    : cs?  0d cond ! ;           \ bcs                              : patchj  ( from to -- )                                          over - 1 tcells / 3fffff and over w4@ or  swap w4! ;          : %if  ( -- a )                                                   ahere  cond @ d# 25 lshift  800000 or a4, \ b<xx>               01000000 a4, ;    \ nop                                       : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  10800000 a4, 01000000 a4, ; \ ba, nop                                                                : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  Back                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Platform specific code 13                                                                                                     \ ARM Cortex                                                      "generic" implementation                      451 - 454                                                                       \ OS-specific system calls and code                               Linux system calls                            455                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - ARM Cortex 450                                                                                    \ generic ARM Cortex-M0 operations #1                                                                                           \  TOS: r0                                                      \  SP:  r13 (sp)                                                \  RP:  r14 (lr)                                                \  AP:  r6                                                      \  W:   r5                                                      \                                                               \ temporaries: x=r2, y=r3, z=r4                                 \ temporaries: r1, r5, r6                                       hex                                                             : kalign  \ align PC in kernel for PC-relative 4-byte move        mkh @ reloc 3 and  if  46c0 a2,  then ; \ insert nop          : dup  b401 a2, ;       \ push {r0}                             : drop  bc01 a2, ;      \ pop {r0}                              : #  ( x -- )                                                     dup 0 d# 256 within  if                                           2000 or a2,  exit  then      \ movs r0, #xx                   \ XXX small negatives -> mvn r0, #xx'                           4801 a2,      \ ldr r0, [pc, #4]                                kalign    \ ensure 4-byte alignment                             e002 a2,  \ b l1                                                46c0 a2,  \ nop                                                 ( data ) a4, ;     \ <data>; l1:                              : cell+  3000 1 tcells or a2, ;     \ adds r0, #<cell>          : cell-  3800 1 tcells or a2, ;     \ subs r0, #<cell>          : jump  4697 a2, ;      \ mov pc, r2                            : next  \ clobbers x                                              6835 a2,  \  ldr r5, [r6]                                       3600 1 tcells or a2,   \ adds r6, #<cell>                       682a a2, \ ldr r2, [r5]                                         jump ;                                                        : osargs                                                          [undefined] target-bsd  [if]  4668 a2,  [then] ; \ mov r0, sp : sp  4668 a2, ; \ mov r0, sp                                   : rp  4670 a2, ; \   mov r0, r14                                : ap  4630 a2, ; \ mov r0, r6                                   : w  4628 a2, ; \ mov r0, r5                                    : x  4610 a2, ; \  mov r0, r2                                   : y  4618 a2, ; \ mov r0, r3                                    : z  4620 a2, ; \  mov r0, r4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - ARM Cortex 450                                                                                    \ generic ARM Cortex-M0 operations #2                                                                                           : @  6800 a2, ; \ ldr r0, [r0]                                  : c@  7800 a2, ; \ ldrb r0, [r0]                                : !  6010 a2, ;  \ str r0, [r2]                                 : c!  7010 a2, ;    \  strb r0, [r2]                            : sp!  4685 a2, ;   \ mov sp, r0                                : rp!  4686 a2, ; \ mov r14, r0                                 : ap!  4606 a2, ; \ mov r6, r0                                  : w!  4605 a2, ; \ mov r5, r0                                   : x!  4602 a2, ;    \ mov r2, r0                                : y!  4603 a2, ;    \  mov r3, r0                               : z!  4604 a2, ;    \ mov r4, r0                                : +  4410 a2, ;     \ add r0, r2                                : -  1a80 a2, ;     \ subs r0, r0, r2                           : *  4350 a2, ; \ muls r0, r2, r0                               : and  4010 a2, ;   \ ands r0, r2                               : or  4310 a2, ;    \ orrs r0, r2                               : xor  4050 a2, ;   \ eors r0, r2                               : u/mod_   \ tos u/mod x -> tos=q, x=r, clobbers y z            \ from: https://github.com/bobbl/libaeabi-cortexm0/blob/master/i \ divmod.S                                                       2a00 a2,  \ cmp r2, #0                                          2301 a2,  \ movs r3, #1                                         2400 a2,  \ movs r4, #0                                         4290 a2,  \ cmp r0, r2                                          d906 a2,  \ bls l2                                              3200 a2,  \ adds r2, #0                                         d404 a2,  \ bmi l2                                              \ l3:                                                           005b a2,  \ lsls r3, #1                                         0052 a2,  \ lsls r2, #1                                         d401 a2,  \ bmi l2                                              4290 a2,  \ cmp r0, r2                                          d8fa a2,  \ bhi l3                                              \ l2:                                                           4290 a2,  \ cmp r0, r2                                          d301 a2,  \ bcc l4                                              1a80 a2,  \ subs r0, r2                                         431c a2,  \ orrs r4, r3                                         \ l4:                                                           0852 a2,  \ lsrs r2, #1                                         085b a2,  \ lsrs r3, #1                                         d1f8 a2,  \ bne l2                                              4602 a2,  \ mov r2, r0                                          4620 a2, ; \ mov r0, r4                                       : u/mod  u/mod_ ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - ARM Cortex 450                                                                                    \ generic ARM Cortex-M0 operations #3                                                                                           : /mod  \ tos /mod x -> tos=q, x=r, clobbers y z w                2100 a2, \ movs r1, #0                                          2500 a2, \ movs r5, #0                                          2800 a2, \ cmp r0, #0                                           da01 a2, \ bge lx1                                              2101 a2, \ movs r1, #1                                          4240 a2, \ rsbs r0, r0, #0                                      \ lx1:                                                          2a00 a2, \ cmp r2, #0                                           da01 a2, \ bge lx2                                              2501 a2, \ movs r5, #1                                          4252 a2, \ rsbs r2, r2, #0                                      \ lx2:                                                          u/mod_                                                          2900 a2, \ cmp r1, #0                                           d000 a2, \ beq lx3                                              4252 a2, \ rsbs r2, r2, #0                                      \ lx3:                                                          4069 a2, \ eors r1, r5                                          d000 a2, \ beq lx4:                                             4240 a2, ; \ rsbs r0, r0, #0; lx4:                            : 1+  3001 a2, ;    \ adds r0, #1                               : aligned                                                         2100 1 tcells 1- tuck or a2, \ movs r1, #<cell-1>               3000 or a2, \ adds r0, #<cell-1>                                4388 a2, ;  \ bics r0, r1                                     : >r                                                              4671 a2, \ mov r1, lr                                           6008 a2, \ str r0, [r1]                                         3104 a2, \ adds r1, #4                                          468e a2, ; \ mov lr, r1                                       : r>                                                              4671 a2, \ mov r1, lr                                           3904 a2, \ subs r1, #4                                          6808 a2, \ ldr r0, [r1]                                         468e a2, ; \ mov lr, r1                                       : lshift  4090 a2, ; \ lsls r0, r2                              : rshift  40d0 a2, ; \ lsrs r0, r2                              : rshifta  4110 a2, ; \ asrs r0, r2                             : syscall#  4607 a2, ; \ mov r7, r0                             : syscall  df00 a2, ; \ svc #0                                  : sysarg    ( u -- )                                              0000 or a2, ; \ movs r<n>, r0                                 : break  df01 a2, ; \ svc #1                                    : trylock ;                                                     : pause  bf30 a2, ; \ wfi                                       : skip  3600 1 tcells or a2, ;   \ adds r6, #<cell>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - ARM Cortex 450                                                                                    \ generic ARM Cortex-M0 operations #4 (end)                                                                                     variable cond                                                   : <                                                               4282 a2,  \ cmp r2, r0                                          da00 cond ! ; \  bge                                          : =                                                               4282 a2,  \ cmp r2, r0                                          d100 cond ! ; \ bne                                           : u<                                                              4282 a2, \ cmp r2, r0                                           d200 cond ! ; \ bcs                                           : 0=                                                              2800 a2,  \ cmp r0, #0                                          d100 cond ! ; \ bne                                           : cs? d300 cond ! ; \ bcc                                       : patchj  ( from to -- )                                          over - 1 rshifta 2 - ff and over w2@ or  swap w2! ;           : %if  ( -- a ) ahere  cond @ a2, ;                             : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  e000 a2, ;  \ b                      : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Platform specific code 13 - ARM Cortex 450                                                                                    \ syscall implementation for ARM Cortex                         \ (actually ARM linux with thumb)                                                                                               .( ARM-Cortex/linux )                                                                                                           code syscall0  ( n -- y )                                         syscall#  syscall  next                                       end-code                                                        code syscall1  ( x n -- y )                                       syscall#  drop  syscall  next                                 end-code                                                        code syscall2  ( x y n -- z )                                     syscall#  drop 1 sysarg  drop  syscall  next                  end-code                                                        code syscall3  ( x y z n -- p )                                   syscall#  drop x!  drop 1 sysarg  drop  syscall  next         end-code                                                        code syscall4  ( x y z p n -- q )                                 syscall#  drop y!  drop x!  drop 1 sysarg  drop  syscall next end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   syscall#  drop x! 5 tcells # + x!                               x @ 5 sysarg  x cell- x! @ z!  x cell- x! @ y!                  x cell- x! @ dup  x cell- x! @ 1 sysarg  x cell- @ >r           drop x!  r>  syscall  next                                    end-code                                                        3 constant sys_read                                             4 constant sys_write                                            1 constant sys_exit                                             5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          19 constant sys_lseek                                           162 constant sys_nanosleep                                      192 constant sys_mmap2                                          91 constant sys_munmap                                          197 constant sys_fstat  \ actually fstat64                      2 constant sys_fork                                             11 constant sys_execve                                          114 constant sys_wait4                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     48 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                              350 load \ unix                                                 create linux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Platform specific code 13                                                                                                     \ MIPS                                                            "generic" implementation                      461 - 463                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - MIPS 460                                                                                          \ generic mips operations - #1                                                                                                  \  TOS: $2 / $v0                                                \  SP:  $29 / $sp                                               \  RP:  $30 / $fp                                               \  AP:  $28 / $gp                                               \  W:   $25 / $t9                                               \                                                               \ temporaries: x=$v1, y=$a0, z=$a1                              hex                                                             : imm  ( x -- u ) ffff and ;                                    : dup                                                             23bd0000 1 tcells negate imm or a4, \ $sp <-cell> # $sp addi    afa20000 a4, ;    \ $sp ) $2 sw                               : drop                                                            8fa20000 a4,      \ $sp ) $2 lw                                 23bd0000 1 tcells or a4, ;    \ $sp <cell> # $sp addi         : #  ( x -- )                                                     dup ffff0000 and 0=  if                                           34020000 or a4,  exit  then     \ $0 xxxx # $2 ori            dup 0<  if                                                        imm 20020000 or a4,  exit  then  \ $0 xxxx # $2 addi          dup d# 16 rshift 3c020000 or a4,     \ xxxx # $2 lui            imm 34420000 or a4, ;       \ $2 yyyy # $2 ori                : cell+  20420004  a4, ;    \ $2 4 # $2 addi                    : cell-  2042fffc  a4, ;    \ $2 -4 # $2 addi                   : jump                                                            600008  a4,         \ $3 jr                                     0 a4, ;             \ nop                                     : next  \ clobbers x                                              8f990000  a4,     \ $28 ) $25 lw                                239c0004  a4,     \  $28 4 # $28 addi                           8f230000  a4,     \ $25 ) $3 lw                                 0  a4,            \ nop (LDS)                                   jump ;                                                        : osargs                                                          [defined] target-bsd  [if]                                        e01020  a4,   \ $a3 $2 move                                   [else]                                                            3a01020  a4,    \ $sp $2 move                                 [then] ;                                                      : sp  3a01020  a4, ;    \ $29 $2 move                           : rp  3c01020  a4, ;    \ $30 $2 move                           : ap  3801020  a4, ;    \ $28 $2 move                           : w  3201020  a4, ;     \  $25 $2 move                          : x  601020  a4, ;      \  $3 $2 move                           : y  801020  a4, ;      \  $4 $2 move                           : z  a01020  a4, ;      \ $5 $2 move                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - MIPS 460                                                                                          \ generic mips operations - #2                                                                                                  : @  8c420000  a4, ;    \ $2 ) $2 lw                            : c@  90420000  a4, ;   \ $2 ) $2 lbu                           : !  ac620000  a4, ;    \  $3 ) $2 sw                           : c!  a0620000  a4, ;   \ $3 ) $2 sb                            : sp!  40e820  a4, ;    \  $2 $29 move                          : rp!  40f020  a4, ;    \  $2 $30 move                          : ap!  40e020  a4, ;    \ $2 $28 move                           : w!  40c820  a4, ;     \  $2 $25 move                          : x!  401820  a4, ;     \ $2 $3 move                            : y!  402020  a4, ;     \ $2 $4 move                            : z!  402820  a4, ;     \ $2 $5 move                            : +  431021  a4, ;      \ $2 $3 $2 addu                         : -  431023  a4, ;      \  $2 $3 $2 subu                        : *                                                               620018  a4,   \  $3 $2 mult                                     1012  a4, ;   \  $2 mflo                                      : and  431024  a4, ;    \  $2 $3 $2 and                         : or  431025  a4, ;     \  $2 $3 $2 or                          : xor  431026  a4, ;    \ $2 $3 $2 xor                          : /mod                                                            43001a  a4,   \  $2 $3 div                                      1810  a4,     \ $3 mfhi                                         1012  a4, ;   \ $2 mflo                                       : u/mod                                                           43001b  a4,   \ $2 $3 divu                                      1810  a4,     \ $3 mfhi                                         1012  a4, ;   \ $2 mflo                                       : 1+  20420001  a4, ;   \ $2 1 # $2 addi                        : aligned                                                         20420000 1 tcells 1- tuck or  a4,    \  $2 <cell-1> # $2 addi   invert imm 20010000 or  a4,      \  $0 <~cell-1> # $at addi     411024  a4, ;     \  $2 $at $2 and                            : skip  239c0000 1 tcells or  a4, ;     \ $28 <cell> # $28 addi : >r                                                              afc20000  a4,     \ $30 ) $2 sw                                 23de0000 1 tcells or  a4, ;   \  $30 <cell> # $30 addi        : r>                                                              23de0000 1 tcells negate imm or  a4,     \ $30 -4 # $30 addi    8fc20000  a4, ;   \ $30 ) $2 lw                               : lshift  621004  a4, ; \ $3 $2 $2 sllv                         : rshift  621006  a4, ; \ $3 $2 $2 srlv                         : rshifta  621007  a4, ;    \  $3 $2 $2 srav                    : syscall  c  a4, ; \ syscall                                   : sysarg  ( u -- )                                                d# 11 lshift 402020 or a4, ;  \ $2 $a<u> move                 : break  0d  a4, ;  \ break                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - MIPS 460                                                                                          \ generic mips operations - #3 (end)                                                                                            : trylock                                                         8c620000  a4,     \ $3 ) $2 lw                                  10400004  a4,     \ l1 $0 $2 beq                                0  a4,            \ nop                                         34420000  a4,     \ 0 # $2 li                                   10000009  a4,     \ ba l2                                       0  a4,            \ nop                                         34420001  a4,     \ l1: 0 # $2 li                               e0620000  a4,     \ $3 ) $2 sc                                  10400004  a4,     \ l2 $0 $2 beq                                0  a4,            \ nop                                         34420001  a4,     \ 1 # $2 li                                   10000002  a4,     \ ba l3                                       0  a4,            \ nop                                         34420000  a4, ;   \ l3: 0 # $2 li; l2:                        : pause ;                                                       variable cond                                                   : <                                                               62082a a4,    \ $2 $3 $at slt                                   10200000 cond ! ; \ <dest> $at $0 beq                         : =                                                               14430000 cond ! ; \ <dest> $2 $3 bne                          : u<                                                              62082b a4,        \ $2 $3 $at sltu                              10200000 cond ! ; \ <dest> $at $0 beq                         : 0=                                                              14400000 cond ! ; \ <dest> $2 $0 beq                          : syserr?                                                         10e00000 cond ! ; \ <dest> $a3 $0 beq                         : patchj  ( from to -- )                                          over - 1 tcells / 1- imm  over w4@ or  swap w4! ;             : %if  ( -- a ) ahere  cond @ a4, 0 a4, ;                       : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  10000000 a4, 0 a4, ;  \ ba, nop      : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13                                                                                                     \ RISC-V                                                          "generic" implementation                      471 - 473                                                                       \ OS-specific system calls and code                               Linux system calls                            474                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - RISC-V 470                                                                                        \ generic riscv operations #1                                                                                                   \  TOS: x10 / a0                                                \  SP:  x2  / sp                                                \  RP:  x3  / gp                                                \  AP:  x18 / s2                                                \  W:   x19 / s3                                                \                                                               \ temporary used in assembler and `next`: x5 / t0               \ temporaries: x=x11, y=x12, z=x13                              hex                                                             : imm12  ( x -- y ) d# 20 lshift ;                              : dup                                                             10113 -1 tcells imm12 or a4,  \  sp sp <-cell> # addi           a12023 a4, ;  \ x10 sp ) sw                                   : drop                                                            12503 a4,     \ x10 sp ) lw                                     10113 1 tcells imm12 or a4, ;  \ sp sp <cell> # addi          : #  ( x -- )                                                     dup d# -2048 d# 2048 within 0=  if                                dup fffff000 and 00000537 or a4,    \ x10 xxxx # lui            imm12 00056513 or a4,     \ x10 x10 yyyy # ori                else  imm12 00000513 or a4,  then ;   \ x10 x0 xxxx # addi    : cell+  1 tcells imm12 50513 or a4, ;   \ x10 x10 <cell> # addi: cell-  -1 tcells imm12 50513 or a4, ; \ x10 x10 <-cell> # addi: jump  58067 a4, ; \ x11 jr                                    : next                                                            92983 a4,     \ x19 x18 ) lw                                    1 tcells imm12 90913 or a4,    \ x18 x18 <cell> # addi          9a283 a4,     \ x5 x19 ) lw                                     28067 a4, ;   \ x5 jr                                         : osargs                                                          [defined] target-bsd  [if]                                        60513 a4,   \ x10 x12 mv                                      [else]                                                            10513 a4,   \ x10 sp mv                                       [then] ;                                                      : sp  10513 a4, ;   \ x10 sp mv                                 : rp  18513 a4, ;   \ x10 x3 mv                                 : ap  90513 a4, ;   \ x10 x18 mv                                : w  98513 a4, ;    \ x10 x19 mv                                : x  58513 a4, ;    \ x10 x11 mv                                : y  60513 a4, ;    \ x10 x12 mv                                : z  68513 a4, ;    \ x10 x13 mv                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - RISC-V 470                                                                                        \ generic riscv operations #2                                                                                                   : @  52503 a4, ;    \ x10 x10 ) lw                              : c@  54503 a4, ;   \  x10 x10 ) lbu                            : !  a5a023 a4, ;   \ x10 x11 ) sw                              : c!  a58023 a4, ;  \ x10 x11 ) sb                              : sp!  50113 a4, ;  \ sp x10 mv                                 : rp!  50193 a4, ;  \ x3 x10 mv                                 : ap!  50913 a4, ;  \ x18 x10 mv                                : w!  50993 a4, ;   \ x19 x10 mv                                : x!  50593 a4, ;   \  x11 x10 mv                               : y!  50613 a4, ;   \ x12 x10 mv                                : z!  50693 a4, ;   \ x13 x10 mv                                : +  b50533 a4, ;   \ x10 x10 x11 add                           : -  40b50533 a4, ; \ x10 x10 x11 sub                           : *  2b50533 a4, ;  \ x10 x10 x11 mul                           : and  b57533 a4, ; \ x10 x10 x11 and                           : or  b56533 a4, ;  \ x10 x10 x11 or                            : xor  b54533 a4, ; \ x10 x10 x11 xor                           : /mod                                                            50293 a4,         \ x5 x10 mv                                   2b54533 a4,       \ x10 x10 x11 div                             2b2e5b3 a4, ;     \ x11 x5 x11 rem                            : u/mod                                                           50293 a4,         \ x5 x10 mv                                   2b55533 a4,       \ x10 x10 x11 div                             2b2f5b3 a4, ;     \ x11 x5 x11 remu                           : 1+  150513 a4, ;  \ x10 x10 1 # addi                          : aligned                                                         1 tcells 1- dup imm12 50513 or a4,  \ x10 x10 <cell-1> # addi   invert imm12 57513 or a4, ;   \ x10 x10 <~cell-1> # andi      : skip  90913 1 tcells imm12 or a4, ;   \ x18 x18 <cell> # addi : >r                                                              a1a023 a4,    \ x10 x3 ) sw                                     1 tcells imm12 18193 or a4, ;  \ x3 x3 <cell> # addi          : r>                                                              -1 tcells imm12 18193 or a4,  \ x3 x3 <-cell> # addi            1a503 a4, ;    \ x10 x3 ) lw                                  : lshift  b51533 a4, ;  \ x10 x10 x11 sll                       : rshift  b55533 a4, ;  \ x10 x10 x11 srl                       : rshifta  40b55533 a4, ;   \ x10 x10 x11 sra                   : syscall  73 a4, ; \ ecall                                     : sysarg!  ( u -- )                                               7 lshift 00050013 or a4, ;    \ x<u> x10 0 # addi             : syscall#  d# 17 sysarg! ;                                     : break  00100073 a4, ;  \ ebreak                               : trylock                                                         1005a52f a4,  \ x10 x11 lr.w                                    51a63 a4,     \ x10 x0 l1 beq                                   100513 a4,    \ x10 x0 1 # addi                                 18b5252f a4,  \ x10 x10 x11 sc.w                                153513 a4,    \ x10 x10 seqz                                    463 a4,       \ x0 x0 l2 beq                                    513 a4, ;     \ l1: x10 x0 mv   l2:                           : pause ;                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - RISC-V 470                                                                                        \ generic riscv operations #3 (end)                                                                                             variable cond                                                   : <  a5d063 cond ! ;  \ x11 x10 <l> bge                         : =  b51063 cond ! ;  \ x10 x11 <l> bne                         : u<  a5f263 cond ! ;   \ x11 x10 <l> bgeu                      : 0=  51063 cond ! ;    \ x10 x0 <l> bne                        : sboff  ( x -- u )                                               \ ____ ____ ____ ____ ___A BCCC CCCD DDD_                       \ ACCC CCCX XXXX YYYY YZZZ DDDD BOOO OOOO                       dup 1000 and d# 19 lshift         \ A                           over 03e0 and d# 20 lshift or      \ C                          over 001e and 7 lshift or        \ D                            swap 0800 and 4 rshift or ;     \ B                           : patchj  ( from to -- ) over - sboff over w4@ or swap w4! ;    : %if  ( -- a ) ahere  cond @ a4, ;                             : if  %if  ;                                                    : then  ( a -- ) ahere patchj  ;                                : branch,  ( -- a ) ahere  63 a4, ;  \ x0 x0 <l> beq            : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Platform specific code 13 - RISC-V 470                                                                                        \ syscall implementation for RISC-V/Linux                                                                                       .( riscv/Linux )                                                                                                                code syscall0  ( n -- y )  syscall#  syscall  next  end-code    code syscall1  ( x n -- y )                                       syscall#  drop syscall  next                                  end-code                                                        code syscall2  ( x y n -- z )                                     syscall#  drop x!  drop syscall  next                         end-code                                                        code syscall3  ( x y z n -- p )                                   syscall#  drop y!  drop x!  drop syscall  next                end-code                                                        code syscall4  ( x y z p n -- q )                                 syscall#  drop z!  drop y!  drop x!  drop syscall  next       end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   syscall#  drop x! 5 tcells # + x!                               @ 15 sysarg!                                                    x cell- x! @ 14 sysarg!                                         x cell- x! @ z!                                                 x cell- x! @ y!                                                 x cell- x! @ >r                                                 x cell- @ dup                                                   r> x!  drop syscall  next                                     end-code                                                        63 constant sys_read                                            64 constant sys_write                                           93 constant sys_exit                                            56 constant sys_openat                                          57 constant sys_close                                           35 constant sys_unlink                                          62 constant sys_lseek                                           101 constant sys_nanosleep                                      222 constant sys_mmap2                                          215 constant sys_munmap                                         80 constant sys_fstat                                           220 constant sys_clone                                          221 constant sys_execve                                         260 constant sys_wait4                                          227 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     48 constant stat>size                                           17 constant SIGCHLD                                             420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                                                                                              350 load \ unix                                                 create linux                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Platform specific code 13                                                                                                     \ PowerPC                                                         "generic" implementation                      481 - 483                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - PowerPC 480                                                                                       \ generic PPC operations #1                                                                                                     \  TOS: r3                                                      \  SP:  r1                                                      \  RP:  r11                                                     \  AP:  r13                                                     \  W:   r14                                                     \                                                               \ temporaries: x=r4, y=r5, z=r6                                 hex                                                             : dup  9461fffc a4, ;    \  r3 r1 -4 # stwu                     : drop                                                            80610000 a4,  \ r3 r1 ) lwz                                     38210004 a4, ;    \ r1 r1 4 # addi                            : #  ( x -- )                                                     dup d# -32768 d# 32768 within  if                                 ffff and 38600000 or a4,  exit  then    \ r3 r0 xxxx # addi   dup d# 16 rshifta 3c600000 or a4,  \  r3 r3 yyyy # addis        ffff and 38630000 or a4, ;    \ r3 r0 xxxx # addi             : cell+  38630004 a4, ; \ r3 r3 4 # addi                        : cell-  3863fffc a4, ; \ r3 r3 -4 # addi                       : jump                                                            7c8803a6 a4,  \ r2 mtlr                                         4e800020 a4, ;    \ blr                                       : next                                                            81cd0000 a4,  \  r14 r13 ) lwz                                  39ad0004 a4,  \ r13 r13 4 # addi                                808e0000 a4,  \  r4 r14 ) lwz                                   7c8803a6 a4,  \ r4 mtlr                                         4e800020 a4, ;    \ blr                                       : osargs                                                          [defined] target-bsd  [if]                                          7d034378 a4,  \ r3 r8 mr                                    [else]  7c230b78 a4, [then] ; \ r3 r1 mr                      : sp  7c230b78 a4, ;    \ r3 r1 mr                              : rp  7d635b78 a4, ;    \ r3 r11 mr                             : ap  7da36b78 a4, ;    \ r3 r13 mr                             : w  7dc37378 a4, ;     \ r3 r14 mr                             : x  7c832378 a4, ;     \ r3 r4 mr                              : y  7ca32b78 a4, ;     \ r3 r5 mr                              : z  7cc33378 a4, ;     \ r3 r5 mr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - PowerPC 480                                                                                       \ generic PPC operations #2                                                                                                     : @  80630000 a4, ;     \  r3 r3 ) lwz                          : c@  88630000 a4, ;    \ r3 r3 ) lbz                           : !  90640000 a4, ;     \ r3 r4 ) stw                           : c!  98640000 a4, ;    \ r3 r4 ) stb                           : sp!  7c611b78 a4, ;   \ r1 r3 mr                              : rp!  7c6b1b78 a4, ;   \ r11 r3 mr                             : ap!  7c6d1b78 a4, ;   \ r13 r3 mr                             : w!  7c6e1b78 a4, ;    \ r14 r3 mr                             : x!  7c641b78 a4, ;    \ r4 r3 mr                              : y!  7c651b78 a4, ;    \ r5 r3 mr                              : z!  7c661b78 a4, ;    \ r6 r3 mr                              : +  7c641a14 a4, ;     \ r3 r4 r3 add                          : -  7c641850 a4, ;     \ r3 r3 r4 sub                          : *  7c6419d6 a4, ;     \  r3 r4 r3 mullw                       : and  7c831838 a4, ;   \ r3 r4 r3 and                          : or  7c831b78 a4, ;    \ r3 r4 r3 or                           : xor  7c831a78 a4, ;   \ r3 r4 r3 xor                          : /mod                                                            7c651b78 a4,  \ r5 r3 mr                                        7c6523d6 a4,  \ r3 r5 r4 divw                                   7cc321d6 a4,  \ r6 r3 r4 mullw                                  7cc62850 a4,  \ r6 r5 r6 sub                                    7cc43378 a4, ;    \  r4 r6 mr                                 : u/mod                                                           7c651b78 a4,  \ r5 r3 mr                                        7c652396 a4,  \  r3 r5 r4 divwu                                 7cc321d6 a4,  \ r6 r3 r4 mullw                                  7cc62850 a4,  \ r6 r5 r6 sub                                    7cc43378 a4, ;    \ r4 r6 mr                                  : 1+  38630001 a4, ;    \ r3 r3 1 # addi                        : aligned                                                         38630003 a4,  \ r3 r3 3 # addi                                  5463003a a4, ;    \ r3 r3 2 # clrrwi                          : skip  39ad0004 a4, ;  \ r13 r13 4 # addi                      : >r                                                              906b0000 a4,  \ r3 r11 ) stw                                    396b0004 a4, ;    \ r11 r11 4 # addi                          : r>  846bfffc a4, ;    \ r3 r11 -4 # lwzu                      : lshift  7c632030 a4, ;    \ r3 r3 r4 slw                      : rshift  7c632430 a4, ;    \ r3 r3 r4 srw                      : rshifta  7c632630 a4, ;   \ r3 r3 r4 sraw                     : sysarg!  ( u -- )                                               d# 16 lshift 7c601b78 or a4, ; \ r<x> r3 mr                   : syscall#  ( u -- ) 0 sysarg! ;                                : syscall  44000002 a4, ;   \ sc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - PowerPC 480                                                                                       \ generic PPC operations #3 (end)                                                                                               : break  7fe00008 a4, ;     \ trap                              : trylock                                                         7cc02028 a4,  \ r6 r0 r4 lwarx                                  38600000 a4,  \ r3 0 # li                                       2c060000 a4,  \ crf0 r6 0 # cmpwi                               40820018 a4,  \  =  if                                          38600001 a4,  \ r3 1 # li                                       7c60212d a4,  \  r3 r0 r4 stwcx.                                4082000c a4,  \ =  if                                           4c00012c a4,  \   isync                                         38600001 a4, ; \  r3 1 # li  then  then                       : pause ;                                                       variable cond                                                   : <                                                               7c041800 a4,  \ crf0 r4 r3 cmpw                                 800000 cond !  ; \  bge                                       : =                                                               7c041800 a4,  \ crf0 r4 r3 cmpw                                 820000 cond !  ; \ bne                                        : u<                                                              7c041840 a4, \ crf0 r4 r3 cmplw                                 800000 cond !  ; \ bge                                        : 0=                                                              2c030000 a4,  \ crf0 r3 0 # cmpwi                               820000 cond !  ; \ bne                                        : syserr?  830000 cond ! ;  \ bso                               : patchj  ( from to -- )                                          over -  fffc and  over w4@ or swap w4! ;                      : %if  ( -- a ) ahere  cond @ 40000000 or a4, ;                 : if  %if  ;                                                    : then  ( a -- ) ahere patchj  ;                                : branch,  ( -- a ) ahere  48000000 a4,  ;  \ b                 : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) ahere - h# 03fffffc 48000000 or a4, ;         decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13                                                                                                     \ 68000                                                           "generic" implementation                      491 - 493                                                                       \ OS-specific system calls and code                               Linux system calls                            494                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - 68000 490                                                                                         \ generic m68k operations #1                                                                                                    \ TOS: d0                                                       \ SP:  a7 (sp)                                                  \ RP:  a6                                                       \ AP:  a5                                                       \ W:   a4                                                       \ X, Y, Z: a0, d1, d2                                           hex                                                             : dup  2F00 a2, ;   \ move.l d0, -(sp)                          : drop  201F a2, ;  \ move.l (sp)+, d0                          : #  ( x -- )                                                     dup -128 127 within  if                                           ff and 7000 or a2,  exit  then  \ moveq.l d0, #xx             203c a2, a4, ;    \ move.l #xxxxxxxx, d0                      : cell+  5080 1 tcells 9 lshift or a2, ; \ addq.l #<cell>, d0   : cell-  5180 1 tcells 9 lshift or a2, ; \ subq.l #<cell>, d0   : jump  4ed0 a2, ;  \ jmp (a0)                                  : next                                                            285d a2,  \ move.l (a5)+, a4                                    2054 a2,  \ move.l (a4), a0                                     jump ;                                                        [defined] target-bsd  [if]                                      : osargs  200a a2, ;    \ move.l a2, d0                         [else]                                                          : osargs 200f a2, ;     \ move.l sp, d0                         [then]                                                          : sp  200f a2, ;    \ move.l sp, d0                             : rp  200e a2, ;    \ move.l a6, d0                             : ap  200d a2, ;    \ move.l a5, d0                             : w  200c a2, ;    \ move.l a4, d0                              : x  2008 a2, ;    \ move.l a0, d0                              : y  2001 a2, ;    \ move.l d1, d0                              : z  2002 a2, ;    \ move.l d2, d0                              : @                                                               2240 a2,   \ movea.l d0, a1                                     2011 a2, ;    \ move.l (a1), d0                               : c@                                                              2240 a2,  \ movea.l d0, a1                                      7000 a2,  \ moveq.l #0, d0                                      1011 a2, ;    \ move.b (a1), d0                               : !  2080 a2, ; \ move.l d0, (a0)                               : c!  1080 a2, ;    \ move.b d0, (a0)                           : sp!  2e40 a2, ;   \ movea.l d0, sp                            : rp!  2c40 a2, ;   \ movea.l d0, a6                            : ap!  2a40 a2, ;   \ movea.l d0, a5                            : w!  2840 a2, ;   \ movea.l d0, a4                             : x!  2040 a2, ;   \ movea.l d0, a0                             : y!  2200 a2, ;   \ movea.l d0, d2                             : z!  2400 a2, ;   \ movea.l d0, d3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - 68000 490                                                                                         \ generic m68k operations #2                                                                                                    : +  d088 a2, ;     \ add.l a0, d0                              : -  9088 a2, ;     \ sub.l a0, d0                              : *                                                               2608 a2,  \ move.l a0, d3                                       4c03 a2, 0800 a2, ;   \ muls.l d3, d0                         : and                                                             2608 a2,  \ move.l a0, d3                                       c083 a2, ;    \ and.l d3, d0                                  : or                                                              2608 a2,  \ move.l a0, d3                                       8083 a2, ;    \ or.l d3, d0                                   : xor                                                             2608 a2,  \ move.l a0, d3                                       b780 a2, ;    \ eor.l d3, d0                                  : break  4e41 a2, ;   \ trap #1                                 : /mod                                                            2608 a2,  \ move.l a0, d3                                       [defined] target-coldfire  [if]                                 2800 a2,  \ move.l d0, d4                                       4c43 a2, 0800 a2, \ divs.l d3, d0                               4c43 a2, 4803 a2, \ rems.l d3, d3:d4                            [else]                                                          4c43 a2, 0803 a2,     \ divsl.l d3, d3:d0                       [then]                                                          2043 a2, ;    \ movea.l d3, a0                                : u/mod                                                           2608 a2,      \ move.l a0, d3                                   [defined] target-coldfire  [if]                                 2800 a2,      \ move.l d0, d4                                   4c43 a2, 0000 a2, \ divu.l d3, d0                               4c43 a2, 4003 a2, \ remu.l d3, d3:d4                            [else]                                                          4c43 a2, 0403 a2,     \ divul.l d3, d3:d0                       [then]                                                          2043 a2, ;    \ movea.l d3, a0                                : 1+  5280 a2, ;    \ addq.l #1, d0                             : aligned                                                         5080 1 tcells 1- tuck 9 lshift or a2,  \ addq.l #<cell-1>, d0   c0bc a2,  invert a4, ;   \ and.l #~<cell-1>, d0               : skip  508d 1 tcells 9 lshift or a2, ; \ addq.l #<cell>, a5    : >r  2cc0 a2, ;    \ move.l d0, (a6)+                          : r>  2026 a2, ;    \ move.l -(a6), d0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - 68000 490                                                                                         \ generic m68k operations #3 (end)                                                                                              : lshift                                                          2608 a2,  \ move.l a0, d3                                       e7a8 a2, ;    \ lsl.l d3, d0                                  : rshift                                                          2608 a2,  \ move.l a0, d3                                       e6a8 a2, ;    \ lsr.l d3, d0                                  : rshifta                                                         2608 a2,  \ move.l a0, d3                                       e6a0 a2, ;    \ asr.l d3, d0                                  : syscall  4e40 a2, ;   \ trap #0                               : sysarg  ( u -- ) 9 lshift 2000 or a2, ; \ move.l d0, d<n>     : trylock                                                         7001 a2,  \ moveq.l #1, d0                                      4ad0 a2,  \ tas (a0)                                            6702 a2,  \ beq l1                                              7000 a2, ;    \ moveq.l #0, d0   l1:                          : pause ;                                                       variable cond                                                   : <                                                               b1c0 a2,      \ cmpa.l d0, a0                                   6c00 cond ! ; \ bge                                           : =                                                               b088 a2,      \ cmp.l a0, d0                                    6600 cond ! ; \ bne                                           : u<                                                              b1c0 a2,      \ cmpa.l d0, a0                                   6400 cond ! ; \ bls                                           : 0=                                                              4a80 a2,      \ tst.l d0                                        6600 cond ! ; \ bne                                           : cs?  6400 cond ! ;           \ bcc                            : patchj  ( from to -- ) over 2 + - swap 1+ c! ;                : %if  ( -- a ) ahere  cond @ a2, ;                             : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  6000 a2, ;   \ bra                   : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Platform specific code 13 - 68000 490                                                                                         \ syscall implementation for m68k/Linux                                                                                         .( m68k/Linux )                                                                                                                 code syscall0  ( n -- y ) syscall  next  end-code               code syscall1  ( x n -- y )                                       x!  drop 1 sysarg  x syscall  next                            end-code                                                        code syscall2  ( x y n -- z )                                     x!  drop 2 sysarg  drop 1 sysarg  x syscall  next             end-code                                                        code syscall3  ( x y z n -- p )                                   x!  drop 3 sysarg  drop 2 sysarg  drop 1 sysarg                 x syscall  next                                               end-code                                                        code syscall4  ( x y z p n -- q )                                 x!  drop 4 sysarg  drop 3 sysarg  drop 2 sysarg                 drop 1 sysarg  x syscall  next                                end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   y!  drop x!  5 tcells # + x!                                    x @ z!  x cell- x! @ 5 sysarg  y dup  z dup                     x cell- x! @ 4 sysarg  x cell- x! @ 3 sysarg                    x cell- x! @ 2 sysarg  x cell- @ 1 sysarg                       drop x!  drop syscall  next                                   end-code                                                        3 constant sys_read                                             4 constant sys_write                                            5 constant sys_open                                             6 constant sys_close                                            108 constant sys_fstat                                          19 constant sys_lseek                                           192 constant sys_mmap2                                          91 constant sys_munmap                                          162 constant sys_nanosleep                                      2 constant sys_fork                                             11 constant sys_execve                                          1 constant sys_exit                                             114 constant sys_wait4                                          10 constant sys_unlink                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     20 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                              350 load \ unix.f                                               create m68k                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13                                                                                                     \ SH4                                                             "generic" implementation                      496 - 498                                                                       \ OS-specific system calls and code                               Linux system calls                            499                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - SH4 495                                                                                           \ generic SH4 operations #1                                                                                                     \ TOS: r0                                                       \ SP:  r15 (sp)                                                 \ RP:  r14                                                      \ AP:  r13                                                      \ W:   r12                                                      \ X, Y, Z: r1, r2, r3                                           \ tmp: r11                                                      hex                                                             : kalign  \ align PC in kernel for PC-relative 4-byte move        mkh @ reloc 3 and  if  0009 a2,  then ; \ insert nop          : dup  2f06 a2, ;   \ mov.l r0, @-r15                           : drop  60f6 a2, ;  \ mov.l @r15+, r0                           : #  ( x -- )                                                     dup -128 127 within  if                                           ff and e000 or a2,  exit  then  \ mov #xx, r0                 d001 a2,      \ mov.l @(4, pc), r0                              kalign    \ mov.l above assumes address is 4-byte aligned       a002 a2,  0009 a2,  a4, ;  \ bra l1; nop; .long xxxxxxxx; l1: : cell+  7000 1 tcells or a2, ;     \ add #<cell>, r0           : cell-  7000 -1 tcells ff and or a2, ;     \ add #-<cell>, r0  : jump  412b a2,  0009 a2, ;  \ jmp @r1; nop                    : next                                                            6cd6 a2,  \ mov.l @r13+, r12                                    61c2 a2,  \ mov.l @r12, r1                                      jump ;                                                        : sp  60f3 a2, ;     \ mov r15, r0                              : osargs  sp ;                                                  : rp  60e3 a2, ;    \ mov r14, r0                               : ap  60d3 a2, ;    \ mov r13, r0                               : w  60c3 a2, ;    \ mov r12, r0                                : x  6013 a2, ;    \ mov r1, r0                                 : y  6023 a2, ;    \ mov r2, r0                                 : z  6033 a2, ;    \ mov r3, r0                                 : @  6002 a2, ;    \ mov.l @r0, r0                              : c@                                                              6000 a2,  \ mov.b @r0, r0                                       c9ff a2, ;  \ and #0xff, r0                                   : !  2102 a2, ; \ mov.l r0, @r1                                 : c!  2100 a2, ;    \ mov.b r0, @r1                             : sp!  6f03 a2, ;   \ mov r0, r15                               : rp!  6e03 a2, ;   \ mov r0, r14                               : ap!  6d03 a2, ;   \ mov r0, r13                               : w!  6c03 a2, ;   \ mov r0, r12                                : x!  6103 a2, ;   \ mov r0, r1                                 : y!  6203 a2, ;   \ mov r0, r2                                 : z!  6303 a2, ;   \ mov r0, r3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - SH4 495                                                                                           \ generic SH4 operations #2                                                                                                     : +  301c a2, ;     \ add r1, r0                                : -  3018 a2, ;     \ sub r1, r0                                : *                                                               0017 a2,  \ mul.l r1, r0                                        001a a2, ;   \ sts macl, r0                                   : and  2019 a2, ; \ and r1, r0                                  : or  201b a2, ; \ or r1, r0                                    : xor  201a a2, ; \ xor r1, r0                                  : break  c301 a2, ;   \ trapa #1                                : /mod      \ tos /mod x -> tos=q, x=r                            6b03 a2, \ mov r0, r11                                          e400 a2, \ mov #0, r4                                           2047 a2, \ div0s r4, r0                                         355a a2, \ subc r5, r5                                          304a a2, \ subc r4, r0                                          2517 a2, \ div0s r1, r5                                         20 0  do                                                          4024 a2, \ rotcl r0                                             3514 a2, \ div1 r1, r5                                        loop                                                            4024 a2, \ rotcl r0                                             304e a2, \ addc r4, r0                                          \ a - (n * int(a/n))                                            0107 a2, \ mul.l r0, r1                                         011a a2, \ sts macl, r1                                         3b18 a2, \ sub r1, r11                                          61b3 a2, ; \ mov r11, r1                                      : u/mod     \ tos u/mod x -> tos=q, x=r                           6503 a2, \ mov r0, r5                                           e400 a2, \ mov #0, r4                                           0019 a2, \ div0u                                                20 0 do                                                           4024 a2, \ rotcl r0                                             3414 a2, \ div1 r1, r4                                        loop                                                            4024 a2, \ rotcl r0                                             \ a - (n * int(a/n))                                            0107 a2, \ mul.l r0, r1                                         011a a2, \ sts macl, r1                                         3518 a2, \ sub r1, r5                                           6153 a2, ; \ mov r5, r1                                       : 1+  7001 a2, ;    \ add #1, r0                                : aligned                                                         7000 1 tcells 1- tuck or a2,  \ add #<cell-1>, r0               invert ff and eb00 or a2,    \ mov #~<cell-1>, r11              20b9 a2, ;   \ and r11, r0                                    : skip  7d00 1 tcells or a2, ; \ add #<cell>, r13               : >r                                                              2e02 a2,    \ mov.l r0, @r14                                    7e00 1 tcells or a2, ; \ add #<cell>, r14                     : r>                                                              7e00 1 tcells negate ff and or a2, \ add #<-cell>, r14          60e2 a2, ;    \ mov.l @r14, r0                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Platform specific code 13 - SH4 495                                                                                           \ generic SH4 operations #3 (end)                                                                                               : lshift  401d a2, ; \ shld r1, r0                              : rshift  \ clobbers x                                            611b a2,  \ neg r1, r1                                          401d a2, ;    \ shld r1, r0                                   : rshifta  \ clobbers x                                           611b a2,  \ neg r1, r1                                          401d a2, ;    \ shad r1, r0                                   : syscall/0  c310 a2, ;   \ trapa #16                           : syscall/1  c311 a2, ;   \ trapa #17                           : syscall/2  c312 a2, ;   \ trapa #18                           : syscall/3  c313 a2, ;   \ trapa #19                           : syscall/4  c314 a2, ;   \ trapa #20                           : syscall/5  c315 a2, ;   \ trapa #21                           : syscall/6  c316 a2, ;   \ trapa #22                           : sysarg!  ( u -- u ) 8 lshift 6003 or a2, ; \ mov r0, r<n>     : trylock ( ??? ) ;                                             : pause ;                                                       variable cond                                                   : tcond  8900 cond ! ;      : fcond  8b00 cond ! ;              : < 3103 a2,  tcond ;     \ cmp/ge r0, r1                       : = 3100 a2,  fcond ;     \ cmp/eq r0, r1                       : u< 3102 a2,  tcond ;     \ cmp/hs r0, r1                      : 0=  8800 a2,  fcond ; \ cmp/eq #0, r0                         : patchj  ( from to -- )                                          over 4 + - 2/ swap                                              [defined] target-big-endian  [if]  1+  [then]  c! ;           : %if  ( -- a ) ahere  cond @ a2, ;  \ bt/bf                    : if  %if ;                                                     : then  ( a -- ) ahere patchj ;                                 : branch,  ( -- a ) ahere  a000 a2,  0009 a2, ;   \ bra; nop    : else  ( a1 -- a2 ) branch,  swap ahere patchj ;               : begin  ( -- a ) ahere ;                                       : again  ( a -- ) branch,  swap patchj ;                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Platform specific code 13 - SH4 495                                                                                           \ syscall implementation for SH4/Linux                          .( sh4/linux )                                                                                                                  code syscall0  ( n -- x ) z! syscall/0  next  end-code          code syscall1  ( x n -- y )                                       z! drop  4 sysarg!  syscall/1  next                           end-code                                                        code syscall2  ( x y n -- z )                                     z! drop  5 sysarg! drop  4 sysarg!  syscall/2  next           end-code                                                        code syscall3  ( x y z n -- p )                                   z! drop  6 sysarg! drop  5 sysarg! drop  4 sysarg!              syscall/3  next                                               end-code                                                        code syscall4  ( x y z p n -- q )                                 z! drop  7 sysarg! drop  6 sysarg! drop  5 sysarg!  drop        4 sysarg!  syscall/4  next                                    end-code                                                        code syscall6  ( a n -- x )     \ parameters are in a[0]...a[5]   z! drop  5 tcells # + y!                                        y @ x!  y cell- y!    \ x (r1) is arg#6                         @ >r  y cell- y!   \ save arg #5 for later                      @ 7 sysarg!  y cell- y!                                         @ 6 sysarg!  y cell- y!                                         @ 5 sysarg!  y cell-                                            @ 4 sysarg!  r>  \ restore saved value for r0                   syscall/6  next                                               end-code                                                        3 constant sys_read                                             4 constant sys_write                                            1 constant sys_exit                                             5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          19 constant sys_lseek                                           162 constant sys_nanosleep                                      192 constant sys_mmap2                                          91 constant sys_munmap                                          108 constant sys_fstat                                          2 constant sys_fork                                             11 constant sys_execve                                          114 constant sys_wait4                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     20 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                                                                                              350 load \ unix                                                 create linux                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/i386                                                                                         .( configuration is linux/i386 )                                                                                                4 wordsize                                                      little          create target-little-endian                     create target-i386                                              create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux    i386-elf                                        minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  382 384 thru ;                                  : target-configuration                                            385 load      \ linux                                           s" i386" tcreate                                                s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-i386-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  :#0 :#385     \ Meta compiler :#12                                                                                                            \ Platform configuration for FreeBSD/i386                                                                                       .( configuration is FreeBSD/i386 )                                                                                              4 wordsize                                                      little                                                          create target-little-endian                                     create target-lseek64                                           create target-i386                                              create target-freebsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-freebsd    i386-elf                                      minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  382 384 thru ;                                  : target-configuration                                            388 load      \ freebsd                                         s" i386" tcreate                                                s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-i386-freebsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  :#0 :#382     \ Meta compiler :#12                                                                                                            \ Platform configuration for NetBSD/i386                                                                                        .( configuration is NetBSD/i386 )                                                                                               4 wordsize                                                      little                                                          create target-little-endian                                     create target-i386                                              create target-netbsd                                            create target-unicode                                           330 334 thru     \ elf                                          select-netbsd    i386-elf                                       minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  382 384 thru ;                                  : target-configuration                                            390 load      \ netbsd                                          s" i386" tcreate                                                s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-i386-netbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ Meta compiler 12                                                                                                              \ Platform configuration for OpenBSD/i386                                                                                       .( configuration is OpenBSD/i386 )                                                                                              4 wordsize                                                      little                                                          create target-little-endian                                     create target-i386                                              create target-lseek64pad                                        create target-openbsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-openbsd    i386-elf                                      minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  382 384 thru ;                                  : target-configuration                                            389 load      \ openbsd                                         s" i386" tcreate                                                s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-i386-openbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/ARM                                                                                          .( configuration is linux/ARM )                                                                                                 4 wordsize                                                      little                                                          create target-little-endian                                     create target-arm                                               create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux    arm-elf                                         minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  401 404 thru ;                                  : target-configuration                                            405 load      \ arm/linux                                       s" arm" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-arm-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Meta compiler :#12                                                                                                            \ Platform configuration for FreeBSD/arm                                                                                        .( configuration is FreeBSD/arm )                                                                                               4 wordsize                                                      little                                                          create target-little-endian                                     create target-lseek64                                           create target-arm                                               create target-freebsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-freebsd    arm-elf                                       minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  401 404 thru ;                                  : target-configuration                                            408 load      \ arm/freebsd                                     s" arm" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-arm-freebsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Meta compiler :#12                                                                                                            \ Platform configuration for NetBSD/arm                                                                                         .( configuration is NetBSD/arm )                                                                                                4 wordsize                                                      little                                                          create target-little-endian                                     create target-arm                                               create target-netbsd                                            create target-unicode                                           330 334 thru     \ elf                                          select-netbsd    arm-elf                                        minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  401 404 thru ;                                  : target-configuration                                            410 load      \ arm/netbsd                                      s" arm" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-arm-netbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev _0             \ Meta compiler 12                                                                                                              \ Platform configuration for OpenBSD/arm                                                                                        .( configuration is OpenBSD/arm )                                                                                               4 wordsize                                                      little                                                          create target-little-endian                                     create target-arm                                               create target-lseek64pad                                        create target-openbsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-openbsd    arm-elf                                       minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  401 404 thru ;                                  : target-configuration                                            409 load      \ arm/openbsd                                     s" arm" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-arm-openbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  :#0 :#425     \ Meta compiler :#12                                                                                                            \ Platform configuration for Linux/x86_64                                                                                       .( configuration is linux/x86_64 )                                                                                              8 wordsize                                                      little                                                          create target-little-endian                                     create target-x86_64                                            create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux    x86_64-elf                                      minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  421 423 thru ;                                  : target-configuration                                            425 load      \ linux                                           s" x86_64" tcreate                                              s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-x86_64-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  :#0 :#385     \ Meta compiler :#12                                                                                                            \ Platform configuration for FreeBSD/x86_64                                                                                     .( configuration is FreeBSD/x86_64 )                                                                                            8 wordsize                                                      little                                                          create target-little-endian                                     create target-lseek64                                           create target-x86_64                                            create target-freebsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-freebsd    x86_64-elf                                    minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  421 423 thru ;                                  : target-configuration                                            429 load      \ freebsd                                         s" x86_64" tcreate                                              s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-x86_64-freebsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev  0             \ Meta compiler 12                                                                                                              \ Platform configuration for NetBSD/x86_64                                                                                      .( configuration is NetBSD/x86_64 )                                                                                             8 wordsize                                                      little                                                          create target-little-endian                                     create target-x86_64                                            create target-netbsd                                            create target-unicode                                           330 334 thru     \ elf                                          select-netbsd    x86_64-elf                                     minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  421 423 thru ;                                  : target-configuration                                            431 load      \ netbsd                                          s" x86_64" tcreate                                              s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-x86_64-netbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back  0        \ Meta compiler 12                                                                                                              \ Platform configuration for OpenBSD/x86_64                                                                                     .( configuration is OpenBSD/x86_64 )                                                                                            8 wordsize                                                      little                                                          create target-little-endian                                     create target-x86_64                                            create target-lseek64pad                                        create target-openbsd                                           create target-unicode                                           330 334 thru     \ elf                                          select-openbsd    x86_64-elf                                    minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  421 423 thru ;                                  : target-configuration                                            430 load      \ openbsd                                         s" x86_64" tcreate                                              s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-x86_64-openbsd" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Platform configuration for Darwin/x86_64                                                                                      .( configuration is Darwin/x86_64 )                                                                                             8 wordsize                                                      little                                                          create target-little-endian                                     create target-x86_64                                            create target-darwin                                            create target-unicode                                           335 339 thru     \ macho                                        x86_64-macho                                                    minkernel machoaligned kernelsize !                             machobaseaddr constant baseaddr                                 : load-generic  421 423 thru ;                                  : target-configuration                                            432 load      \ darwin                                          s" x86_64" tcreate                                              s" little-endian" tcreate                                       s" unicode" tcreate                                             s" macho" tcreate ;                                           : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-x86_64-darwin" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/SH4                                                                                          .( configuration is Linux/SH4 )                                                                                                 4 wordsize                                                      little                                                          create target-little-endian                                     create target-sh4                                               create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux  sh4-elf                                           minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  496 498 thru ;                                  : target-configuration                                            499 load      \ linux                                           s" sh4" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-sh4-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/RISC-V                                                                                       .( configuration is Linux/RISC-V )                                                                                              4 wordsize                                                      little                                                          create target-little-endian                                     create target-riscv                                             create target-linux                                             create target-unicode                                           create target-openat                                            330 334 thru     \ elf                                          select-linux  riscv32-elf                                       minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  471 473 thru ;                                  : target-configuration                                            474 load      \ linux                                           s" riscv" tcreate                                               s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-riscv-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/RISC-V (64 bit)                                                                              .( configuration is Linux/RISC-V-64 )                                                                                           8 wordsize                                                      little                                                          create target-little-endian                                     create target-riscv                                             create target-linux                                             create target-unicode                                           create target-openat                                            330 334 thru     \ elf                                          select-linux  riscv64-elf                                       minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  471 473 thru ;                                  : target-configuration                                            474 load      \ linux                                           s" riscv" tcreate                                               s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-riscv64-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/ARM-Cortex                                                                                   .( configuration is Linux/ARM-Cortex )                                                                                          4 wordsize                                                      little                                                          create target-little-endian                                     create target-cortex                                            create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux  arm-elf                                           minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  451 454 thru ;                                  : target-configuration                                            455 load      \ linux                                           s" arm" tcreate                                                 s" little-endian" tcreate                                       s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-cortex-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Meta compiler 12                                                                                                              \ Platform configuration for Linux/m68k (coldfire)                                                                              .( configuration is Linux/m68k )                                                                                                4 wordsize                                                      big                                                             create target-big-endian                                        create target-m68k                                              create target-linux                                             create target-unicode                                           330 334 thru     \ elf                                          select-linux  m68k-elf                                          minkernel elfaligned kernelsize !                               elfbaseaddr constant baseaddr                                   : load-generic  491 493 thru ;                                  : target-configuration                                            494 load      \ linux                                           s" m68k" tcreate                                                s" big-endian" tcreate                                          s" unicode" tcreate                                             s" elf" tcreate ;                                             : load-startup  190 load ;                                      : output-filename  ( -- a u ) s" ff-m68k-linux" ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ Architectures 13 - i386 380                                                                                                   \ Signal handlers                                                                                                               .( sig-i386/Linux )                                                                                                             67 constant sys_sigaction       119 constant sys_sigreturn                                                                      h# 04000000 constant SA_RESTORER                                                                                                begin-structure /sigaction                                        field: sa.handler     field: sa.sigaction     field: sa.mask    field: sa.flags       field: sa.restorer                      end-structure                                                                                                                   /sigaction buffer: sabuf                                                                                                        code (sighandler)                                                 signals # ebx mov,                                              h# 8B db,   h# 44 db,  h# 24 db,  h# 04 db, \ 4 [esp] eax mov,  2 # ecx mov,                                                    eax shl,                                                        eax ebx add,                                                    1 # 0 [ebx] mov,                                                ret,                                                          end-code                                                                                                                        code sigreturn                                                    sys_sigreturn # eax mov,                                        h# 80 # int,                                                  end-code                                                                                                                        sabuf sa.mask off       SA_RESTORER sabuf sa.flags !            ' sigreturn cell+ sabuf sa.restorer !                           ' (sighandler) cell+ constant sighandler                        : sigaction  sabuf 0 sys_sigaction syscall3 ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ Signal handlers                                                                                                               .( sig-x86_64/Linux )                                                                                                           13 constant sys_rt_sigaction       15 constant sys_sigreturn                                                                    h# 04000000 constant SA_RESTORER                                                                                                begin-structure /sigaction                                        field: sa.handler     field: sa.flags                           field: sa.restorer    field: sa.mask                          end-structure                                                                                                                   /sigaction buffer: sabuf                                                                                                        : w32,  ( u -- ) dup c,  dup 8 rshift c,  dup 16 rshift c,        24 rshift c, ;                                                : w64,  ( u -- ) dup w32,  32 rshift w32, ;                                                                                     hex                                                                                                                             create sighandler                                                 48 c, 0bb c, signals w64,          \ mov rbx, signals           48 c, c1 c, e7 c, 03 c,            \ shl rdi, 3                 48 c, b8 c, 1 w64,                 \ mov rax, 1                 48 c, 89 c, 04 c, 3b c,            \ mov [rbx + rdi], rax       c3 c,                              \ ret                                                                                      create sigreturn                                                  48 c, b8 c, sys_sigreturn w64,     \ mov rax, sys_sigreturn     0f c, 05 c,                        \ syscall                                                                                  decimal                                                                                                                         sabuf sa.mask off       SA_RESTORER sabuf sa.flags !            sigreturn sabuf sa.restorer !                                   8 constant /ksa                                                                                                                 : sigaction  ( sig -- )                                           sabuf  0  /ksa  sys_rt_sigaction syscall4 ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                \ Architectures 13 - arm 400                                                                                                    \ Signal handlers (ARM, little endian, 32 bits)                                                                                 .( sig-ARM/Linux )                                                                                                              174 constant sys_rt_sigaction       119 constant sys_sigreturn                                                                  h# 04000000 constant SA_RESTORER                                                                                                begin-structure /sigaction                                        field: sa.handler     field: sa.flags                           field: sa.restorer    field: sa.mask1    field: sa.mask2      end-structure                                                                                                                   /sigaction buffer: sabuf                                                                                                        hex                                                                                                                             create sighandler                                                 e1a00100 ,               \ lsl r0, r0, #2                       e59f100c ,               \ ldr r1, [pc, #12]                    e0810000 ,               \ add r0, r1, r0                       e3a02001 ,               \ mov r2, #1                           e5802000 ,               \ str r2, [r0]                         e1a0f00e ,               \ mov pc, lr                           signals ,                                                                                                                     create sigreturn                                                  e3a07000 sys_sigreturn or ,    \ mov r7, sys_sigreturn          ef000000 ,                     \ swi #0                                                                                       decimal                                                                                                                         sabuf sa.mask1 off      sabuf sa.mask2 off                      SA_RESTORER sabuf sa.flags !                                    sigreturn sabuf sa.restorer !                                                                                                   8 constant /ksa                                                                                                                 : sigaction  ( sig -- )                                           sabuf  0  /ksa  sys_rt_sigaction syscall4 ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Architectures 13 - x86_64 420                                                                                                 \ Signal handlers                                                                                                               .( sig-x86_64/BSD )                                                                                                             46 constant sys_sigaction                                                                                                       begin-structure /sigaction                                        field: sa.handler     field: sa.mask/flags                    end-structure                                                                                                                   /sigaction buffer: sabuf                                                                                                        : w32,  ( u -- ) dup c,  dup 8 rshift c,  dup 16 rshift c,        24 rshift c, ;                                                : w64,  ( u -- ) dup w32,  32 rshift w32, ;                                                                                     : pagealign  here dup 8191 + 8191 invert and swap - allot ;                                                                     pagealign                                                       hex                                                                                                                             create sighandler                                                 48 c, 0bb c, signals w64,          \ mov rbx, signals           48 c, c1 c, e7 c, 03 c,            \ shl rdi, 3                 48 c, b8 c, 1 w64,                 \ mov rax, 1                 48 c, 89 c, 04 c, 3b c,            \ mov [rbx + rdi], rax       c3 c,                              \ ret                      create sighandler_end                                                                                                           pagealign                                                       decimal                                                                                                                         sabuf sa.mask/flags off                                                                                                         : sigaction  ( sig -- ) sabuf  0  sys_sigaction syscall3          ?fcheck ;                                                                                                                     [defined] openbsd  [if]                                         74 constant sys_mprotect        4 constant PROT_EXEC            : mprotect  ( a u prot -- ) sys_mprotect syscall3 ?fcheck ;                                                                     : sigprepare                                                      sighandler  sighandler_end over -  PROT_EXEC PROT_READ          or mprotect ;                                                 [then]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Platform specific code 13 - SH4 495                                                                                           \ Linux system call numbers and other constants                                                                                 3 constant sys_read                                             4 constant sys_write                                            1 constant sys_exit                                             5 constant sys_open                                             6 constant sys_close                                            10 constant sys_unlink                                          19 constant sys_lseek                                           162 constant sys_nanosleep                                      192 constant sys_mmap2                                          91 constant sys_munmap                                          108 constant sys_fstat                                          2 constant sys_fork                                             11 constant sys_execve                                          114 constant sys_wait4                                          144 constant sys_msync                                          1 512 or 64 or constant w/o  \ O_WRONLY | O_TRUNC | O_CREAT     0 constant r/o  \ O_RDONLY                                      2 constant r/w  \ O_RDWR                                        1 1024 or 64 or constant a/o   \ O_WRONLY | O_APPEND | O_CREAT  2 1024 or constant r/a  \ O_RDWR | O_APPEND                     20 constant stat>size                                           420 ( 644 ) constant OPEN_MODE                                  493 ( 755 ) constant OPENX_MODE                                 512 constant O_TRUNC                                            4 constant MS_SYNC                                                                                                              350 load   \ unix                                               create linux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13                                                                                                     \ PC standalone support code                                                                                                    Startup code / Loader                           561             VGA text mode driver                            562             PC keyboard driver                              563 - 564       IDT + interrupt handling                        565             PC scancode handling (de)                       566 - 567                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ simple core Forth REPL on bare metal PC                                                                                       562 565 thru \ vgatext ps2kb irq                                                                                                : (halt)  cr ." <halt>" cr  begin  pause  again ;               ' (halt) is halt                                                : greeting                                                        ." ff version " version .  cr  unused . ." bytes free" cr       cr ." have a nice day." cr ;                                  : boot                                                            clear  h @ h0 !  dp @ dp0 !  dp current !  warnings on          greeting  setupidt                                              0 maskirq                                                       ['] isr1 1 irq isrinstall         \ keyboard                    sti  cold ;                                                                                                                                                                                                                                                   \s                                                                                                                              To build and run:                                                                                                               ff <<EOF                                                        346 load                                                        make-i386-bare-pc                                               bye                                                             EOF                                                                                                                             mkdir -p iso/boot/grub                                          cp ff.bin iso/boot                                              cat > iso/boot/grub/grub.cfg <<EOF                              menuentry "ff" {                                                  multiboot /boot/ff.bin                                        }                                                               EOF                                                                                                                             grub-mkrescue -o ff.iso iso                                     qemu-system-i386 -cdrom ff.iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ VGA text output                                                                                                               h# b8000 constant screen                                        80 constant columns         25 constant rows                    variable row                variable col                        h# 3d4 constant crt1        h# 3d5 constant crt2                rows 1- columns 2* * constant lastoff                                                                                           : cursor                                                          14 crt1 portc!  row @ columns * col @ + dup 8 rshift crt2       portc!  15 crt1 portc!  crt2 portc! ;                         : scraddr  ( -- a ) row @ columns 2* * col @ 2* + screen + ;    : scroll  screen columns 2* + screen lastoff cmove                lastoff screen +  columns 0  do  bl over c!  2 +  loop          drop ;                                                        : ?scroll  row @ rows < 0=  if  scroll  rows 1- row !  then ;   : ?newline                                                        col @ columns < 0=  if  1 row +!  col off  ?scroll  then ;    : putchar  ( c -- )                                               case                                                              10  of  col off  1 row +!  ?scroll  endof                       dup  scraddr c!  1 col +!  ?newline                           endcase  cursor ;                                             : (conwrite)  ( channel a u -- )                                  ?dup 0=  if  2drop  exit  then                                  0  do  count putchar  loop  2drop ;                                                                                           ' (conwrite) is conwrite                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ PC keyboard driver #1                                                                                                         \ requires: vgatxt (echoing)                                    variable keystate       variable keyinaddr                      1 constant SHIFT    2 constant CTRL     4 constant ALT          defer escape        defer backspace     defer tab               defer enter         defer capslock      defer shift             defer alt           defer control       defer function          defer ins           defer del           defer home              defer end           defer pageup        defer pagedown          defer up            defer left          defer right             defer down                                                      defer mouse                                                     : eatkey  ( sc f -- 0 0 ) 2drop 0 0 ;                           : inputchar  ( sc f c -- c 1|0 )                                  swap  if  nip  dup putchar  dup keyinaddr @ c!  1               else  eatkey  then ;                                          : toggle  ( sc f u1 -- 0 0 )                                      >r  keystate @ over  if  r> or  else  r> invert and  then       keystate !  eatkey ;                                          \ ( sc f -- c 1|0 )                                             : (escape)  0 halt ;                                            : (shift)  SHIFT toggle ;                                       : (control)  CTRL toggle ;                                      : (alt)  ALT toggle ;                                           : (enter)  10 inputchar ;                                       ' (escape) is escape    ' (control) is control                  ' (alt) is alt          ' (shift) is shift                      ' eatkey is up     ' eatkey is down     ' eatkey is left        ' eatkey is right  ' eatkey is pageup   ' eatkey is pagedown    ' eatkey is ins    ' eatkey is del      ' eatkey is home        ' eatkey is end    ' eatkey is function ' eatkey is tab         ' eatkey is backspace       ' (enter) is enter                  : (mouse) ;     ' (mouse) is mouse                              create keymap                                                   \ XXX no way to select keyboard, yet                                                                                            566 567 thru  \ pckeys_de                                                                                                       hex                                                             60 constant ps2data      64 constant ps2status                  20 constant mousebit                                            : getscan  ( -- u )                                               begin  ps2status portc@ dup 1 and  if                             mousebit and  if  mouse  else                                     ps2data portc@  exit  then                                    else  drop  then                                                pause                                                         again ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ PC keyboard driver #2 (end)                                                                                                   : up/down  ( sc -- sc f )                                         dup 80 and  if  7f and  false  else  true  then ;             : e0key  ( -- c 1|0 )                                             getscan up/down over  case                                        1d  of  control  endof                                          38  of  alt  endof                                              47  of  home  endof                                             48  of  up  endof                                               49  of  pageup  endof                                           4b  of  left  endof                                             4d  of  right  endof                                            4f  of  end  endof                                              50  of  down  endof                                             51  of  pagedown  endof                                         52  of  ins  endof                                              53  of  del  endof                                              drop 0 0 rot \ otherwise dropped                              endcase ;                                                     : handlekey  ( sc f a i -- c 1|0 )                                cells + @ dup 0=  if  drop  eatkey  exit  then                  dup 4000 <  if  inputchar  exit  then                           execute ;                                                     : handlestate  ( sc f a -- c 1|0 )  \ no combinations, use first  keystate @ CTRL and  if  3 handlekey  exit  then                keystate @ ALT and  if  2 handlekey  exit  then                 keystate @ SHIFT and  if  1 handlekey  exit  then               0 handlekey ;                                                 : decodekey  ( sc -- c 1|0 )                                      up/down  over #keymap u< 0=  if  eatkey  else                     over 4 * cells keymap +  handlestate  then ;                : (conread)  ( channel a -- c 1|0 )                               keyinaddr !  drop  begin                                          getscan dup e0 =  if                                            drop e0key  else  decodekey  then                             0= while  drop  repeat  1 ;                                   decimal                                                         ' (conread) is conread                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ IDT setup and interrupt handling                                                                                              48 8 * buffer: idt                                              create idt_desc 127 c, 1 c, ( 48 * 8 - 1 = 383 ) idt ,          16 constant cs:sel     \ set up by GRUB2                        64 constant pit_ch0    33 constant pic1_data                    67 constant pit_ctrl   161 constant pic2_data                   54 constant pit_rep                                             1193180 constant pit_freq                                                                                                       : irq  ( u1 -- u2) 8 + ;                                        : isrinstall  ( xt i -- )                                         8 * idt + dup 5 + 142 swap c! \ flags (0x8e)                    cs:sel over 2 + c!    \ low byte of selector                    swap @ dup >r over c!   \ fetch codeptr from cfa                r@ 8 rshift over 1+ c!                                          r@ 16 rshift over 6 + c!                                        r> 24 rshift swap 7 + c! ;                                    : setupidt  idt_desc lidt                                         ['] isr1 7 irq isrinstall ;     \ LPT, spurious interrupt     : maskirq  ( u -- )                                               dup 8 <  if  pic1_data  else  8 -  pic2_data  then              dup portc@  rot 1 swap lshift or swap portc! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - PC standalone support code 560                                                                    \ PC scancode table (de) #1                                     \                                                               \ loaded by ps2kb 563                                           \ entries, indexed by scancode: [normal shift altgr ctrl]       \ were each entry is either 0, an alternative charcode or an xt \ xt: ( scancode up/down -- )                                   0 , 0 , 0 , 0 ,                    \ 00                         ' escape , 0 , 0 , 0 ,             \ 01                         char 1 , char ! , 0 , 0 ,          \ 02                         char 2 , char " , 0 , 0 ,          \ 03                         char 3 , 21 , 0 , 0 ,              \ 04                         char 4 , char $ , 0 , 0 ,          \ 05                         char 5 , char % , 0 , 0 ,          \ 06                         char 6 , char & , 0 , 0 ,          \ 07                         char 7 , char / , char { , 0 ,     \ 08                         char 8 , char ( , char [ , 0 ,     \ 09                         char 9 , char ) , char ] , 0 ,     \ 0a                         char 0 , char = , char } , 0 ,     \ 0b                         225 , char ? , char \ , 0 ,        \ 0c                         char ` , 0 , 0 , 0 ,               \ 0d                         ' backspace , 0 , 0 , 0 ,          \ 0e                         ' tab , 0 , 0 , 0 ,                \ 0f                         char q , char Q , char @ , 0 ,     \ 10                         char w , char Q , 0 , 0 ,          \ 11                         char e , char E , 0 , 0 ,          \ 12                         char r , char R , 0 , 0 ,          \ 13                         char t , char T , 0 , 0 ,          \ 14                         char z , char Z , 0 , 0 ,          \ 15                         char u , char U , 0 , 0 ,          \ 16                         char i , char I , 0 , 0 ,          \ 17                         char o , char O , 0 , 0 ,          \ 18                         char p , char P , 0 , 0 ,          \ 19                         129 , 154 , 0 , 0 ,                \ 1a                         char + , char * , char ~ , 0 ,     \ 1b                         ' enter , 0 , 0 , 0 ,              \ 1c                         ' control , 0 , 0 , ' control ,    \ 1d                         char a , char A , 0 , 0 ,          \ 1e                         char s , char S , 0 , 0 ,          \ 1f                         char d , char D , 0 , 0 ,          \ 20                         char f , char F , 0 , 0 ,          \ 21                         char g , char G , 0 , 0 ,          \ 22                         char h , char H , 0 , 0 ,          \ 23                         char j , char J , 0 , 0 ,          \ 24                         char k , char K , 0 , 0 ,          \ 25                         char l , char L , 0 , 0 ,          \ 26                         148 , 153 , 0 , 0 ,                \ 27                         132 , 142 , 0 , 0 ,                \ 28                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - PC standalone support code 560                                                                    \ PC scancode table (de) #2 (end)                                                                                               char ^ , 0 , 0 , 0 ,               \ 29                         ' shift , ' shift , 0 , 0 ,        \ 2a                         char # , char ' , 0 , 0 ,          \ 2b                         char y , char Y , 0 , 0 ,          \ 2c                         char x , char X , 0 , 0 ,          \ 2d                         char c , char C , 0 , 0 ,          \ 2e                         char v , char V , 0 , 0 ,          \ 2f                         char b , char B , 0 , 0 ,          \ 30                         char n , char N , 0 , 0 ,          \ 31                         char m , char M , 0 , 0 ,          \ 32                         char , , char ; , 0 , 0 ,          \ 33                         char . , char : , 0 , 0 ,          \ 34                         char - , char _ , 0 , 0 ,          \ 35                         ' shift , ' shift , 0 , 0 ,        \ 36                         0 , 0 , 0 , 0 ,                    \ 37                         ' alt , 0 , ' alt , 0 ,            \ 38                         bl , 0 , 0 , 0 ,                   \ 39                         ' capslock , 0 , 0 , 0 ,           \ 3a                         ' function , 0 , 0 , 0 ,           \ 3b                         ' function , 0 , 0 , 0 ,           \ 3c                         ' function , 0 , 0 , 0 ,           \ 3d                         ' function , 0 , 0 , 0 ,           \ 3e                         ' function , 0 , 0 , 0 ,           \ 3f                         ' function , 0 , 0 , 0 ,           \ 40                         ' function , 0 , 0 , 0 ,           \ 41                         ' function , 0 , 0 , 0 ,           \ 42                         ' function , 0 , 0 , 0 ,           \ 43                         ' function , 0 , 0 , 0 ,           \ 44                         0 , 0 , 0 , 0 ,                    \ 45                         0 , 0 , 0 , 0 ,                    \ 46                         0 , 0 , 0 , 0 ,                    \ 47                         0 , 0 , 0 , 0 ,                    \ 48                         0 , 0 , 0 , 0 ,                    \ 49                         0 , 0 , 0 , 0 ,                    \ 4a                         0 , 0 , 0 , 0 ,                    \ 4b                         0 , 0 , 0 , 0 ,                    \ 4c                         0 , 0 , 0 , 0 ,                    \ 4d                         0 , 0 , 0 , 0 ,                    \ 4e                         0 , 0 , 0 , 0 ,                    \ 4f                         0 , 0 , 0 , 0 ,                    \ 50                         0 , 0 , 0 , 0 ,                    \ 51                         0 , 0 , 0 , 0 ,                    \ 52                         0 , 0 , 0 , 0 ,                    \ 53                         0 , 0 , 0 , 0 ,                    \ 54                         0 , 0 , 0 , 0 ,                    \ 55                         char < , char > , char | , 0 ,     \ 56                         h# 57 constant #keymap                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13                                                                                                     \ Raspberry/PI standalone support code                                                                                          Startup code                                    571             UART driver                                     572 - 573                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Snarf Cut Paste Exit Look Back Next Prev Back 0          \ Platform specific code 13 - Raspberry/PI standalone 570                                                                                                                                       \ simple core Forth REPL on bare metal Raspberry/PI (2)                                                                         572 573 thru    \ uart driver                                                                                                   : (halt)  cr ." <halt>" cr  begin  pause  again ;               ' (halt) is halt                                                : greeting                                                        ." ff version " version .  cr  unused . ." bytes free" cr       cr ;                                                          : boot                                                            clear  h @ h0 !  dp @ dp0 !  dp current !  warnings on          uartinit  greeting  cold ;                                                                                                                                                                                                                                    \s                                                                                                                              to build and run:                                                                                                               ff <<EOF                                                        346 load                                                        make-arm-bare-rpi                                               bye                                                             EOF                                                                                                                             qemu-system-arm -m 256 -M raspi2 -nographic -kernel ffarm.elf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - Raspberry/PI standalone 570                                                                       \ UART access for Raspberry/PI (2) #1                                                                                           \ taken from: http://wiki.osdev.org/Raspberry_Pi_Bare_Bones     hex                                                             \ The GPIO registers base address.                              3F200000 constant GPIO_BASE \ for raspi2&3, 0x20200000 for rpi1 \ The offsets for each register.                                \ Controls actuation of pull up/down to ALL GPIO pins.          GPIO_BASE 94 + constant GPPUD                                   \ Controls actuation of pull up/down for specific GPIO pin.     GPIO_BASE 98 + constant GPPUDCLK0                               \ The base address for UART.                                    3F201000 constant UART0_BASE \ for rpi2&3, 0x20201000 for rpi1                                                                  \ The offsets for reach register for the UART.                  UART0_BASE 00 + constant UART0_DR                               UART0_BASE 18 + constant UART0_FR                               UART0_BASE 24 + constant UART0_IBRD                             UART0_BASE 28 + constant UART0_FBRD                             UART0_BASE 2C + constant UART0_LCRH                             UART0_BASE 30 + constant UART0_CR                               UART0_BASE 38 + constant UART0_IMSC                             UART0_BASE 44 + constant UART0_ICR                              10 constant RXFE        20 constant TXFF                        : delay  ( u -- ) 0 do loop ;                                   : uartinit                                                        UART0_CR off \    Disable UART0.                                \ Setup the GPIO pin 14 && 15.                                  GPPUD off \ Disable pull up/down for all GPIO pins & delay for \ 150 cycles.                                                    96 delay                                                        c000 GPPUDCLK0 ! \ Disable pull up/down for pin 14,15 & delay  \ for 150 cycles.                                                96 delay                                                        GPPUDCLK0 off \ Write 0 to GPPUDCLK0 to make it take effect.    7ff UART0_ICR ! \ Clear pending interrupts.                     \ Set integer & fractional part of baud rate.                   \ Divider = UART_CLOCK/(16 * Baud)                              \ Fraction part register = (Fractional part * 64) + 0.5         \ UART_CLOCK = 3000000; Baud = 115200.                          \ Divider = 3000000 / (16 * 115200) = 1.627 = ~1.               1 UART0_IBRD !                                                  \ Fractional part register = (.627 * 64) + 0.5 = 40.6 = ~40.    28 UART0_FBRD !                                                 77 UART0_LCRH ! \ Enable FIFO & 8 bit data transmissio (1      \ stop, no parity).                                              7f2 UART0_IMSC ! \  Mask all interrupts.                        301 UART0_CR ! ; \ Enable UART0, receive & transfer part of    \ UART.                                                                                                                        decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ Platform specific code 13 - Raspberry/PI standalone 570                                                                       \ UART access for Raspberry/PI (2) #1                                                                                           : uartout  ( a u -- )                                             ?dup 0=  if  drop  exit  then                                   0  do  begin  UART0_FR @ TXFF and 0=  until                       count UART0_DR !                                              loop  drop ;                                                  : uartin  ( -- c )                                                begin  UART0_FR @ RXFE and 0=  until  UART0_DR @ ;            : (conread)  ( channel a -- c 1|0 )                               uartin dup >r swap c!  drop  r> 1 ;                           : (conwrite)  ( channel a u -- ) uartout  drop ;                ' (conread) is conread      ' (conwrite) is conwrite                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back           \ Platform specific code 13                                                                                                     \ Sparc LEON / GRIP support code                                                                                                Startup code                                    581             UART driver                                     582                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Platform specific code 13 - Sparc LEON / GRIP 580                                                                             \ Startup code for Sparc/Leon3 + GRIP                                                                                           582 load \ leonuart                                                                                                             : (halt)  cr ." <halt>" cr  begin  pause  again ;               ' (halt) is halt                                                : greeting                                                        ." ff version " version .  cr  unused . ." bytes free" cr ;   : boot                                                            clear  h @ h0 !  dp @ dp0 !  dp current !  warnings on          greeting  cold ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back           \ Platform specific code 13 - Sparc LEON / GRIP 580                                                                             \ UART access for LEON experimental board                                                                                       hex                                                                                                                             80000100 constant UART_REG                                                                                                      1 constant UART_ST_DR       200 constant UART_ST_TF             1 constant UART_CR_RE       2 constant UART_CR_TE                                                                               : uart_reg  ( n -- a ) 4 * UART_REG + ;                         : uart_data  0 uart_reg ;   : uart_status  1 uart_reg ;         : uart_ctrl  2 uart_reg ;   : uart_scaler  3 uart_reg ;         : uart_tf  ( -- f ) uart_status @ UART_ST_TF and ;              : uart_dr  ( -- f ) uart_status @ UART_ST_DR and ;                                                                              : uartout  ( a u -- )                                             ?dup 0=  if  drop  exit  then                                   UART_CR_RE UART_CR_TE or uart_data !  40 uart_scaler !          0  do  begin  uart_tf 0 =  until                                   dup c@ swap 1 + swap uart_data !                             loop  drop ;                                                                                                                  : uartin  ( -- c )                                                UART_CR_RE UART_CR_TE or uart_data !  40 uart_scaler !          begin  uart_dr  until  uart_data @ ;                                                                                          : (conread)  ( channel a -- c 1|0 )                               uartin dup >r swap c!  drop  r> 1 ;                                                                                           : (conwrite)  ( channel a u -- ) uartout  drop ;                                                                                ' (conread) is conread      ' (conwrite) is conwrite                                                                            decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0    tcell   \ "ff" sources :#10 - Assemblers :#364                                                                                          \ x86-assembler - #1                                                                                                            .( x86-asm )                                                                                                                    \ found at: ftp://ccreweb.org/software/kforth/examples/asm-x86.4 \ th                                                           \ asm-x86.4th -- ans forth assembler (postfix)                  \                                                               \ 32/16-bit assembler for x86 processors                        \                                                               \ original notes --------------------------------------------   \                                                               \ designed to compile the forth-os from any ans forth compiler. \ by thomas novelli, 1999-2000                                  \                                                               \ based on the 16-bit assembler from pygmy forth, by frank serge \ ant.                                                         \ http://pygmy.utoh.org                                         \                                                               \ floating point instructions adapted from gforth's 386/asm.fs  \   by bernd paysan.                                            \                                                               \ asm-x86 is released under the mit/bsd license, in accordance  \   with the preference of its original author, frank sergeant. \                                                               \                                                               \                                                               \ special notations:                                            \   ta - target address                                         \                                                               \ tbd:                                                          \   ebp@ and esp@ can't be done w/ mod r/m alone; use s-i-b.    \     workaround: use #@ ebp+ instead of ebp@  (same for esp)   \                                                               \ low-priority items:                                           \   incbin                                                      \   mov crx                                                     \   2,3-operand imul                                            \   do more error checking? (wrong number/type of operands, etc) \   support for running under 16-bit forths (use double-cells.. \                                                              \ output options:                                               \                                                               \ 1. assemble to blocks (or blockfiles)                         \ 2. assemble to allocated memory (and save to file)            \ 3. assemble to heap (here) or "code space" with c,            \    prevents some useful things, like macros & named labels    \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #2                                                                                                                                                                            \                                                               \ revisions:                                                    \   2016-12-10  ported to ff, felix                             \   2001-10-23  modified for kforth, krishna myneni             \   2004-10-19  make octal nondeferred word  km                 \   2004-10-20  km began floating pt instruction implementation; \               revisions to kforth interface:                 \                 -- fixed end-code to update stack ptr         \                 -- moved compilation of "ret," to inside of en \ d-code                                                       \   2004-10-21  changed stack ptr to ebx for code words, added f \ p words  km                                                  \   2004-10-22  fixed displacement addressing for fp words km   \   2004-10-26  finished first cut of fp implementation  km     \   2004-10-27  changed asm-reset to set default flags for word/ \ dword                                                        \                 based on mode; added macro: and end-macro; red \ uced                                                         \                 code overhead slightly  km                    \   2006-02-11  removed operations in sized-code which were redu \ ndant or useless;                                            \                 this should reduce code overhead significantly \   km                                                         \   2006-03-02  changed sized-code so that code words generate i \ nline calls and stack fixup,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86 assembler - #3                                                                                                                                                                            \                 which increases efficiency considerably  km   \   2006-03-11  fixed problems with jmp, -- apparently coded on \ assumption of                                                 \                 16-bit mode causing relative jumps to mis-asse \ mble for 32-bit  km                                          \   2006-03-13  modified begin, to return address rather than of \ fset, so its use                                             \                 would be consistent with again, and repeat, ; \                 added do, with behavior of old begin, for use \ with loop, ;                                                  \                 commented out until, and inserted correspondin \ g code in loopx,                                             \                 since until, should correspond to begin, ;  km \  2006-03-14  fixed a problem with order of computation in asm\ to ;                                                          \                 fixed jmp to allow both short and long relativ \ e jumps for 32-bit mode ;                                    \                 added call-code to allow code words to call ot \ her code words ;                                             \                 added mixed integer/fp arithmetic and memory w \ ords (fixx) km                                               \  2007-01-07  modified "<reg>" and "reg": a) in "reg" the e and \  w flag bits are cleared                                     \                 prior to calling "<reg>" so that byte and word \  register operands will                                      \                 assemble properly; b) moved code to set the va \ riable srcsiz which                                          \                 is needed for the movsx, and movsz, instructio \ ns from "<reg>" to                                           \                 "reg" to avoid side effects from change a)  km \  2009-05-24  added fstpt, and fldt, for storing and loading f \ ll width (10 byte) values                                    \                 between the fpu register and memory  km       \  2009-09-26  removed definition of within  km                 \  2009-10-05  re-enable use of wordlists; updated code, end-cod \ e, macro, and end-macro  km                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #4                                                                                                                                                                            \ version specific notes:                                       \                                                               \ 1. output options 1 and 3 are not relevant for the kforth vers \ ion.                                                         \                                                               \ 2. this version may be used in other ans forths with the      \      following compatibility definitions:                     \                                                               \        : a@ @ ;                                               \        : ?allot here swap allot ;                             \                                                               \      a word such as kforth's call, which calls machine code,  \      is also required.                                        \                                                               \ 3. currently, any values placed on top of the stack from a    \      code word get clobbered on return to forth, due to       \      specific implementation of code. however, values may be  \      dropped, or the number of stack items can remain unchange \ d                                                            \      in which case the values may be changed. see asm-x86-test \ .4th                                                         \      for examples.                                                                                                            vocabulary assembler                                            also assembler definitions                                      : char+ 1+ ;    : 2+ 2 + ;                                      : a@ @ ;        : ?allot here swap allot ;                                                                                      hex                                                             : octal 8 base ! ; \ nondeferred                                variable mode  ( 0=16-bit 1=32-bit)                             : use16  0 mode ! ;                                             : use32  1 mode ! ;                                             : tcell ( - n) 2 mode @ lshift ;  ( target cell size, in chars)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0  then                                                                      \ x86-assembler - #5                                                                                                                                                                            variable origin \ start of code (when loaded on target)         variable -org   \ difference                                    variable asm0   \ start of code                                 variable >asm   \ assembly pointer -- w/rt asm0 (starts at 0)   variable output \ 0=memory, 1=blocks                            : $' ( - a  current address w/rt asm0)  >asm @ ;                : $  ( - a  current address w/rt origin)  >asm @  -org @ + ;    : org ( a -)  dup origin !  $' - -org ! ;                       ( assemble to memory -- org = start address, by default)        \ : asm-to ( a -) dup org  asm0 !  0 >asm !  0 output ! ;       : asm-to ( a -) dup asm0 !  0 >asm ! org 0 output ! ;           : mem-db! ( n ta -) asm0 a@ + c! ;                              hex                                                             ( assemble to blocks -- org = 0, by default)                    : asm-block ( start_block -)                                      0a lshift asm0 !  0 org  0 >asm !  1 output ! ;               : block-db! ( n ta -) 2drop ;                                   \  asm0 @ +  400 /mod block  + c!  update ;                     \ db! is the one and only way to output code/data.              \ that way it's easy to "filter" for block output, etc.         : db! ( n ta -)                                                         output @  0= if mem-db! else block-db! then ;           : dw! ( n ta -)                                                         2dup db! char+ swap 8 rshift swap db! ;                 : dd! ( n ta -)                                                         4 0 do  2dup db! char+ swap 8 rshift swap  loop  2drop    ;                                                             : dc! ( n ta -)                                                         tcell 0 do  2dup db! char+ swap 8 rshift swap  loop      2drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #6                                                                                                                                                                            \ data definition words (also used for code generation)         : db,  ( c -) >asm @  swap over db!  char+ >asm ! ;             : dw,  ( x -) dup db, 8 rshift db, ;                            : dd,  ( x -) 4 0 do  dup db, 8 rshift  loop drop ;             : dc,  ( x -) mode @ if dd, else dw, then ;                     \ save memory to file                                           \ : save ( "filename" -)  ( usage: save filename )              \  bl parse ( c-addr u) r/w bin create-file 0<>                 \  if drop ( fid) ." create-file error" cr                      \  else dup asm0 @  $' ( location & size of code)               \    rot write-file  0<> if ." write-file error" cr then        \    close-file  0<> if ." close-file error" cr then            \  then  ;                                                      \ for debugging - show assembly buffer:                         \ tbd: only works w/ memory right now                           \ : show ( -) asm0 @  $'  dump ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #7                                                                                                                                                                            variable disp   \ displacement                                  variable sib    \ -------- ssrrr00i                               \ ss=scale; rrr=index reg; i=index?                           variable flags  \ -------e omiagsdw                               \ m=r/m; i=imm; a=accumulator (al/ax/eax); g=seg;               \ s=imm size (1=short, 0=full size)                             \ w=word or byte; e=dword (extended reg.)                       \ o=disp only; d=direction (1 when r/m field is source)       variable #ops   \ # of operands                                 variable #regs  \ # of register operands                        variable srcsiz \ size of 1st (source) operand; used for movzx, : f-set  ( mask -) flags @ or flags ! ;                         : f-clr  ( mask -) invert flags @ and flags ! ;                 : f-get  ( mask - flags ) flags @ and ;                         : f-flip ( mask -) flags @ xor flags ! ;                        \ set flags                                                     : b-ptr  101 f-clr ;                                            : w-ptr  100 f-clr  1 f-set ;                                   : d-ptr  101 f-set ;                                            : asm-reset  2 flags ! ( d) mode @ if d-ptr else w-ptr then                  0 disp !  0 sib !  0 #regs !  0 #ops ! ;           \ read flags                                                    : byte?  ( - f)  1 f-get 1 xor ;                                : word?  ( - f)  1 f-get ; \ true for both 16-and 32-bit values : dword? ( - f)  100 f-get 0<> negate ;                         : cell?  ( - f)  100 f-get 8 rshift  mode @  xor invert  1 f-get  and ;                                                         : sreg?  ( - f)  8 f-get ;                                      : d? ( - f)  2 f-get ;                                          : s? ( - f)  4 f-get ;                                          : m? ( - f) 40 f-get ;                                          : o? ( - f) 80 f-get ;                                          : imm? ( -f)  20 f-get ;                                        : acc? ( -f)  10 f-get ;                                        : 1reg?  #regs @ 1 = ;                                          : 2regs? ( -f) #regs @ sreg? or  dup 2 =  swap 9 =  or ;                       ( cc=2  or  cc=1 + sreg )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #8                                                                                                                                                                            hex                                                             ( conditionals )                                                : if, ( opcode -- offset ) db,  $' ( origin)  0 db, ( blank) ;  : while, ( a1 opcode -- offset a1) if, swap ;                   : then, ( offset -- ) $' over 1+ - swap db! ;                   : else, ( offset -- offset') eb ( short jmp) db,                        $' over - swap db!  $'  0 db, ;                         : begin, ( -- a ) ( $') $ ;     \ changed for consistency with  \ again, and repeat,  km2006-03-13                              \ : until, ( a opc -) db,  $'  1+ - db, ;                                                                                       ( repeat, and again are defined after jmp, )                    : opc ( opcode -) ( - opcode) <builds 1 ?allot c! does> c@ ;    73 opc cs,                                                      75 opc 0=,                                                      79 opc 0<,                                                      73 opc u<,                                                      e3 opc cxnz,                                                    7d opc <,                                                       7e opc >,                                                       76 opc u>,                                                      71 opc ov,                                                      : do,     ( -- offset )  $' ;                                   : loop,   ( offset -- )  e2 db, $' 1+ - db, ;                   : loopz,  ( offset -- )  e1 db, $' 1+ - db, ;                   : loopnz, ( offset -- )  e0 db, $' 1+ - db, ;                   : far-jmp,  ( seg offset -)  ea db,  dc, dw,  asm-reset ;       hex                                                             : <reg> ( a - n)                                                  1 #ops +!                                                       dup 8 rshift  ( high byte)                                      dup 1 and  1 xor  2 lshift  ( s flag = not of bit 1)            or f-set                                                        ff and ( low byte)  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #9                                                                                                                                                                            : r/m ( n -) ( disp - n)  <builds 1 cells ?allot !                      does> @ <reg> 2 f-clr ( d) swap disp !  ;               \ high byte = flags, low byte=reg                               \  40000=indirect                                               \ 100000=disp only                                              octal                                                           40000 r/m [bx+si]                                               40001 r/m [bx+di]                                               40002 r/m [bp+si]                                               40003 r/m [bp+di]                                               40004 r/m [si]                                                  40005 r/m [di]                                                  40006 r/m [bp]                                                  40007 r/m [bx]                                                  : #@ ( disp - n)  140006 mode @ -                                                 <reg> 2 f-clr ( d) swap disp ! ;              \ base registers: (r/m)                                         40000 r/m eax@                                                  40001 r/m ecx@                                                  40002 r/m edx@                                                  40003 r/m ebx@                                                  40004 r/m esp@                                                  40005 r/m ebp@                                                  40006 r/m esi@                                                  40007 r/m edi@                                                  \ index registers: (s-i-b, r/m=100)                             hex                                                             : idx ( n -) ( - n)  <builds 1 cells ?allot ! does> @                   sib @ 1 and if abort" index reg defined twice!"                 else ff and sib ! then ;                                octal                                                           40001 idx eax+                                                  40011 idx ecx+                                                  40021 idx edx+                                                  40031 idx ebx+                                                  40041 idx esp+                                                  40051 idx ebp+                                                  40061 idx esi+                                                  40071 idx edi+                                                  \ scaling, for the index regs:                                  : 1x  300 invert sib @ and sib ! ;                              : 2x  1x  100 sib @ or sib ! ;                                  : 4x  1x  200 sib @ or sib ! ;                                  : 8x  1x  300 sib @ or sib ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #10                                                                                                                                                                           hex                                                             : reg ( 000a00ew00rrr000 -) ( - 0000000000rrr000)  <builds 1      cells ?allot !                                                  does>                                                             #ops @ 1 = if 101 f-get  srcsiz ! then   \ needed for movsx, \ and movzx,                                                       101 f-clr                                                       @ <reg> 1 #regs +!  2 f-flip ( d)  ;                        octal                                                           \  10000= a (accumulator)                                       \    400= w (word)                                              \ 200400= ew (dword)                                            210400 reg eax                                                  200410 reg ecx                                                  200420 reg edx                                                  200430 reg ebx                                                  200440 reg esp                                                  200450 reg ebp                                                  200460 reg esi                                                  200470 reg edi                                                   10400 reg ax                                                      410 reg cx                                                      420 reg dx                                                      430 reg bx                                                      440 reg sp                                                      450 reg bp                                                      460 reg si                                                      470 reg di                                                    10000 reg al                                                       10 reg cl                                                       20 reg dl                                                       30 reg bl                                                       40 reg ah                                                       50 reg ch                                                       60 reg dh                                                       70 reg bh                                                   : seg ( n -) ( -n)  <builds 1 cells ?allot ! does> @ <reg> 2      f-set ( d) ;                                                  4400 seg es                                                     4410 seg cs                                                     4420 seg ss                                                     4430 seg ds                                                     4440 seg fs                                                     4450 seg gs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #11                                                                                                                                                                           \ debugging routine: .f (show flags, etc.)                      hex                                                             create f$ 8 ?allot                                              char o over c! 1+                                               char m over c! 1+                                               char i over c! 1+                                               char a over c! 1+                                               char g over c! 1+                                               char s over c! 1+                                               char d over c! 1+                                               char w swap c!                                                  : 2^  ( n - 2^n)  1 swap lshift ;                               : .f ( -)                                                         base @ hex                                                      dword? if [char] e else [char] - then emit 20 emit              80  8 0 do  dup f-get  if f$ i + c@  else [char] -  then                   emit 1 rshift loop drop                              #regs @ 3 u.r  ."  regs  "                                      1  sib @ 6 rshift  lshift  1 u.r  ." x  disp=" disp @ u.        base !  cr ;                                                  : r>m ( reg - r/m)  3 rshift ;                                  : short? ( n - f)  -80 80 within ;                              : # ( n1 - n1) 20 over short? 04 and or f-set ;                   \ clears all flags except i and (if short) s                  : orw  ( --opc---  -  --opc--w )  1 f-get  or ;                 : ordw ( --opc---  -  --opc-dw )  3 f-get  or ;                 \ generate mod r/m byte, and s-i-b byte if needed               : mod, ( md***rrr -)                                              sib @ if dup f8 and 4 or db,  7 and sib @ or db,                else db,  then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #12                                                                                                                                                                           \ generates mod r/m byte, s-i-b byte, displacement              : moddisp, ( 00***r/m -)                                          m? if                                                             o? if ( disp only)                                                mod, disp @ dc,                                               else                                                              sreg? disp @ or  over 7 and 6 = or ( [bp])                      if                                                                 disp @ swap over                                                short? if 40 or mod, db,  else 80 or mod, dc,  then          else ( zero & not seg) mod, then                              then                                                          else ( 11***reg) c0 or db,  then ;                            : ,imm ( n -)                                                     5 f-get 4 = if ( s,-w) db,                                                  else  dword? if dd, else dw, then  then ;         \ prefix instructions                                           octal                                                           : pfx <builds 1 ?allot c! does> c@ db, ;                         46 pfx es:                                                      56 pfx cs:                                                      66 pfx ss:                                                      76 pfx ds:                                                     144 pfx fs:                                                     145 pfx gs:     ( 386+)                                         146 pfx opsiz:                                                  147 pfx adrsiz: ( 386+)                                         362 pfx repnz                                                   362 pfx repne                                                   363 pfx repz                                                    363 pfx repe                                                    363 pfx rep                                                     \ note: rep* was done differently in pygmy                      ( generate opsiz: prefix if necessary )                         : (opsiz)  byte? 0=  cell? 0=  and  if opsiz: then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #13                                                                                                                                                                           \ one-byte opcodes with no operands                             : m1 ( n -) ( -)  <builds 1 cells ?allot ! does> @ db, asm-reset  ;                                                             octal                                                            47 m1 daa,                                                      57 m1 das,                                                      67 m1 aaa,                                                      77 m1 aas,                                                     324 m1 aam,                                                     325 m1 aad,                                                     220 m1 nop,                                                     230 m1 cbw,                                                     230 m1 cwde,                                                    231 m1 cwd,                                                     140 m1 pushad,                                                  141 m1 popad,                                                   234 m1 pushfd,                                                  235 m1 popfd,                                                   236 m1 sahf,                                                    237 m1 lahf,                                                    303 m1 ret,   \ what about ret ## form?                         313 m1 retf   \ (we shouldn't need it for forth)                311 m1 leave,                                                   314 m1 int3,                                                    316 m1 into,                                                    317 m1 iret,                                                    327 m1 xlat,                                                    360 m1 lock:                                                    364 m1 hlt,                                                     233 m1 wait,                                                    370 m1 clc,                                                     371 m1 stc,                                                     365 m1 cmc,                                                     372 m1 cli,                                                     373 m1 sti,                                                     374 m1 cld,                                                     375 m1 std,                                                     hex                                                             ( alu instructions with 2 operands, like add )                  : m2 ( n -) ( various -)   <builds 1 cells ?allot !               does> (opsiz)  @ >r  imm? if                                      acc? if   drop  r> orw 4 or db,                                      else 1reg? if r>m then  80 orw db,                                   r> 38 and or moddisp,                                      then  ,imm                                               else  2regs?  if swap r>m then                                        r> ordw db, or moddisp,                                   then asm-reset  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #14                                                                                                                                                                           octal                                                           00 m2 add,                                                      10 m2 or,                                                       20 m2 adc,                                                      30 m2 sbb,                                                      40 m2 and,                                                      50 m2 sub,                                                      60 m2 xor,                                                      70 m2 cmp,                                                      hex                                                             : mov, ( r/m/i r/m - )                                            (opsiz)                                                         imm? if                                                           1reg? if   ( imm,reg) r>m b0 or  word? 3 lshift or  db,         else ( imm,r/m) c6 orw db, moddisp,                             then ,imm                                                     else ( reg,r/m)                                                   o? acc? and                                                     if ( disp,acc)                                                    2drop a0  2 f-flip  ordw db,  disp @ dc,                      else                                                              2regs? if ( reg,reg) d? if swap then  r>m  then                 sreg? if ( sreg,r/m) 1 f-clr 8c else ( reg,r/m)  88  then       ordw db,  or moddisp,                                         then                                                          then  asm-reset  ;                                            \ movzx, movsx, -- zero extend / sign extend                    : mx ( n -) ( r/m reg -)                                          <builds 2 ?allot swap over c! 1+ c! does> (opsiz)               srcsiz @ 100 and if abort" attempt to extend a dword" then      dup char+ c@ db,  c@ srcsiz @ or db,                            2regs? if swap r>m then  or moddisp,                            asm-reset ;                                                   hex                                                             0f b6 mx movzx,                                                 0f be mx movsx,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #15                                                                                                                                                                           \ string instructions -- all 1-byte opcodes with w bit          : m3 ( n -) ( reg -)                                                    <builds 1 cells ?allot ! does> (opsiz) @ orw db,          asm-reset ;                                                   octal                                                           246 m3 cmps,                                                    254 m3 lods,                                                    244 m3 movs,                                                    256 m3 scas,                                                    252 m3 stos,                                                    \ mul, div, etc...    xxxxxxxw  mdnnnr/m                        octal                                                           : m4 ( n -) ( -)  <builds 1 cells ?allot !                        does> (opsiz)  @  366 orw db, swap                              1reg? if r>m then or moddisp,  asm-reset ;                    20 m4 com,                                                      40 m4 mul,                                                      60 m4 div,                                                      30 m4 neg,                                                      50 m4 imul,                                                     70 m4 idiv,                                                     \ note: i used not for conditionals, so this alias is okay:     \ 20 m4 not, ( alias for com,)                                  \ lea, lds, les instructions                                    octal                                                           : m5 ( n -) ( -)       \ tbd: fix if broken; add lfs/lgs/lss      <builds 1 ?allot c! does> (opsiz)  c@  db, or moddisp,          asm-reset  ;                                                  215 m5 lea,                                                     304 m5 les,                                                     305 m5 lds,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #16                                                                                                                                                                           \ rotate & shift instructions                                   \ note: to shift by cl, omit first operand                      octal                                                           : m6 ( n -) ( n# r/m | r/m - )  <builds 1 cells ?allot !          does> (opsiz)  @                                                320  imm? if  3 pick 1 <> 20 and xor  else  2 or  then          orw db,                                                         1reg? if swap r>m then or moddisp,                              imm? if  dup 1 <> if db, else drop then  then                   asm-reset  ;                                                  00 m6 rol,                                                      20 m6 rcl,                                                      40 m6 shl,                                                      10 m6 ror,                                                      30 m6 rcr,                                                      50 m6 shr,                                                      70 m6 sar,                                                      \ inc, dec instructions                                         octal                                                           : m7 ( opc -) ( reg | r/m - )  <builds 1 cells ?allot !           does> (opsiz)  @ swap  1reg? if ( opc reg) r>m then             1reg?  word? and  ( full-size register?)                        if ( opc rx)  or 100 or db,                                     else ( opc mem | opc rh | opc rl )                                376 orw db,  or moddisp,                                      then  asm-reset  ;                                            00 m7 inc,                                                      10 m7 dec,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #17                                                                                                                                                                           \ push, pop instructions                                        hex                                                             : m8 ( n -) ( reg | seg | r/m -)  <builds 1 cells ?allot !        does> @  8 ( g) f-get                                           if ( seg opc) over 20 and                                         if   ( sreg3) 0f db,  4 rshift 1 and 1 xor  80 or  or db,       else ( sreg2)         4 rshift 1 and 1 xor   6 or  or db,       then                                                          else 1reg?                                                        if ( reg opc) 2/  8 and  8 xor  50 or  swap r>m or db,          else ( r/m opc) dup 8 rshift  ff and  db,  or moddisp,          then  then  asm-reset  ;                                    ff30 m8 push,                                                   8f00 m8 pop,   \ hex                                            \ 177460 m8 push,  107400 m8 pop, \ octal                       \ in, out instructions                                          octal                                                           : m9 ( n -) ( n# r1 | r1 -)  <builds 1 cells ?allot !             does> @  (opsiz) orw nip                                          imm? if ( n# opc)  db, ( n#) else ( opc) 10 or then db,         asm-reset  ;                                                344 m9 in,                                                      346 m9 out,                                                     \ xchg                                                          hex                                                             : xchg,  ( reg mem | mem reg | reg1 reg2 -)                       (opsiz)                                                         #regs @ 2 =  acc? and  word? and ( ax and another reg)          if  ?dup if nip then ( r1) r>m  90 or db,                       else 2regs? if  r>m  then  or  86 orw db, moddisp,              then  asm-reset  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #18                                                                                                                                                                           \ test -- sim. to add                                           hex                                                             : test,  ( various -)                                             (opsiz)                                                         imm?                                                            if acc? if     drop  a8 orw ( 4 or) db,                                 else   1reg? if r>m then  f6 orw db,                                   ( or)  moddisp,                                          then  ,imm                                              else  2regs?  if swap r>m then                                        84 orw db, or moddisp,                                    then  asm-reset  ;                                            \ int -- usage: 21 int,                                         octal                                                           : int, ( #n -) 315 db, db, asm-reset ;                          \ call                                                          hex                                                             : call, ( various -)  imm?      ( intra-seg direct)               if  ( n#)  $ 1+ tcell + -  ( relative)                            e8 db, dc,   ( usage: 2338 call, )                            else   ( intra-seg indirect: address in reg/mem)                  ( mem | reg -)  1reg?  if r>m then                              ff db,  10 or moddisp, ( usage: 0 [bx] call,  or  dx call, )  then  asm-reset  ;                                            \ jmp                                                           hex                                                             : jmp, ( various -) ( 140) 40  f-get                              \ r or m intra-seg indirect                                     if ( mem | reg -)  1reg?  if r>m then                             ff db,  20 or moddisp,  \ 0 [bx] jmp,   dx jmp,                                        \ 3759 ) jmp,                          else  ( a) $ 1+ tcell + -  ( relative)                            dup short? if tcell + 1- eb db, db, else e9 db, dc, then      then  asm-reset  ;                                            : ljmp, ( a -)  e9 db,  $'  tcell + - dc, ;                     : again, ( a -)  jmp, ;                                         : repeat, ( a a -) again, then, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #19                                                                                                                                                                           \ some 386/486 instructions...                                  octal                                                           : clts,         17 db, 06 db, ;                                 : invd,         17 db, 10 db, ;                                 : wbinvd,       17 db, 11 db, ;                                 : label: ( "name" -) ( - a) <builds $ 1 cells ?allot ! does> a@   ;                                                             : label' ( "name" -) ( - a) <builds $' 1 cells ?allot ! does> a@  ;                                                             : jmp-from ( "name" -) 351 db,  label'  0 dc, ;                 : jmp-to ( a -)                                                   $'  over -  tcell - ( displacement)                             swap dc! ;                                                    hex                                                             : 0fill ( # -  pad out target file w/ 0's)                        ?dup if  0 do 0 db, loop  then ;                              \ pad w/ nops                                                   : align, ( u -)  $  over mod                                      dup if - 0 do  nop,  loop                                       else 2drop then ;                                             \ pad w/ zeroes                                                 : 0align, ( u -)  $  over mod                                     dup if - 0 do  nop,  loop                                       else 2drop then ;                                             \ dpush/dpop pseudo-instructions                                \ use this like: 32 # dpush,  or  edx dpop,                     : dpush, ( r/m -)                                                 83 db, 0ed db, tcell db,  ( tcell # ebp sub,)                   89 db, 45 db, 00 db,    ( eax 0 ebp@ mov,)                      ( r/m) eax mov,  ;                                            : dpop, ( r/m -)                                                  eax  swap ( r/m) mov,                                           tcell # ebp add,  ;                                           : drop,                                                         \  0 ebp@ eax mov,                                                0 #@ ebp+ eax mov,  \ ebp@ workaround                           tcell # ebp add, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #20                                                                                                                                                                           \ floating point instructions                                   \ adapted from gforth 0.6.x 386 assembler by b. paysan, 92--94  \ k. myneni, 2004-10-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #21                                                                                                                                                                           hex                                                             variable fsize                                                  \ : .fs   0 fsize ! ;                                           \ : .fd   2 fsize ! ;                                           \ : .fx   3 fsize ! ;                                           : .fl   4 fsize ! ;                                             \ : .fw   6 fsize ! ;                                           \ : .fq   7 fsize ! ;                                           .fl                                                             : st   ( n -- )  7 and 5c0 or ;                                 : st?  ( reg -- reg flag ) dup 8 rshift 5 - ;                   \ : ?mem ( mem -- mem )  dup c0 < 0= abort" mem expected!" ;    d9 pfx d9,                                                      de pfx de,                                                      : d9: <builds 1 cells ?allot c! does> d9, c@ db, asm-reset ;    : de: <builds 1 cells ?allot c! does> de, c@ db, asm-reset ;    \ some floating point instructions with no operands.            d0 d9: fnop,                                                    e0 d9: fchs,     e1 d9: fabs,                                   e4 d9: ftst,     e5 d9: fxam,                                   e8 d9: fld1,     e9 d9: fldl2t,   ea d9: fldl2e,   eb d9: fldpi, ec d9: fldlg2,   0ed d9: fldln2,   ee d9: fldz,                f0 d9: f2xm1,    f1 d9: fyl2x,    f2 d9: fptan,    f3 d9:        fpatan,                                                        f4 d9: fxtract,  f5 d9: fprem1,   f6 d9: fdecstp,  f7 d9:        fincstp,                                                       f8 d9: fprem,    f9 d9: fyl2xp1,  fa d9: fsqrt,    fb d9:        fsincos,                                                       fc d9: frndint,  fd d9: fscale,   fe d9: fsin,     ff d9: fcos, \ single operand floating point instructions; operand may be a  \   memory address, indirect register reference, or an fpu      \   stack register.                                             : fop:  ( n -- ) <builds 1 cells ?allot c!                                       does> ( reg/mem/st -- ) c@ >r                                     st? 0= if  c7 and r> or d8 db, db,                              else  r> or d8                                                    fsize @ dup 1 and dup 2* + - +                                  db, moddisp,                                                  then  asm-reset ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #22                                                                                                                                                                           octal                                                           ( reg/mem/st -- )                                               00 fop: fadd,    11 fop: fmul,    22 fop: fcom,    33 fop:        fcomp,                                                        44 fop: fsub,    55 fop: fsubr,   66 fop: fdiv,    77 fop:        fdivr,                                                        hex                                                             \ following arithmetic instructions do not use an operand;      \   they operate on st(0) and st(1)                             c1 de: faddp,                                                   c9 de: fmulp,                                                   e9 de: fsubp,    \  ( -- | intel style:  1 = 1 - 0, pop )       e1 de: fsubrp,   \  ( -- | intel style:  1 = 0 - 1, pop )       f9 de: fdivp,    \  ( -- | intel style:  1 = 1 / 0, pop )       f1 de: fdivrp,   \  ( -- | intel style:  1 = 0 / 1, pop )       : fwait,   ( -- | wait for fpu ready)       9b db, ;            : finit,   ( -- | initialize fpu)    fwait, db db, e3 db,         asm-reset ;                                                   : fnclex,  ( -- | clear exceptions)         db db, e2 db,         asm-reset ;                                                   : fclex,   ( -- | clear exceptions w/ wait) fwait, fnclex, ;    : fcompp,  ( -- | compare 0-1, pop both)    de db, d9 db,         asm-reset ;                                                   : fucompp, ( -- | unord. comp, pop both)    da db, e9 db,         asm-reset ;                                                   : fucom,   ( st -- | unord. compare 0 - st)  7 and e0 or dd db,   db, asm-reset ;                                               : ffree,   ( st -- )                        c7 and dd db, db,     asm-reset ;                                                   : fxch,    ( st -- | exchange 0 and st)     c7 and  8 or d9 db,   db, asm-reset ;                                               : fbld,    ( mem -- | load bcd encoded fp)  df db, 20 or           moddisp, asm-reset ;                                         : fbstp,   ( mem -- | save in bcd format)   df db, 30 or          moddisp, asm-reset ;                                          : fsave,   ( mem -- | save fpu state) fwait, dd db, 30 or         moddisp, asm-reset ;                                          : frstor,  ( mem -- | restore fpu state)    dd db, 20 or          moddisp, asm-reset ;                                          : fnstcw,  ( mem -- | save control word )   d9 db, 38 or          moddisp, asm-reset ;                                          : fstcw,   ( mem -- | save control word )   fwait, fnstcw, ;    : fldcw,   ( mem -- | load control word )   d9 db, 2d or          moddisp, asm-reset ;                                          : fnstenv, ( mem -- | save environment )    d9 db, 30 or          moddisp, asm-reset ;                                          : fstenv,  ( mem -- | save environment )    fwait, fnstenv, ;   : fldenv,  ( mem -- | load environment )    d9 db, 20 or          moddisp, asm-reset ;                                          : fnstsw,  ( reg/mem -- | save status word) dup ax = if 20 df                                   else 3d dd then  db, moddisp,     asm-reset ;                                                   : fstsw,   ( reg/mem -- | save status word) fwait, fnstsw, ;                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #23                                                                                                                                                                           : fld,     ( st/mem -- ) st? 0= if    c7 and d9 db, db,                                         else  d9 fsize @ or db, moddisp,                                then  asm-reset ;               : fldt,    ( st/mem10r ) st? 0= if    c7 and d9 db, db,                                         else  db db, 28 or moddisp,                                     then  asm-reset ;               : fst,     ( st/mem -- ) st? 0= if     7 and d0 or dd db, db,                                   else  d9 fsize @ or db, 10 or     moddisp,                                                                                      then  asm-reset ;               : fstp,    ( st/mem -- ) st? 0= if    c7 and dd db, db,                                         else  d9 fsize @ or db, 18 or     moddisp,                                                                                      then  asm-reset ;               : fstpt,    ( st/mem10r -- ) st? 0= if   c7 and dd db, db,                                      else  db db, 38 or moddisp,                                     then  asm-reset ;               : fild,    ( mem4 -- | push, 0 = mem4 )  db db, moddisp,          asm-reset ;                                                   : fist,    ( mem4 -- | mem4 = 0 )        db db, 10 or moddisp,    asm-reset ;                                                   : fistp,   ( mem4 -- | mem4 = 0, pop)    db db, 18 or moddisp,    asm-reset ;                                                   : fidiv,   ( mem4 -- | 0 = 0 / mem4 )    da db, 30 or moddisp,    asm-reset ;                                                   : fidivr,  ( mem4 -- | 0 = mem4 / 0 )    da db, 38 or moddisp,    asm-reset ;                                                   : fimul,   ( mem4 -- | 0 = 0 * mem4 )    da db, 08 or moddisp,    asm-reset ;                                                   : fiadd,   ( mem4 -- | 0 = 0 + mem4 )    da db, moddisp,          asm-reset ;                                                   : fisub,   ( mem4 -- | 0 = 0 - mem4 )    da db, 20 or moddisp,    asm-reset ;                                                   : fisubr,  ( mem4 -- | 0 = mem4 - 0 )    da db, 28 or moddisp,    asm-reset ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0                                                                            \ x86-assembler - #24 (end)                                                                                                                                                                     \ k. myneni's extensions, 2001-10-23                            : [ebp] ( n -- m) dup 0= if #@ ebp+ else ebp@ then ; \ ebp@ work \ around                                                       : [esp] ( n -- m) #@ esp+ ;     \  "   "                        : [eax] ( n -- m) eax@ ;                                        : [ebx] ( n -- m) ebx@ ;                                        : [ecx] ( n -- m) ecx@ ;                                        : [edx] ( n -- m) edx@ ;                                        : [esi] ( n -- m) esi@ ;                                        : [edi] ( n -- m) edi@ ;                                        \ interface                                                     asm-reset                                                       use32                                                           decimal                                                         create (next)  here asm-to                                        0 [esi] edi mov,                                                4 # esi add,                                                    0 [edi] ebx mov,                                                hex ff db, e3 db, decimal \ "ebx jmp," produces wrong code     \ (bug?)                                                         >asm @ allot                                                  : next,  (next) # jmp, ;                                                                                                        previous                                                        previous                                                        forth definitions                                                                                                               also assembler                                                  : code  ( | name -- )                                             create  here dup 1 cells - ! ( cfa -- paramfield )              here asm-to  asm-reset  also assembler ;                      : end-code  >asm @ allot  previous ;                            previous                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Assemblers 364                                                                                              \ arm-assembler - #1                                                                                                            .( arm-asm )                                                                                                                    \                                                               \ this program is distributed under the terms of the 'mit licens \ e'. the text                                                 \ of this licence follows...                                    \                                                               \ copyright (c) 2005 j.d.medhurst (a.k.a. tixy)                 \                                                               \ permission is hereby granted, free of charge, to any person ob \ taining a copy                                               \ of this software and associated documentation files (the "soft \ ware"), to deal                                              \ in the software without restriction, including without limitat \ ion the rights                                               \ to use, copy, modify, merge, publish, distribute, sublicense,  \ and/or sell                                                  \ copies of the software, and to permit persons to whom the soft \ ware is                                                      \ furnished to do so, subject to the following conditions:      \                                                               \ the above copyright notice and this permission notice shall be \ included in                                                  \ all copies or substantial portions of the software.           \                                                               \ the software is provided "as is", without warranty of any kind \ , express or                                                 \ implied, including but not limited to the warranties of mercha \ ntability,                                                   \ fitness for a particular purpose and noninfringement.  in no e \ vent shall the                                               \ authors or copyright holders be liable for any claim, damages  \ or other                                                     \ liability, whether in an action of contract, tort or otherwise \ , arising from,                                              \ out of or in connection with the software or the use or other  \ dealings in                                                  \ the software.                                                 \                                                               \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0   appro    \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #2                                                                                                                                                                            \ requirements and dependencies                                 \                                                               \ this code requires ans wordsets: core, core-ext, search-order  \ and                                                          \ search-order-ext. it also uses the non-standard word vocabular \ y.                                                           \                                                               \ the code is dependent on the size of a cell being at least 32 \ bits.                                                         \                                                               \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #3                                                                                                                                                                            \ usage                                                         \                                                               \ all assembler words are in the vocabulary assembler. before us \ e                                                            \ this must be added to the search order, with:                 \                                                               \     also assembler                                            \                                                               \ before performing any assembly code-begin must be executed, th \ is takes as                                                  \ a parameter the target address for which code will be compiled \ for.                                                         \ when all code has been assembled, code-end must be executed to \ ensure that                                                  \ the final instruction is assembled correctly.                 \                                                               \ because many arm instructions also share names with standard f \ orth words                                                   \ there may be problems when intermingling forth and arm code. t \ o resolve this                                               \ the word [[ is provided which adds the forth wordlist to the b \ eginning of                                                  \ the search order, the word ]] reverts this change. e.g.       \                                                               \     mov r0 [[ some-variable @ ff and ]] #                     \                                                               \ this is analogous to escaping from compilation mode with the f \ orth [ ]                                                     \ words.                                                        \                                                               \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #4                                                                                                            \ assembler syntax                                              \                                                               \ the assembler syntax attempts to follow that defined by arm bu \ t changes have                                               \ made to enable it to work under the forth interpreter. these c \ hanges are                                                   \ detailed below.                                               \                                                               \ 1. operands are separated by whitespace rather than commas. e. \ g.                                                           \                                                               \        add  r0,r1,r2                                          \                                                               \    is written as                                              \                                                               \        add  r0 r1 r2                                          \                                                               \ 2. non alpha-numeric symbols must be surrounded by whitespace. \  e.g.                                                        \                                                               \        ldr  r0,[r1]                                           \        ldm  r0!,{r2,r3}                                       \                                                               \    is written as                                              \                                                               \        ldr  r0 [ r1 ]                                         \        ldm  r0 ! { r2 r3 }                                    \                                                               \ 3. condition code mnemonics must be surrounded by whitespace.  \ e.g.                                                         \                                                               \        moveq  r0,r1                                           \                                                               \    is written as                                              \                                                               \        mov eq  r0 r1                                          \                                                               \    this may also mean that an instruction's name gets split. e \ .g.                                                          \                                                               \        ldreqbt  r0,[r1]                                       \        moveqs   r2,r0                                         \                                                               \    is written as                                              \                                                               \        ldr eq bt  r0 [ r1 ]                                   \        mov eq s   r2 r0                                       \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #5                                                                                                                                                                            \ 4. all numeric constants are postfixed by a #, (which actually \ just takes a                                                 \    value from the stack). e.g.                                \                                                               \        mov  r0,#123                                           \                                                               \    is written as                                              \                                                               \        mov  r0 123 #                                          \                                                               \    a # is also used for numeric values which don't normally ha \ ve a # prefix                                                \    in arm syntax. e.g.                                        \                                                               \        mcr  p15,1,r2,c3,c4,5                                  \                                                               \    is written as                                              \                                                               \        mcr  p15 1 # r2 c3 c4 5 #                              \                                                               \ 5. the psr fields in the msr instruction must have whitespace  \ before them.                                                 \    e.g.                                                       \                                                               \        msr  cpsr_cf,r0                                        \                                                               \    is written as                                              \                                                               \        msr  cpsr_ cf r0                                       \                                                               \    the words cpsr_ and spsr_ are parsing words.               \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #6                                                                                                                                                                            \ other notes:                                                  \                                                               \ the load an store instructions can take numeric constants as t \ heir                                                         \ addressing mode and the assembler converts these into pc relat \ ive                                                          \ addressing. e.g.                                              \                                                               \     ldr r0 12345678 #                                         \                                                               \ is converted to the form                                      \                                                               \     ldr r0 [ pc <offset> # ]                                  \                                                               \ the pseudo instruction adr does a similar thing to generate ad \ d or sub                                                     \ instructions which give a pc relative address. e.g.           \                                                               \     adr r0 12345678 #                                         \                                                               \ is converted to the form                                      \                                                               \     add r0 pc <offset> #                                      \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #7                                                                                                                                                                            \ labels                                                        \                                                               \ the assembler supports labels. there are 3 words which support \  this:                                                       \                                                               \    l: name                                                    \        define label 'name' whose value is the current code add \ ress.                                                        \                                                               \    l= name                                                    \        define label 'name' and assign its value from the top o \ f the stack.                                                 \                                                               \    l# name                                                    \        use the value of label 'name' in an instruction as thou \ gh it were a                                                 \        numeric constant.                                      \                                                               \    examples:                                                  \        char " l= terminator                                   \        l: scan-loop                                           \            ldr b  r0 [ r1 ] 1 #                               \            cmp    r0 l# terminator                            \            b ne   l# scan-loop                                \                                                               \            ldr    r0 l# default                               \            mov    pc lr                                       \        l: default                                             \            dcd 12345678 #                                     \                                                               \                                                               \ porting                                                       \                                                               \ the internal words code-here code-here! and code, are used for \  storing                                                     \ assembled code into memory. this implementation uses the forth \  dictionary                                                  \ but these words can be modified to use some other location.   \                                                               \ code, will also need porting if this code is run on a forth sy \ stem where                                                   \ a cell isn't 32 bits.                                         \                                                               \                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #8                                                                                                                                                                            \ changes                                                       \                                                               \ 2016-12-24                                                    \     fixed some non-portable code, use "compare".              \                                                               \ 2016-12-23                                                    \     made "code-here"/"code-here!"/"code," deferred words.     \     exposed "code-origin"                                     \                                                               \ 2016-12-15                                                    \     ported to ff. (felix)                                     \                                                               \ 2006-11-09                                                    \     fixed some ans forth standard compliancey issues.         \     * made all hex values use upper-case letters.             \     * fixed use of private and public so the compilation wordl \ ist isn't                                                    \       changed during compilation of a word.                   \     thanks to dmitry yakimov for fixes and suggestions.       \                                                               \                                                               \ code follows...                                               : char+ 1+ ;        : chars ;                                   hex                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #9                                                                                                                                                                            \ place assembler in its own vocabulary.                        \ internal implementation words go into a separate private-wordl \ ist                                                          vocabulary assembler      also assembler definitions            vocabulary private-wordlist   also private-wordlist definitions also forth   \ make sure forth words are found first            : private   ( -- )   \ make new words go into private wordlist          also private-wordlist definitions previous ;            : public   ( -- )   \ make new words go into public wordlist            also assembler definitions previous ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #10                                                                                                                                                                           \ helpers words...                                              : rrotate   ( x1 u -- x2 )   \ rotate the bits of x1 right by u  \ bits                                                                 1f and                                                          2dup rshift                                                     rot rot 20 swap - lshift                                        or                                                      ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0 lsl        \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #11                                                                                                                                                                           \ words governing where assembled code gets placed.  ( porting )public                                                          defer code-here     defer code-here!        defer code,         : (code-here)   ( -- a-addr )   \ return address where code will \  be assembled to                                                     here ;                                                  : (code-here!)   ( a-addr -- )   \ set address where code will b \ e assembled to                                                       here - allot ;                                          : (code,)   ( x -- )   \ store 32 bit x at assembly address, and \  step to next                                                        , ;                                                     ' (code-here) is code-here                                      ' (code-here!) is code-here!                                    ' (code,) is code,                                              private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #12                                                                                                                                                                           \ variables                                                     variable op-value     \ bits for op-code being constructed      variable op-mask      \ mask of bits currently stored in op-valu \ e                                                            variable op-default   \ mask of bits in op-value which have defa \ ult values                                                   variable shift-flag   \ set by shift operands                   variable ]-flag       \ set true by ]                           variable {-flag       \ set true by {                           variable register-location   \ 0 to 4 bytes giving location to s \ tore registers                                               variable '#           \ vector for #                            variable 'rm          \ vector called when rm register is encoun \ tered                                                        public                                                          variable code-origin  \ address at which op-value is assembled f \ or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #13                                                                                                                                                                           \ words controlling immediate operands                          : #   ( x -- )   \ arm assembler, immediate operand suffix              '# @ execute ;                                          private                                                         : unexpected-#   ( -- )                                                 true abort" assembler: unexpected #" ;                  : reset-#   ( -- )   \ clear behaviour of immediate operand             ['] unexpected-# '# ! ;                                 : invalid#   ( -- )                                                     true abort" assembler: invalid immediate operand" ;     : check#   ( u1 u2 -- u1 )   \ check u1 <= u2                           over u< if invalid# then ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #14                                                                                                                                                                           \ words for initialising op-code generation                     : default-rm   ( x1 x2 x3 -- x1 x2 )   \ default action when rm  \ register used                                                        drop ;   \ do nothing                                   : op-reset   ( -- )   \ reset assembler state                           0 op-value !                                                    0 op-mask !                                                     f0000000 op-default !                                           0 shift-flag !                                                  0 ]-flag !                                                      0 {-flag !                                                      ffffffff register-location !                                    reset-#                                                         ['] default-rm 'rm !                                    ;                                                               : ?invalid   ( x -- )   \ if x not zero, then instruction is inv \ alid                                                                 abort" assembler: invalid instruction form"             ;                                                               : op-build   ( x1 x2 -- )   \ set opcode bits masked by x2 to va \ lues in x1                                                           op-mask @                                                       2dup and ?invalid                                               over or op-mask !                                               invert op-value @ and or op-value !                     ;                                                               : op-end   ( -- )   \ end of instruction assembly                       op-mask @                                                       if                                                                      op-mask @ op-default @ or                                       ffffffff xor ?invalid   \ check all bits are acc \ ounted for                                                                   op-value @ code,                                                4 code-origin +!                                                0 op-mask !                                             then                                                    ;                                                               : op-init   ( x1 x2 x3 -- )   \ initialise the assembler of new  \ instruction                                                          op-reset                                                        register-location !                                             op-mask !                                                       op-value !                                              ;                                                               : op-begin   ( x1 x2 x3 -- )    \ start assembly of a new instru \ ction                                                                op-end op-init ;                                        : do-instruction   ( a-addr -- )   \ common behaviour of instruc \ tion words                                                           \ fetch 3 words from a-addr and call op-begin                   dup @                                                           swap cell+ dup @                                                swap cell+ @                                                    op-begin                                                ;                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #15                                                                                                                                                                           : instruction   ( "<spaces>name" -- )   \ create instruction            <builds                                                         does>  ( -- )                                                   do-instruction                                          ;                                                               : instruction#   ( "<spaces>name" -- )   \ instruction with imme \ diate operand                                                        <builds                                                         does>  ( -- )                                                   dup do-instruction                                              cell+ cell+ cell+                                               @ '# !                                                  ;                                                               : instructiond   ( "<spaces>name" -- )   \ instruction with defa \ ult ops mask                                                         <builds                                                         does>  ( -- )                                                   dup do-instruction                                              cell+ cell+ cell+                                               @ op-default !                                          ;                                                               : instructiond#   ( "<spaces>name" -- )   \ instr. with default  \ and immediate                                                        <builds                                                         does>  ( -- )                                                   dup do-instruction                                              cell+ cell+ cell+                                               dup @ '# !                                                      cell+ @ op-default !                                    ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #16                                                                                                                                                                           \ flags parsing                                                 : lower-case   ( c1 -- c2 )   \ covert ascii character to lower- \ case                                                                 dup [char] a - 1a u< 20 and +                           ;                                                               : flag   ( c c-addr -- )   \ process a single parsed flag charac \ ter                                                                  begin                                                                   2dup c@ <>                                              while                                                                   dup c@ 0= ?invalid                                              char+ char+                                             repeat                                                          1 swap char+ c@ lshift                                          dup op-build                                                    drop                                                    ;                                                               : flags   ( -- )   \ create flags parsing word                          <builds                                                         does>   ( "<spaces>ccc" -- )                                    >r                                                              \ set flags in op-value for each flag char present in "c \ cc"...                                                               bl word count                                                   begin                                                                   dup                                                     while                                                                   over c@ lower-case r@ flag                                      1- swap char+ swap                                      repeat                                                          2drop                                                           \ now set op-mask for each flag bit...                          0 r>                                                            begin                                                                   dup c@                                                  while                                                                   char+                                                           >r 1 r@ c@ lshift or                                            r> char+                                                repeat                                                          drop                                                            op-mask @ or op-mask !                                  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #17                                                                                                                                                                           \ labels                                                        \                                                               \ structure of object is                                        \   cell    ref-link   \ link to list of unresolved references  \   cell    value      \ value for label                        \   string  name       \ name of label as a counted string      : label>ref-link   ( a-addr1 -- a-addr2 )                               ;                                                       : label>value   ( a-addr1 -- a-addr2 )                                  cell+ ;                                                 : label>name   ( a-addr -- c-addr )                                     cell+ cell+ ;                                           0f constant max-label-name-size   \ max significant length for l \ abel name                                                    2 cells  max-label-name-size 1+ +   aligned                     constant label-size   \ size of label object                    10 constant #labels   \ max number of labels                    create labels   #labels label-size * allot                      here constant labels-end                                        : alloc-label   ( -- a-addr )   \ allocate a new label object           labels                                                          begin                                                                   dup label>name c@ 0= ?exit                                      label-size +                                                    dup labels-end u<                                       while                                                           repeat                                                          1 abort" assembler: too many labels"                    ;                                                               : create-label   ( c-addr1 u1 -- a-addr )                               max-label-name-size min                                         alloc-label >r                                                  r@ label>name                                                   2dup c!                                                         char+ swap chars cmove                                          r>                                                      ;                                                               : find-label   ( c-addr u -- a-addr true | c-addr u false )             max-label-name-size min                                         2>r                                                             labels                                                          begin                                                                   dup label>name count                                            2r@ compare 0=  if  2r> 2drop  true  exit  then           label-size +                                                    dup labels-end u<                                             while                                                           repeat                                                          drop 2r> false                                          ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #18                                                                                                                                                                           \ unresolved label references                                   \                                                               \ structure of object is                                        \   cell ref-link   \ link to next unresolved references        \   cell origin     \ value for op-origin where reference occurr \ ed                                                           \   cell op-addr    \ address of instruction where reference occ \ urred                                                        \   cell '#         \ xt of word handling immediate arguments fo\ r reference                                                   : ref>ref-link   ( a-addr1 -- a-addr2 )                                 ;                                                       : ref>origin   ( a-addr1 -- a-addr2 )                                   cell+ ;                                                 : ref>op-addr   ( a-addr1 -- a-addr2 )                                  cell+ cell+ ;                                           : ref>'#   ( a-addr1 -- a-addr2 )                                       cell+ cell+ cell+ ;                                     4 cells constant ref-size                                       20 constant #label-refs   \ max number of unresolved label refer \ ences                                                        create label-refs   \ size of label reference object            #label-refs ref-size * allot                                    here constant label-refs-end                                    : alloc-label-ref   ( -- a-addr )   \ allocate a reference to a  \ label                                                                label-refs                                                      begin                                                                   dup ref>origin @                                        while                                                                   ref-size +                                                      dup label-refs-end =                                            if 1 abort" assembler: too many label references" then                                                                  repeat                                                  ;                                                               : create-label-ref   ( a-addr -- )   \ create reference to label \  a-addr                                                              alloc-label-ref >r                                              dup label>ref-link @      \ get old head of ref list            r@ ref>ref-link !         \ link to old head from new re \ f                                                                    r@ swap label>ref-link !  \ make new ref the head               code-origin @ r@ ref>origin  !                                  code-here r@ ref>op-addr !                                      '# @ r> ref>'# !                                        ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #19                                                                                                                                                                           : resolve-ref   ( x a-addr -- x a-addr )   \ ref a-addr resolves \ to value x                                                           code-origin @ >r                                                >r                                                              op-reset                                                        ffffff10 register-location !                                    r@ ref>origin @ code-origin !                                   r@ ref>op-addr @ @ op-value !                                   dup r@ ref>'# @ execute                                         op-value @                                                      r@ ref>op-addr @ !                                              op-reset                                                        r> 0 over ref>origin !   \ clear ref origin to indicate  \ it is free                                                           r> code-origin !                                        ;                                                               : label-resolve   ( a-addr -- )   \ resolve all references to a  \ label                                                                dup label>value @                                               swap label>ref-link                                             begin                                                                   dup @    \ get ref-link                                         0 rot !  \ clear ref-link                                       dup                                                     while                                                                   resolve-ref                                                     ref>ref-link                                            repeat                                                          2drop                                                   ;                                                               : check-labels-resolved   ( -- )                                        0 labels                                                        begin                                                                   dup label>ref-link @                                            if                                                                      ." unresolved label: " dup label>name                           count type cr                                                   >r 1+ r>                                                then                                                            label-size +                                                    dup labels-end u< 0=                                    until                                                           drop                                                            abort" assembler: unresolved labels"                    ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #20                                                                                                                                                                           \ top level words for labels                                    : labels-reset   ( -- )   \ clear all labels and references             labels labels-end over - erase                                  label-refs label-refs-end over - erase                  ;                                                               : get-label   ( <spaces>"name" -- a-addr flag )   \ find label o \ r create one                                                         \ flag is true if label has a value assigned.                   bl word count find-label                                        if                                                                      dup label>ref-link @ 0=                                 else                                                                    create-label false                                      then                                                    ;                                                               public                                                          : l=    ( x <spaces>"name" -- )   \ arm assembler, assign value  \ to label                                                             op-end                                                          get-label                                                       abort" assembler: label already defined"                        swap over label>value !                                         label-resolve                                           ;                                                               : l:    ( <spaces>"name" -- )   \ arm assembler, define a label         op-end  code-origin @ l= ;                              : l#    ( <spaces>"name" -- )   \ arm assembler, label reference        get-label                                                       if                                                                      label>value @   \ use address from label                else                                                                    create-label-ref                                                code-origin @   \ use current address as a dummy \  value                                                               then                                                            '# @ execute                                            ;                                                               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #21                                                                                                                                                                           \ pseudo instructions                                           public                                                          : .    ( -- addr )   \ arm assembler, current code address              code-origin @ ;                                         private                                                         : dcd#   ( x -- )                                                       ffffffff op-build ;                                     public                                                          instructiond# dcd    ( -- addr )   \ arm assembler, inline const \ ant                                                                  0 , 0 , ffffffff , ' dcd# , 0 ,                         private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #22                                                                                                                                                                           \ top level words for assembler                                 public                                                          : [[   ( -- )   \ arm assembler, add forth wordlist to search or \ der                                                                  also forth ;                                            : ]]   ( -- )   \ arm assembler, revert action of [[                    previous ;                                              : code-begin   ( a-addr -- )   \ start code assembly                    code-origin !                                                   labels-reset                                                    op-reset                                                ;                                                               : code-end   ( -- )   \ end code asembly                                op-end                                                          check-labels-resolved                                   ;                                                               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #23                                                                                                                                                                           \ condition codes...                                            : condition   ( u "<spaces>name" -- )   \ definer for condition  \ codes                                                                <builds ,                                                       does>   ( -- )                                                  @ f0000000 op-build                                     ;                                                               public                                                          00000000 condition eq   \ arm assembler, condition code         10000000 condition ne   \ arm assembler, condition code         20000000 condition cs   \ arm assembler, condition code         30000000 condition cc   \ arm assembler, condition code         40000000 condition mi   \ arm assembler, condition code         50000000 condition pl   \ arm assembler, condition code         60000000 condition vs   \ arm assembler, condition code         70000000 condition vc   \ arm assembler, condition code         80000000 condition hi   \ arm assembler, condition code         90000000 condition ls   \ arm assembler, condition code         a0000000 condition ge   \ arm assembler, condition code         b0000000 condition lt   \ arm assembler, condition code         c0000000 condition gt   \ arm assembler, condition code         d0000000 condition le   \ arm assembler, condition code         e0000000 condition al   \ arm assembler, condition code         f0000000 condition nv   \ arm assembler, condition code         private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #24                                                                                                                                                                           \ register operands                                             : ?bad-register   ( x -- )                                              abort" assembler: unexpected or bad register operand"   ;                                                               : register   ( u "<spaces>name" -- )   \ definer for cpu registe \ r words                                                              <builds ,                                                       does>   ( -- )                                                  @ {-flag @                                                      if                                                                      \ register in ldm/stm list...                                   dup 0f u> ?bad-register                                         1 swap lshift dup op-build                                      exit                                                    then                                                            \ get bit position for register in the op-code were buil \ ding...                                                              register-location dup @ dup 8 rshift ff000000 or rot !          dup -1 = ?bad-register                                          \ check register type                                           2dup xor 20 and ?bad-register                                   over >r                                                         \ create values for op-build                                    swap 0f and swap 1f and                                         0f over lshift >r lshift r>                                     \ add op-code bits for shift value if required                  shift-flag @                                                    if                                                                      swap 010 or                                                     swap 090 or                                             then                                                            \ execute special action for rm register                        dup 0f and                                                      if                                                                      r@ 'rm @ execute                                        then                                                            r> drop                                                         op-build   \ include bits in op-code we're building     ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #25                                                                                                                                                                           public                                                          00 register r0   \ arm assembler, cpu register                  01 register r1   \ arm assembler, cpu register                  02 register r2   \ arm assembler, cpu register                  03 register r3   \ arm assembler, cpu register                  04 register r4   \ arm assembler, cpu register                  05 register r5   \ arm assembler, cpu register                  06 register r6   \ arm assembler, cpu register                  07 register r7   \ arm assembler, cpu register                  08 register r8   \ arm assembler, cpu register                  09 register r9   \ arm assembler, cpu register                  0a register r10   \ arm assembler, cpu register                 0b register r11   \ arm assembler, cpu register                 0c register r12   \ arm assembler, cpu register                 0d register r13   \ arm assembler, cpu register                 0e register r14   \ arm assembler, cpu register                 0f register r15   \ arm assembler, cpu register                 80 register -r0   \ arm assembler, cpu register                 81 register -r1   \ arm assembler, cpu register                 82 register -r2   \ arm assembler, cpu register                 83 register -r3   \ arm assembler, cpu register                 84 register -r4   \ arm assembler, cpu register                 85 register -r5   \ arm assembler, cpu register                 86 register -r6   \ arm assembler, cpu register                 87 register -r7   \ arm assembler, cpu register                 88 register -r8   \ arm assembler, cpu register                 89 register -r9   \ arm assembler, cpu register                 8a register -r10   \ arm assembler, cpu register                8b register -r11   \ arm assembler, cpu register                8c register -r12   \ arm assembler, cpu register                8d register -r13   \ arm assembler, cpu register                8e register -r14   \ arm assembler, cpu register                8f register -r15   \ arm assembler, cpu register                20 register c0   \ arm assembler, coprocessor register          21 register c1   \ arm assembler, coprocessor register          22 register c2   \ arm assembler, coprocessor register          23 register c3   \ arm assembler, coprocessor register          24 register c4   \ arm assembler, coprocessor register          25 register c5   \ arm assembler, coprocessor register          26 register c6   \ arm assembler, coprocessor register          27 register c7   \ arm assembler, coprocessor register          28 register c8   \ arm assembler, coprocessor register          29 register c9   \ arm assembler, coprocessor register          2a register c10   \ arm assembler, coprocessor register         2b register c11   \ arm assembler, coprocessor register         2c register c12   \ arm assembler, coprocessor register         2d register c13   \ arm assembler, coprocessor register         2e register c14   \ arm assembler, coprocessor register         2f register c15   \ arm assembler, coprocessor register         : sp r13 ;     \ arm assembler, alias for r13                   : -sp -r13 ;   \ arm assembler, alias for r13                   : lr r14 ;     \ arm assembler, alias for r14                   : -lr -r14 ;   \ arm assembler, alias for r14                   : pc r15 ;     \ arm assembler, alias for r15                   : -pc -r15 ;   \ arm assembler, alias for r15                   private                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #26                                                                                                                                                                           \ shift operands                                                : shift#   ( x -- )   \ handle immediate operand for shifts             dup 1- shift-flag @ u> if invalid# then                         1f and 7 lshift f90 op-build                                    reset-#                                                 ;                                                               : shift   ( n x -- )   \ definer for shift operand words                <builds , ,                                                     does>   ( -- )                                                  dup @ 060 op-build                                              cell+ @ shift-flag !                                            ['] shift# '# !                                                 op-default @ fffff0ff and op-default !   \ force more op \ erands to be given                                           ;                                                               public                                                          1e 000 shift lsl   ( -- )   \ arm assembler, shift operator     1f 020 shift lsr   ( -- )   \ arm assembler, shift operator     1f 040 shift asr   ( -- )   \ arm assembler, shift operator     1e 060 shift ror   ( -- )   \ arm assembler, shift operator     : rrx   ( -- )   \ arm assembler, shift operator                        060 ff0 op-build ;                                      private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #27                                                                                                                                                                           \ data processing instructions...                               : arm-data-literal-rotate-count   ( u -- u n )   \ used by arm-d \ ata-literal                                                          0                                                               over 100 u< ?exit                                               begin                                                                   2 +                                                             2dup rrotate 0ff u> 0= ?exit                            dup 1e u<                                                       while                                                           repeat                                                          drop -1                                                 ;                                                               : arm-data-literal   ( u -- x )   \ convert u into 12bit data li \ teral                                                                arm-data-literal-rotate-count                                   dup 0= if drop exit then                                        dup 20 u<                                                       if                                                                      dup >r                                                          rrotate                                                         20 r> - 7 lshift or                                             exit                                                    then                                                            invalid#                                                ;                                                               : data#   ( x -- )   \ handle literal operand for data instructi \ ons                                                                  arm-data-literal                                                02000000 or 02000fff                                            op-build                                                ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #28                                                                                                                                                                           public                                                          instructiond# and   \ arm assembler, data processing instruction        e0000000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# eor   \ arm assembler, data processing instruction        e0200000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# sub   \ arm assembler, data processing instruction        e0400000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# rsb   \ arm assembler, data processing instruction        e0600000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# add   \ arm assembler, data processing instruction        e0800000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# adc   \ arm assembler, data processing instruction        e0a00000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# sbc   \ arm assembler, data processing instruction        e0c00000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# rsc   \ arm assembler, data processing instruction        e0e00000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# tst   \ arm assembler, data processing instruction        e1100000 , 0df0f000 , ff080010 , ' data# , f2000fff ,   instructiond# teq   \ arm assembler, data processing instruction        e1300000 , 0df0f000 , ff080010 , ' data# , f2000fff ,   instructiond# cmp   \ arm assembler, data processing instruction        e1500000 , 0df0f000 , ff080010 , ' data# , f2000fff ,   instructiond# cmn   \ arm assembler, data processing instruction        e1700000 , 0df0f000 , ff080010 , ' data# , f2000fff ,   instructiond# orr   \ arm assembler, data processing instruction        e1800000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# mov   \ arm assembler, data processing instruction        e1a00000 , 0def0000 , ff08000c , ' data# , f2100fff ,   instructiond# bic   \ arm assembler, data processing instruction        e1c00000 , 0de00000 , 0800100c , ' data# , f2100fff ,   instructiond# mvn   \ arm assembler, data processing instruction        e1e00000 , 0def0000 , ff08000c , ' data# , f2100fff ,   : s   ( -- )   \ arm assembler, data processing instruction modi\ fier                                                                  00100000 dup op-build                                   ;                                                               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #29                                                                                                                                                                           \ multiply instructions                                         public                                                          instructiond mul   ( -- )   \ arm assembler, multiply instructio \ n                                                                    e0000090 , 0fe0f0f0 , ff080010 , f0100000 ,             instructiond mla   ( -- )   \ arm assembler, multiply instructio \ n                                                                    e0200090 , 0fe000f0 , 0c080010 , f0100000 ,             instructiond umull   ( -- )   \ arm assembler, multiply instruct \ ion                                                                  e0800090 , 0fe000f0 , 0800100c , f0100000 ,             instructiond umlal   ( -- )   \ arm assembler, multiply instruct \ ion                                                                  e0a00090 , 0fe000f0 , 0800100c , f0100000 ,             instructiond smull   ( -- )   \ arm assembler, multiply instruct \ ion                                                                  e0c00090 , 0fe000f0 , 0800100c , f0100000 ,             instructiond smlal   ( -- )   \ arm assembler, multiply instruct \ ion                                                                  e0e00090 , 0fe000f0 , 0800100c , f0100000 ,             private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #30                                                                                                                                                                           \ load/store instructions                                       : adr#   ( x -- )   \ handle immediate operand for adr pseudo in \ structions                                                           code-origin @ 8 + -                                             dup 0<                                                          if                                                                      negate                                                          op-value dup @ 00c00000 xor swap !   \ turn add  \ into sub                                                             then                                                            arm-data-literal                                                00000fff                                                        op-build                                                ;                                                               public                                                          instruction# adr   ( -- )   \ arm assembler, pseudo op for pc re \ lative address                                                       e28f0000 , 0fff0000 , ffffff0c , ' adr# ,               private                                                         : set-pre-indexing   ( x1 -- x2 )                                       op-mask @ 01000000 and 0=                                       if                                                                      ]-flag @ 0=                                                     if swap 01000000 or swap then                                   01000000 or                                             then                                                    ;                                                               : try-mem#   ( n -- n | n2 )   \ see if we need a pc relative ad \ dress                                                                op-mask @ 000f000f and 0=        \ if no rn or index alr \ eady set...                                                          if pc code-origin @ 8 + - then   \ ...use pc relative ad \ dressing                                                     ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #31                                                                                                                                                                           : mem#   ( n -- )   \ process immediate operand for ldr/str inst \ ructions                                                             try-mem#                         \ check for absolute me \ mory address                                                         dup abs 0fff check#              \ get abs value and che \ ck range                                                             swap 0< invert 00800000 and or   \ set u bit if index +v \ e                                                                    02800fff                         \ op-mask value                set-pre-indexing                 \ set pre-index (p) bit \  if appropriate                                                      op-build                                                        reset-#                                                 ;                                                               : mem-op-rm   ( x1 x2 x3 -- x4 x5 )   \ process rm register for  \ ldr/str ops                                                          \ x1,x2 = op-value,op-mask   x3 = rm register value             \ x4,x5 = modified op-value,op-mask                             invert 80 and 10 lshift rot or   \ set u bit if not -ve  \ register                                                             02000000 or                      \ set register index           swap 02800000 or                 \ add bits to op-mask          set-pre-indexing                 \ set pre-index (p) bit \  if appropriate                                              ;                                                               : mem-op   ( x -- )   \ common factor for ldr and str instructio \ ns                                                                   0c100000 ff00100c op-begin                                      ['] mem# '# !                                                   f3e00fff op-default !                                           ['] mem-op-rm 'rm !                                     ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #32                                                                                                                                                                           public                                                          : str   ( -- )   \ arm assembler, store instruction                     e5800000 mem-op ;                                       : ldr   ( -- )   \ arm assembler, load instruction                      e5900000 mem-op ;                                       : t   ( -- )   \ arm assembler, load and store instruction modif \ ier                                                                  00200000 01200000 op-build                              ;                                                               : bt   ( -- )   \ arm assembler, load and store instruction modi \ fier                                                                 00600000 01600000 op-build                              ;                                                               : [   ( -- )   \ arm assembler, address bracket                         ;                                                       : ]   ( -- )   \ arm assembler, address bracket                         true ]-flag ! ;                                         : !   ( -- )   \ arm assembler, address write-back modifier             00200000 dup op-build ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0   brace    \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #33                                                                                                                                                                           private                                                         : extra-mem#   ( n -- )   \ handle immediate operand for extra l \ dr/str                                                               try-mem#                              \ check for absolu \ te memory address                                                    dup abs 0ff check#                    \ get abs value an \ d check range                                                        dup 0f0 and 4 lshift swap 0f and or   \ covert value int \ o op-code format                                                     00400000 or                           \ set i bit               swap 0< invert 00800000 and or        \ set u bit if ind \ ex+ve                                                                00c00f0f                              \ op-mask value           set-pre-indexing                      \ set pre-index bi \ t if appropriate                                                     op-build                                                        reset-#                                                 ;                                                               : extra-mem-op-rm   ( x1 x2 x3 -- x4 x5 )   \ process rm for ext \ ra ldr/str                                                           \ x1,x2 = op-value,op-mask   x3 = rm register value             \ x4,x5 = modified op-value,op-mask                             invert 80 and 10 lshift rot or   \ set u bit if not -ve  \ register                                                             swap 00c00000 or                 \ add bits to op-mask          set-pre-indexing                 \ set pre-index (p) bit \ if appropriate                                               ;                                                               : extra-mem-op2   ( x -- )   \ mutate into extra load/store inst \ ruction                                                              op-value @ f0000000 and or   \ add in condition code            0e1000f0                     \ op-mask value                    op-mask @ f0000000 and or    \ add in condition code mas \ k                                                                    ff00100c op-init             \ transmute instruction int \ o new form                                                           f1e00f0f op-default !                                           ['] extra-mem# '# !                                             ['] extra-mem-op-rm 'rm !                               ;                                                               : extra-mem-op   ( x -- )                                               op-value @ 00100000 and or   \ add in ldr/str bit               extra-mem-op2                                           ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #34                                                                                                                                                                           public                                                          : h   ( -- )   \ arm assembler, load and store instruction modif \ ier                                                                  01c000b0 extra-mem-op ;                                 : sb   ( -- )   \ arm assembler, load and store instruction modi \ fier                                                                 01c000d0 extra-mem-op ;                                 : sh   ( -- )   \ arm assembler, load and store instruction modi \ fier                                                                 01c000f0 extra-mem-op ;                                 instructiond swp   ( -- )   \ arm assembler, swap instruction           e1000090 , 0fb00ff0 , ff10000c , f0400000 ,             instructiond stm   ( -- )   \ arm assembler, store multiple inst \ ruction                                                              e8800000 , 0e100000 , ffffff10 , f1e0ffff ,             instructiond ldm   ( -- )   \ arm assembler, load multiple instr \ uction                                                               e8900000 , 0e100000 , ffffff10 , f1e0ffff ,             private                                                         : multi-type   ( x "<spaces>name" -- )                                  <builds ,                                                       does> ( -- )                                                    @ 01800000 op-build                                     ;                                                               public                                                          00000000 multi-type da   \ arm assembler, load/store multiple mo \ difier                                                       00800000 multi-type ia   \ arm assembler, load/store multiple mo \ difier                                                       01000000 multi-type db   \ arm assembler, load/store multiple mo \ difier                                                       01800000 multi-type ib   \ arm assembler, load/store multiple mo \ difier                                                       : {   ( -- )   \ arm assembler, load/store multiple register lis \ t brace                                                              true {-flag ! ;                                         : }   ( -- )   \ arm assembler, load/store multiple register lis \ t brace                                                              ;                                                       : ^ ( -- )   \ arm assembler, load/store multiple instruction mo \ difier                                                               00400000 dup op-build ;                                 private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #35                                                                                                                                                                           \ branch instructions...                                        : ?bad-branch   ( flag -- )                                             abort" assembler: bad branch target"                    ;                                                               : branch#   ( x -- )   \ handle immediate operand for branch ins \ truction                                                             dup 3 and ?bad-branch   \ check target is word aligned          code-origin @ 8 + -                                             dup 0< over xor fc000000 and ?bad-branch   \ check range \  for branch                                                          2 rshift 00ffffff and                                           00ffffff op-build                                               reset-#                                                 ;                                                               instruction# branch-op   ( -- )                                         ea000000 , 0f000000 , ffffffff , ' branch# ,            public                                                          : b   ( -- )   \ arm assembler, branch instruction or ldr/str mo \ difier                                                               op-mask @ dup 0= swap 000ff000 and or                           if branch-op exit then   \ branch instruction                   00400000 dup op-build    \ byte modifier of load/store i \ nstructions                                                  ;                                                               instruction# bl   ( -- )   \ arm assembler, branch instruction          eb000000 , 0f000000 , ffffffff , ' branch# ,            instruction bx ( -- )   \ arm assembler, branch instruction (arm \  4t)                                                                 e12fff10 , 0ffffff0 , ffffff00 ,                        private                                                         : swi#   ( u -- )   \ handle immediate operand for swi instructi \ ons                                                                  00ffffff check#                                                 00ffffff op-build                                               reset-#                                                 ;                                                               public                                                          instruction# swi   ( -- )   \ arm assembler, swi instruction            ef000000 , 0f000000 , ffffffff , ' swi# ,               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #36                                                                                                                                                                           \ mrs and msr instructions...                                   : psr   ( x -- )   \ common factor for psr operands                     00400000 op-build                                               op-mask @ 000f0000 and if exit then   \ end if mrs instr \ uction                                                               00090000 000f0000 op-build   \ set f and c field mask   ;                                                               flags psr-flags   \ parse fields for psr register                       char f c, 13 c,                                                 char s c, 12 c,                                                 char x c, 11 c,                                                 char c c, 10 c,                                                 0 c,                                                    public                                                          : cpsr   ( -- )   \ arm assembler, status register                      00000000 psr ;                                          : spsr   ( -- )   \ arm assembler, status register                      00400000 psr ;                                          : cpsr_   ( -- )   \ arm assembler, status register                     00000000 00400000 op-build psr-flags ;                  : spsr_   ( -- )   \ arm assembler, status register                     00400000 00400000 op-build psr-flags ;                  instruction mrs   ( -- )   \ arm assembler, status register inst \ ruction                                                              e10f0000 , 0fbf0fff , ffffff0c ,                        instructiond# msr   ( -- )   \ arm assembler, status register in \ struction                                                            e120f000 , 0db0f000 , ffffff00 , ' data# , f2000ff0 ,   private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #37                                                                                                                                                                           \ coprocessor instructions...                                   : coprocessor    ( u "<spaces>name" -- )   \ definer for coproce \ ssor                                                                 <builds , does> @ 00000f00 op-build ;                   public                                                          000 coprocessor p0   \ arm assembler, coprocessor               100 coprocessor p1   \ arm assembler, coprocessor               200 coprocessor p2   \ arm assembler, coprocessor               300 coprocessor p3   \ arm assembler, coprocessor               400 coprocessor p4   \ arm assembler, coprocessor               500 coprocessor p5   \ arm assembler, coprocessor               600 coprocessor p6   \ arm assembler, coprocessor               700 coprocessor p7   \ arm assembler, coprocessor               800 coprocessor p8   \ arm assembler, coprocessor               900 coprocessor p9   \ arm assembler, coprocessor               a00 coprocessor p10   \ arm assembler, coprocessor              b00 coprocessor p11   \ arm assembler, coprocessor              c00 coprocessor p12   \ arm assembler, coprocessor              d00 coprocessor p13   \ arm assembler, coprocessor              e00 coprocessor p14   \ arm assembler, coprocessor              f00 coprocessor p15   \ arm assembler, coprocessor              private                                                         : co-mem#   ( x -- )   \ handle immediate operand for ldc/stc           dup                                                             {-flag @ 0= if abs 2 rrotate then                               0ff check#                                                      swap 0< invert if 00800000 or then                              008000ff                                                        ]-flag @                                                        if                                                                      \ post index...                                                 {-flag @ 0= if swap 00200000 or swap then                       01200000 or                                             then                                                            op-build                                                        reset-#                                                 ;                                                               public                                                          instructiond# ldc   ( -- )   \ arm assembler, co-processor instr \ uction                                                               ed900000 , 0e100000 , ffff102c , ' co-mem# , f1e000ff , instructiond# stc   ( -- )   \ arm assembler, co-processor instr \ uction                                                               ed800000 , 0e100000 , ffff102c , ' co-mem# , f1e000ff , : l   ( -- )   \ arm assembler, co-processor instruction modifie \ r                                                                    00400000 dup op-build ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #38                                                                                                                                                                           private                                                         : co-op2#   ( u -- )   \ handle coprocessor instruction 2nd op-c \ ode                                                                  7 check#                                                        5 lshift 000000e0 op-build                                      reset-#                                                 ;                                                               : co-data#   ( u -- )   \ handler cdp instruction 1st op-code           0f check#                                                       14 lshift 00f00000 op-build                                     ['] co-op2# '# !                                        ;                                                               : co-mov#   ( u -- )   \ handler mcr/mrc instruction 1st op-code        7 check#                                                        15 lshift 00e00000 op-build                                     ['] co-op2# '# !                                        ;                                                               public                                                          instruction# cdp   ( -- )   \ arm assembler, co-processor instru \ ction                                                                ee000000 , 0f000010 , ff20302c , ' co-data# ,           instruction# mcr   ( -- )   \ arm assembler, co-processor instru \ ction                                                                ee000010 , 0f100010 , ff20300c , ' co-mov# ,            instruction# mrc   ( -- )   \ arm assembler, co-processor instru \ ction                                                                ee100010 , 0f100010 , ff20300c , ' co-mov# ,            private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #39                                                                                                                                                                           \ arm5 instructions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #40                                                                                                                                                                           : blx#   ( x -- )   \ handle immediate operand for blx instructi \ on                                                                   0 f000000f op-build                   \ check no operand \ s have been added                                                    dup 2 and 17 lshift                   \ get half-word fl \ ag                                                                   fa000000 or ff000000 ffffffff op-init \ transmute instru \ ction to long blx                                                    fffffffd and                          \ clear half-word  \ bit in address                                                       branch#                               \ insert branch ad \ dress                                                        ;                                                               public                                                          instruction# blx   ( -- )   \ arm assembler, branch instruction         e12fff30 , 0ffffff0 , ffffff00 , ' blx# ,               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #41                                                                                                                                                                           : bkpt#   ( u -- )   \ handle immediate operand for bkpt instruc \ tion                                                                 0000ffff check#                                                 dup 0000fff0 and 4 lshift                                       swap 0000000f and or                                            000fff0f op-build                                               reset-#                                                 ;                                                               public                                                          instruction# bkpt   ( -- )   \ arm assembler, breakpoint instruc \ tion                                                                 e1200070 , fff000f0 , ffffffff , ' bkpt# ,              private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #42                                                                                                                                                                           public                                                          instruction clz   ( -- )   \ arm assembler, count leading zeros  \ instruction                                                          e16f0f10 , 0fff0ff0 , ffff000c ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #43                                                                                                                                                                           public                                                          instruction# mcr2   ( -- )   \ arm assembler, co-processor instr \ uction                                                               fe000010 , ff100010 , ff20300c , ' co-mov# ,            instruction# mrc2   ( -- )   \ arm assembler, co-processor instr \ uction                                                               fe100010 , ff100010 , ff20300c , ' co-mov# ,            instructiond# ldc2   ( -- )   \ arm assembler, co-processor inst \ ruction                                                              fd900000 , fe100000 , ffff102c , ' co-mem# , f1e000ff , instructiond# stc2   ( -- )   \ arm assembler, co-processor inst \ ruction                                                              fd800000 , fe100000 , ffff102c , ' co-mem# , f1e000ff , instruction# cdp2   ( -- )   \ arm assembler, co-processor instr \ uction                                                               fe000000 , ff000010 , ff20302c , ' co-data# ,           private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #44                                                                                                                                                                           \ arm5e instructions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #45                                                                                                                                                                           public                                                          : d   ( -- )   \ arm assembler, load/store double instruction mo \ difier                                                               01c000d0                                                        op-value @ invert 00100000 and 0f rshift or   \ add in l \ dr/str bit                                                           extra-mem-op2                                           ;                                                               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #46                                                                                                                                                                           public                                                          : pld   ( -- )   \ arm assembler, pld instruction                       ldr r15 f1400000 f1600000 op-build ;                    private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #47                                                                                                                                                                           : co-mov2#   ( u -- )   \ handle immediate operand for mcrr/mrcc        0f check#                                                       4 lshift 000000f0 op-build                                      reset-#                                                 ;                                                               public                                                          instruction# mcrr   ( -- )   \ arm assembler, co-processor doubl \ e instruction                                                        ec400000 , 0ff00000 , ff20100c , ' co-mov2# ,           instruction# mrrc   ( -- )   \ arm assembler, co-processor doubl \ e instruction                                                        ec500000 , 0ff00000 , ff20100c , ' co-mov2# ,           private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #48                                                                                                                                                                           public                                                          instruction qadd   ( -- )   \ arm assembler, saturated arithmeti \ c instruction                                                        e1000050 , 0ff00ff0 , ff10000c ,                        instruction qsub   ( -- )   \ arm assembler, saturated arithmeti \ c instruction                                                        e1200050 , 0ff00ff0 , ff10000c ,                        instruction qdadd   ( -- )   \ arm assembler, saturated arithmet \ ic instruction                                                       e1400050 , 0ff00ff0 , ff10000c ,                        instruction qdsub   ( -- )   \ arm assembler, saturated arithmet \ ic instruction                                                       e1600050 , 0ff00ff0 , ff10000c ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #49                                                                                                                                                                           public                                                          instruction smlabb   ( -- )   \ arm assembler, dsp multiply inst \ ruction                                                              e1000080 , 0ff000f0 , 0c080010 ,                        instruction smlatb   ( -- )   \ arm assembler, dsp multiply inst \ ruction                                                              e10000a0 , 0ff000f0 , 0c080010 ,                        instruction smlabt   ( -- )   \ arm assembler, dsp multiply inst \ ruction                                                              e10000c0 , 0ff000f0 , 0c080010 ,                        instruction smlatt   ( -- )   \ arm assembler, dsp multiply inst                                                                        e10000e0 , 0ff000f0 , 0c080010 ,                        instruction smlawb   ( -- )   \ arm assembler, dsp multiply inst                                                                        e1200080 , 0ff000f0 , 0c080010 ,                        instruction smlawt   ( -- )   \ arm assembler, dsp multiply inst                                                                        e12000c0 , 0ff000f0 , 0c080010 ,                        instruction smulbb   ( -- )   \ arm assembler, dsp multiply inst                                                                        e1600080 , 0ff0f0f0 , ff080010 ,                        instruction smultb   ( -- )   \ arm assembler, dsp multiply inst                                                                        e16000a0 , 0ff0f0f0 , ff080010 ,                        instruction smulbt   ( -- )   \ arm assembler, dsp multiply inst                                                                        e16000c0 , 0ff0f0f0 , ff080010 ,                        instruction smultt   ( -- )   \ arm assembler, dsp multiply inst                                                                        e16000e0 , 0ff0f0f0 , ff080010 ,                        instruction smulwb   ( -- )   \ arm assembler, dsp multiply inst                                                                        e12000a0 , 0ff0f0f0 , ff080010 ,                        instruction smulwt   ( -- )   \ arm assembler, dsp multiply inst                                                                        e12000e0 , 0ff0f0f0 , ff080010 ,                        instruction smlalbb   ( -- )   \ arm assembler, dsp multiply ins                                                                        e1400080 , 0ff000f0 , 0800100c ,                        instruction smlaltb   ( -- )   \ arm assembler, dsp multiply ins                                                                        e14000a0 , 0ff000f0 , 0800100c ,                        instruction smlalbt   ( -- )   \ arm assembler, dsp multiply ins                                                                        e14000c0 , 0ff000f0 , 0800100c ,                        instruction smlaltt   ( -- )   \ arm assembler, dsp multiply ins                                                                        e14000e0 , 0ff000f0 , 0800100c ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #50                                                                                                                                                                           \ arm5j instructions                                            public                                                          instruction bxj   ( -- )   \ arm assembler, branch instruction          e12fff20 , 0ffffff0 , ffffff00 ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #51                                                                                                                                                                           \ arm6 instructions                                             public                                                          instruction# mcrr2   ( -- )   \ arm assembler, co-processor doub                                                                        fc400000 , fff00000 , ff20100c , ' co-mov2# ,           instruction# mrrc2   ( -- )   \ arm assembler, co-processor doub                                                                        fc500000 , fff00000 , ff20100c , ' co-mov2# ,           private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #52                                                                                                                                                                           : cps#   ( u -- )   \ handle immediate operand for cps instructi                                                                        1f check#                                                       00020000 or 0002001f op-build                           ;                                                               flags iflags   ( c -- )   \ parse flags for cps instruction             char a c, 8 c,                                                  char i c, 7 c,                                                  char f c, 6 c,                                                  0 c,                                                    instructiond# cpsie   ( -- )   \ arm assembler, cps instruction         f1080000 , fffdfe20 , ffffffff , ' cps# , f002001f ,    instructiond# cpsid   ( -- )   \ arm assembler, cps instruction         f10c0000 , fffdfe20 , ffffffff , ' cps# , f002001f ,    public                                                          : cpsie   ( -- )                                                        cpsie iflags ;                                          : cpsid   ( -- )                                                        cpsid iflags ;                                          instruction# cps   ( -- )   \ arm assembler, cps instruction            f1000000 , fffdffe0 , ffffffff , ' cps# ,               private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #53                                                                                                                                                                           public                                                          instruction setend   ( -- )   \ arm assembler, setend instructio                                                                        f1010000 , fffffdff , ffffffff ,                        : le   ( -- )   \ arm assembler, modifier for setend instruction        op-value @ f1010000 =   \ if setend instruction...              if 000 200 op-build     \ ... set le bit to zero                else le                 \ else do less-or-equal conditio                                                                        then                                                            ;                                                       : be   ( -- )   \ arm assembler, modifier for setend instruction        200 200 op-build ;                                      private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #54                                                                                                                                                                           : srs#   ( u -- )   \ handle immediate operand for srs instructi                                                                        1f check# 0000001f op-build  reset-# ;                  public                                                          instructiond# srs   ( -- )   \ arm assembler, srs instruction           f84d0a00 , fe5fffe0 , ffffffff , ' srs#  , 01a00000 ,   instructiond rfe   ( -- )   \ arm assembler, rfe instruction            f8100a00 , fe50ffff , ffffff10 , 01a00000 ,             private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #55                                                                                                                                                                           public                                                          instruction ldrex   ( -- )   \ arm assembler, swap instruction          e1900f9f , 0ff00fff , ffff100c ,                        instruction strex   ( -- )   \ arm assembler, swap instruction          e1800f90 , 0ff00ff0 , ff10000c ,                        private                                                         public                                                          instruction umaal   ( -- )   \ arm assembler, multiply instructi                                                                        e0400090 , 0ff000f0 , 0800100c ,                        private                                                         : pas-instruction   ( x "<spaces>name" -- )   \ parallel add/sub                                                                        <builds ,                                                       does>   ( -- )                                                  @ 0ff00ff0 ff00100c op-begin                            ;                                                               public                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #56                                                                                                                                                                           e6100f10 pas-instruction sadd16   ( -- )   \ arm assembler, para                                                                e6100f30 pas-instruction saddsubx   ( -- )   \ arm assembler, pa                                                                e6100f50 pas-instruction ssubaddx   ( -- )   \ arm assembler, pa                                                                e6100f70 pas-instruction ssub16   ( -- )   \ arm assembler, para                                                                e6100f90 pas-instruction sadd8   ( -- )   \ arm assembler, paral                                                                e6100ff0 pas-instruction ssub8   ( -- )   \ arm assembler, paral                                                                e6200f10 pas-instruction qadd16   ( -- )   \ arm assembler, para                                                                e6200f30 pas-instruction qaddsubx   ( -- )   \ arm assembler, pa                                                                e6200f50 pas-instruction qsubaddx   ( -- )   \ arm assembler, pa                                                                e6200f70 pas-instruction qsub16   ( -- )   \ arm assembler, para                                                                e6200f90 pas-instruction qadd8   ( -- )   \ arm assembler, paral                                                                e6200ff0 pas-instruction qsub8   ( -- )   \ arm assembler, paral                                                                e6300f10 pas-instruction shadd16   ( -- )   \ arm assembler, par                                                                e6300f30 pas-instruction shaddsubx   ( -- )   \ arm assembler, p                                                                e6300f50 pas-instruction shsubaddx   ( -- )   \ arm assembler, p                                                                e6300f70 pas-instruction shsub16   ( -- )   \ arm assembler, par                                                                e6300f90 pas-instruction shadd8   ( -- )   \ arm assembler, para                                                                e6300ff0 pas-instruction shsub8   ( -- )   \ arm assembler, para                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #57                                                                                                                                                                           e6500f10 pas-instruction uadd16   ( -- )   \ arm assembler, para                                                                e6500f30 pas-instruction uaddsubx   ( -- )   \ arm assembler, pa                                                                e6500f50 pas-instruction usubaddx   ( -- )   \ arm assembler, pa                                                                e6500f70 pas-instruction usub16   ( -- )   \ arm assembler, para                                                                e6500f90 pas-instruction uadd8   ( -- )   \ arm assembler, paral                                                                e6500ff0 pas-instruction usub8   ( -- )   \ arm assembler, paral                                                                e6600f10 pas-instruction uqadd16   ( -- )   \ arm assembler, par                                                                e6600f30 pas-instruction uqaddsubx   ( -- )   \ arm assembler, p                                                                e6600f50 pas-instruction uqsubaddx   ( -- )   \ arm assembler, p                                                                e6600f70 pas-instruction uqsub16   ( -- )   \ arm assembler, par                                                                e6600f90 pas-instruction uqadd8   ( -- )   \ arm assembler, para                                                                e6600ff0 pas-instruction uqsub8   ( -- )   \ arm assembler, para                                                                e6700f10 pas-instruction uhadd16   ( -- )   \ arm assembler, par                                                                e6700f30 pas-instruction uhaddsubx   ( -- )   \ arm assembler, p                                                                e6700f50 pas-instruction uhsubaddx   ( -- )   \ arm assembler, p                                                                e6700f70 pas-instruction uhsub16   ( -- )   \ arm assembler, par                                                                e6700f90 pas-instruction uhadd8   ( -- )   \ arm assembler, para                                                                e6700ff0 pas-instruction uhsub8   ( -- )   \ arm assembler, para                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #58                                                                                                                                                                           private                                                         : pkh/sat-lsr#   ( x -- )   \ handle immediate operand for pkt & \  sat shifts                                                          1f check#  7 lshift 00000f80 op-build  reset-# ;        public                                                          : lsl   ( -- )   \ extend lsl shift to cope with pkh & sat instr                                                                        op-value @ 0f800070 and 06800010 <>                             if lsl exit then   \ if not pkh/sat instruction do norma                                                                        00000000 00000040 op-build                                      ['] pkh/sat-lsr# '# !                                   ;                                                               private                                                         : pkh/sat-asr#   ( x -- )                                               1- 1f check# 1+  1f and pkh/sat-lsr# ;                  public                                                          : asr   ( -- )   \ extend asr shift to cope with pkh & sat instr                                                                        op-value @ 0f800030 and 06800010 <>                             if asr exit then   \ if not pkh/sat instruction do norma                                                                        00000040 dup op-build                                           ['] pkh/sat-asr# '# !                                   ;                                                               instructiond pkhbt   ( -- )   \ arm assembler, pkhbt instruction        e6800010 , 0ff00030 , ff00100c , f0000fc0 ,             : pkhtb   ( -- )   \ arm assembler, pkhtb instruction                   pkhbt ;                                                 private                                                         : sat#   ( x -- )   \ handle immediate operand for sat instructi                                                                        1f check#  10 lshift 001f0000 op-build  reset-# ;       : sat16#   ( x -- )   \ handle immediate operand for sat16 instr                                                                        f check#  10 lshift 000f0000 op-build  reset-# ;        public                                                          instructiond# ssat   ( -- )   \ arm assembler, ssat instruction         e6a00010 , 0fe00030 , ffff000c , ' sat# , f0000fc0 ,    instructiond# usat   ( -- )   \ arm assembler, usat instruction         e6e00010 , 0fe00030 , ffff000c , ' sat# , f0000fc0 ,    instruction# ssat16   ( -- )   \ arm assembler, ssat16 instructi                                                                        e6a00f30 , 0ff00ff0 , ffff000c , ' sat16# ,             instruction# usat16   ( -- )   \ arm assembler, usat16 instructi                                                                        e6e00f30 , 0ff00ff0 , ffff000c , ' sat16# ,             instruction sel   ( -- )   \ arm assembler, sel instruction             e6800fb0 , 0ff00ff0 , ff00100c ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #59                                                                                                                                                                           : ext#   ( x -- x)   \ handle immediate operand for extend instr                                                                        dup ffffffe7 and if invalid# then                               pkh/sat-lsr#                                            ;                                                               public                                                          : ror   ( -- )   \ extend ror shift to cope with extend instruct                                                                        op-value @ 0f8000f0 and 06800070 <>                             if ror exit then   \ if not extend instruction do normal                                                                        ['] ext# '# !                                           ;                                                               instructiond sxtab16   ( -- )   \ arm assembler, extend instruct                                                                        e6800070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond sxtab   ( -- )   \ arm assembler, extend instructio                                                                        e6a00070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond sxtah   ( -- )   \ arm assembler, extend instructio                                                                        e6b00070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond uxtab16   ( -- )   \ arm assembler, extend instruct                                                                        e6c00070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond uxtab   ( -- )   \ arm assembler, extend instructio                                                                        e6e00070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond uxtah   ( -- )   \ arm assembler, extend instructio                                                                        e6f00070 , 0ff00070 , ff00100c , f0000f80 ,             instructiond sxtb16   ( -- )   \ arm assembler, extend instructi                                                                        e68f0070 , 0fff0070 , ffff000c , f0000f80 ,             instructiond sxtb   ( -- )   \ arm assembler, extend instruction        e6af0070 , 0fff0070 , ffff000c , f0000f80 ,             instructiond sxth   ( -- )   \ arm assembler, extend instruction        e6bf0070 , 0fff0070 , ffff000c , f0000f80 ,             instructiond uxtb16   ( -- )   \ arm assembler, extend instructi                                                                        e6cf0070 , 0fff0070 , ffff000c , f0000f80 ,             instructiond uxtb   ( -- )   \ arm assembler, extend instruction        e6ef0070 , 0fff0070 , ffff000c , f0000f80 ,             instructiond uxth   ( -- )   \ arm assembler, extend instruction        e6ff0070 , 0fff0070 , ffff000c , f0000f80 ,             instruction rev   ( -- )   \ arm assembler, reverse instruction         e6bf0f30 , 0fff0ff0 , ffff000c ,                        instruction rev16   ( -- )   \ arm assembler, reverse instructio                                                                        e6bf0fb0 , 0fff0ff0 , ffff000c ,                        instruction revsh   ( -- )   \ arm assembler, reverse instructio                                                                        e6ff0fb0 , 0fff0ff0 , ffff000c ,                        private                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #60                                                                                                                                                                           public                                                          instruction smuad   ( -- )   \ arm assembler, multiply instructi                                                                        e700f010 , 0ff0f0f0 , ff080010 ,                        instruction smuadx   ( -- )   \ arm assembler, multiply instruct                                                                        e700f030 , 0ff0f0f0 , ff080010 ,                        instruction smusd   ( -- )   \ arm assembler, multiply instructi                                                                        e700f050 , 0ff0f0f0 , ff080010 ,                        instruction smusdx   ( -- )   \ arm assembler, multiply instruct                                                                        e700f070 , 0ff0f0f0 , ff080010 ,                        instruction smmul   ( -- )   \ arm assembler, multiply instructi                                                                        e750f010 , 0ff0f0f0 , ff080010 ,                        instruction smmulr   ( -- )   \ arm assembler, multiply instruct                                                                        e750f030 , 0ff0f0f0 , ff080010 ,                        instruction smlad   ( -- )   \ arm assembler, multiply instructi                                                                        e7000010 , 0ff000f0 , 0c080010 ,                        instruction smladx   ( -- )   \ arm assembler, multiply instruct                                                                        e7000030 , 0ff000f0 , 0c080010 ,                        instruction smlsd   ( -- )   \ arm assembler, multiply instructi                                                                        e7000050 , 0ff000f0 , 0c080010 ,                        instruction smlsdx   ( -- )   \ arm assembler, multiply instruct                                                                        e7000070 , 0ff000f0 , 0c080010 ,                        instruction smlald   ( -- )   \ arm assembler, multiply instruct                                                                        e7400010 , 0ff000f0 , 0800100c ,                        instruction smlaldx   ( -- )   \ arm assembler, multiply instruc                                                                        e7400030 , 0ff000f0 , 0800100c ,                        instruction smlsld   ( -- )   \ arm assembler, multiply instruct                                                                        e7400050 , 0ff000f0 , 0800100c ,                        instruction smlsldx   ( -- )   \ arm assembler, multiply instruc                                                                        e7400070 , 0ff000f0 , 0800100c ,                        instruction smmla   ( -- )   \ arm assembler, multiply instructi                                                                        e7500010 , 0ff000f0 , 0c080010 ,                        instruction smmlar   ( -- )   \ arm assembler, multiply instruct                                                                        e7500030 , 0ff000f0 , 0c080010 ,                        instruction smmls   ( -- )   \ arm assembler, multiply instructi                                                                        e75000d0 , 0ff000f0 , 0c080010 ,                        instruction smmlsr   ( -- )   \ arm assembler, multiply instruct                                                                        e75000f0 , 0ff000f0 , 0c080010 ,                        private                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #61                                                                                                                                                                           public                                                          instruction usad8   ( -- )   \ arm assembler, usad instruction          e780f010 , 0ff0f0f0 , ff080010 ,                        instruction usada8   ( -- )   \ arm assembler, usad instruction         e7800010 , 0ff000f0 , 0c080010 ,                        private                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ arm-assembler - #62 (end)                                                                                                                                                                     previous previous previous definitions                          also assembler definitions                                      : next                                                            ldr r11 [ r12 ] 4 #                                             ldr pc [ r11 ] ;                                              also forth definitions                                          : code  ( | name -- )                                             create  here dup 1 cells - ! ( cfa -> paramfield )              also assembler  here code-begin ;                             : end-code  code-end  previous ;                                previous previous                                               decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Assemblers 364                                                                                                                                                              \ sparc assembler - #1                                                                                                          \                                                               \ Instruction format:                                           \                                                               \   s1 s2 d <instr>                                             \   addr <branch> [,a]                                          \                                                               \ s1 = register                                                 \ s2 = register | immediate                                     \ d = register                                                  \                                                               \ * s1 + d are reversed for "st..." operations                  \ * wry + rdy have only 2 arguments                             \                                                               \ # marks immediate                                             \ ) can be used in place of s2 as an alternative to "0 #"       \ $ is a synonym for `here`                                     \ %lo / %hi extract parts from val and convert to imm. argument \                                                               \ conditions: >  u>  <  u<  =  <>  cc?  cs?  0<  0>  0=  0<>  <= \  >=                                                          \ conditionals: if  then  else  begin  while  repeat  until     \                                                               \ synthetic instructions:                                       \                                                               \   <imm> <reg> set                                             \   <imm> <reg> inc     (dec, inccc, deccc)                     \   <s> <ref> btst      (bclr, bset, btog)                      \   <reg> clr           (not, neg)                              \   <s> <reg> mov                                               \   <reg> <s> cmp       (jmp)                                   \   <s> tst                                                     \   ret                 (retl, nop)                             \                                                               \ set the deferred words `asm@`, `asm!`, `asmhere!` and `ashmere \ `                                                            \ to customize target code addressing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ sparc assembler - #2                                                                                                                                                                          vocabulary assembler    also assembler definitions              hex                                                             : register  ( u | name -- ) <builds  ,  does>  @ 0 ;            0 register %r0      1 register %r1      2 register %r2          3 register %r3      4 register %r4      5 register %r5          6 register %r6      7 register %r7      8 register %r8          9 register %r9      0a register %r10    0b register %r11        0c register %r12    0d register %r13    0e register %r14        0f register %r15    10 register %r16    11 register %r17        12 register %r18    13 register %r19    14 register %r20        15 register %r21    16 register %r22    17 register %r23        18 register %r24    19 register %r25    1a register %r26        1b register %r27    1c register %r28    1d register %r29        1e register %r30    1f register %r31                            0 register %f0      1 register %f1      2 register %f2          3 register %f3      4 register %f4      5 register %f5          6 register %f6      7 register %f7      8 register %f8          9 register %f9      0a register %f10    0b register %f11        0c register %f12    0d register %f13    0e register %f14        0f register %f15    10 register %f16    11 register %f17        12 register %f18    13 register %f19    14 register %f20        15 register %f21    16 register %f22    17 register %f23        18 register %f24    19 register %f25    1a register %f26        1b register %f27    1c register %f28    1d register %f29        1e register %f30    1f register %f31                            0 register %g0      1 register %g1      2 register %g2          3 register %g3      4 register %g4      5 register %g5          6 register %g6      7 register %g7                              8 register %o0      9 register %o1      0a register %o2         0b register %o3     0c register %o4     0d register %o5         0e register %o6     0f register %o7                             10 register %l0     11 register %l1     12 register %l2         13 register %l3     14 register %l4     15 register %l5         16 register %l6     17 register %l7                             18 register %i0     19 register %i1     1a register %i2         1b register %i3     1c register %i4     1d register %i5         1e register %i6     1f register %i7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ sparc assembler - #3                                                                                                                                                                          %i6 drop register %fp   %o6 drop register %sp                   \ note: assumes host is big-endian                              defer asm@       ' @ is asm@                                    defer asm!       ' ! is asm!                                    defer asmhere    ' here is asmhere                              defer asmhere!   :noname h ! ; is asmhere!                      : asm,  ( x -- ) asmhere asm!  1 cells asmhere + asmhere! ;     : rs2  ( r 0 -- u ) abort" expected source register" ;          : rs2/simm13  ( r/i f -- u ) if  1fff and 2000 or  then ;       : rd  ( r 0 -- u ) abort" expected destination register"  d# 25 lshift ;                                                        : rs1  ( r 0 -- u ) abort" expected source register"              d# 14 lshift ;                                                : op3  ( s1 ts1 s2 ts2 d td a -- u )                              @ d# 19 lshift  -rot rd or  -rot rs2/simm13 or  -rot rs1 or ; : opa  ( op3 | name -- )                                          <builds  ,  does>  ( s1 ts1 s2 ts2 d td a -- )                  op3  c0000000 or asm, ;                                       : opar  ( op3 | name -- )                                         <builds  ,  does>  ( d1 td1 d2 td2 s ts a -- )                  >r  2rot  r>  op3  c0000000 or asm, ;                         : sethi  ( i 1 r 0 -- )                                           dup abort" expected register"  rd                               -rot 0= abort" expected immediate"  3fffff and or               01000000 or asm, ;                                            : nop  01000000 asm, ;                                          : opb  ( op3 | name -- )                                          <builds  ,  does>  ( s1 ts1 s2 ts2 d td a -- )                  op3  80000000 or asm, ;                                       : disp22  ( addr -- u ) asmhere cell+ 2 rshifta - 3fffff and ;  : bop  ( addr cond u1 -- u2)                                      swap d# 25 lshift or  swap disp22  or asm, ;                  : opc  ( cond | name -- )                                         <builds  ,  does>  ( addr a -- ) @ 800000 bop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ sparc assembler - #4                                                                                                                                                                          : ,a  asmhere 1 cells - dup @ 20000000 or swap ! ;              : opd  ( cond | name -- )                                         <builds  ,  does>  ( addr a -- ) @ 1800000 bop ;              : ope  ( cond | name --)                                          <builds  ,  does>  ( addr a -- ) @ 1c00000 bop ;              : disp30  ( addr -- u ) asmhere cell+ - 3fffffff and ;          : call  ( addr -- ) disp30  40000000 or asm, ;                  : rs2/imm7  ( r/i f -- u ) if  7f and 2000 or  then ;           : opg  ( cond | name -- )                                         <builds  ,  does>  ( s1 ts1 s2 ts2 a -- )                       @ d# 25 lshift  81d00000 or  -rot rs2/imm7 or  -rot rs1 or      asm, ;                                                        : rdy  ( s ts d td -- )                                           rd  28 d# 18 lshift or  -rot rs1 or asm, ;                    variable wryop  30 wryop !                                      : wry  ( s1 ts1 s2 ts2 -- )                                       %g0 wryop op3  80000000 or asm, ;                             : flush  ( s1 ts1 s2 ts2 d td -- ) 3b 0 0 opb asm, ;            : stbar  9143e000 asm, ;                                        : oph  ( op | name -- )                                           <builds  ,  does>  ( r1 0 r2 0 a -- )                           @ 5 lshift 81a00000 or  -rot rs2 or  rs1 or asm, ;            : #  ( n -- n 1 ) 1 ;                                           : )  ( r 0 -- r 0 0 1 ) 0 1 ;                                   : $  ( -- a ) asmhere ;                                         : %lo  ( n -- u 1 ) 3ff and 1 ;                                 : %hi  ( n -- u 1 ) d# 10 rshift 1 ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ sparc assembler - #5                                                                                                                                                                          \ <op> r1 x2 r3                                                 9 opa ldsb      0a opa ldsh     1 opa ldub      2 opa lduh      0 opa ld        3 opa ldd                                       20 opa ldf      23 opa lddf     21 opa ldfsr                    e0 opa ldc      33 opa lddc     31 opa ldcsr                    0d opa ldstub                                                   0f opa swap                                                     \ <op> r1 r2 x3  (r1 is src)                                    5 opar stb       6 opar sth       4 opar st        7 opar std   24 opar stf      27 opar stdf     25 opar stfsr                 34 opar src      37 opar stdc     35 opar stcsr                 \ <op> r1 x2 r3                                                 1 opb and       11 opb andcc    5 opb andn      15 opb andncc   2 opb or        12 opb orcc     6 opb orn       16 opb orncc    3 opb xor       13 opb xorcc    7 opb xnor      17 opb xnorcc   25 opb sll      26 opb srl      27 opb sra                      0 opb add       10 opb addcc    8 opb addx      18 opb addxcc   20 opb taddcc   22 opb taddcctv                                 4 opb sub       14 opb subcc    0c opb subx     1c opb subxcc   21 opb tsubcc   23 opb tsubcctv                                 24 opb mulscc                                                   0a opb umul     0b opb smul     1a opb umulcc   1b opb smulcc   0e opb udiv     0f opb sdiv     1e opb udivcc   1f opb sdivcc   3c opb save     3d opb restore  38 opb jmpl                     \ <op> addr                                                     8 opc ba        0 opc bn        9 opc bne       1 opc be        0a opc bg       2 opc ble       0b opc bge      3 opc bl        0c opc bgu      4 opc bleu      0d opc bcc      5 opc bcs       0e opc bpos     6 opc bneg      0f opc bvc      7 opc bvs       8 opd fba       0 opd fbn       7 opd fbu       6 opd fbg       5 opd fbug      4 opd fbl       3 opd fbul      2 opd fblg      1 opd fbne      9 opd fbe       0a opd fbeu     0b opd fbge     0c opd fbuge    0d opd fble     0e opd fbule    0f opd fbo      8 ope cba       0 ope cbn       7 ope cb3       6 ope cb2       5 ope cb23      4 ope cb1       3 ope cb13      2 ope cb12      1 ope cb123     9 ope cb0       0a ope cb03     0b ope cb02     0c ope cb023    0d ope cb01     0e ope cb013    0f ope cb012                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources :#10 - Assemblers :#364                                                                                          \ sparc assembler - #6                                                                                                                                                                          \ <op> r1 x2                                                    8 opg ta        0 opg tn        9 opg tne       1 opg te        0a opg tg       2 opg tle       0b opg tge      3 opg tl        0c opg tgu      4 opg tleu      0d opg tcc      5 opg tcs       0e opg tpos     6 opg tneg      0f opg tvc      7 opg tvs       \ <op> r1 r2                                                    c4 oph fitos    c8 oph fitod    ca oph fitoq                    d1 oph fstoi    d2 oph fdtoi    d3 oph fqtoi                    c9 oph fstod    0cd oph fstoq   c6 oph fdtos    0ce oph fdtoq   c7 oph fqtos    0cb oph fqtod                                   1 oph fmovs     5 oph fnegs     9 oph fabss                     29 oph fsqrts   2a oph fsqrtd   2b oph fsqrtq                   41 oph fadds    42 oph faddd    43 oph faddq    45 oph fsubs    46 oph fsubd    47 opg fsubq                                    49 opg fmuls    4a oph fmuld    4b oph fmulq    69 opg fsmuls   6e oph fdmulq   3d oph fdivs    4e oph fdivd    4f oph fdivq    51 oph fcmps    52 oph fcmpd    53 oph fcmpq    55 opg fcmpes   56 oph fcmped   57 oph fcmpeq                                   \ synthetic instructions                                        \ <op> r1 x2                                                    : cmp  %g0 subcc ;      : jmp  %g0 jmpl ;                       \ tst x1                                                        : tst  %g0 2swap %g0 orcc ;                                     \ <op>                                                          : ret  %i7 8 # %g0 jmpl ;                                       : retl  %o0 8 # %g0 jmpl ;                                      \ <op> r1                                                       : not  %g0 2over xnor ;                                         : neg  %g0 2swap 2dup sub ;                                     \ <op> imm # reg                                                : inc  2swap 2over add ;        : inccc  2swap 2over addcc ;    : dec  2swap 2over sub ;        : deccc  2swap 2over subcc ;    \ <op> x1 r2                                                    : btst  2swap %g0 andcc ;       : bset  2swap 2over or ;        : bclr  2swap 2over andn ;      : btog  2swap 2over xor ;       : mov  %g0 2rot 2rot or ;                                       \ clr r1                                                        : clr  %g0 %g0 2rot or ;                                        : %or  or ;  \ used below                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Assemblers 364                                                                                              \ sparc assembler - #7                                                                                                                                                                          also forth                                                                                                                      \ set                                                           : set  ( n 1 r 0 -- )                                             2swap 0= abort" expected immediate"                             dup 1fff and 0=  if  %hi 1 2swap  sethi  exit  then             dup d# -4096 d# 4096 within  if                                   >r  %g0  2swap  r> 1  2swap %or  exit  then \ XXX correct fo \ r <0?                                                          dup >r %hi 2over sethi  r> %lo 2over  %or ;                   variable cond                                                   : >  2 cond ! ;     : u>  40 cond ! ;   : <  0b cond ! ;        : u<  0d cond ! ;   : =  9 cond ! ;     : <>  1 cond ! ;        : cc?  5 cond ! ;   : cs?  0d cond ! ;  : 0<  0e cond ! ;       : 0>  6 cond ! ;    : 0=  9 cond ! ;    : 0<>  1 cond ! ;       : <=  0a cond ! ;   : >=  3 cond ! ;                            \ control structures                                            : patchj  ( from to -- )                                          over - 2/ 2/ 3fffff and  over asm@ or  swap asm! ;            : %if  ( -- a ) asmhere  cond @ d# 25 lshift  800000 or asm,      nop ;                                                         : if  %if ;                                                     : then  ( a -- ) asmhere patchj ;                               : branch,  ( -- a ) asmhere  10800000 asm,  nop ;               : else  ( a1 -- a2 ) branch,  swap asmhere patchj ;             : begin  ( -- a ) asmhere ;                                     : again  ( a -- ) branch,  swap patchj ;                        : until  ( a -- ) %if  swap patchj ;                            : while  ( a1 -- a1 a2 ) %if ;                                  : repeat  ( a1 a2 -- )                                            asmhere >r  swap ba  nop  r> asmhere patchj ;                 previous                                                        \ next                                                          create (next)                                                     %g4 ) %g5 ld                                                    4 # %g4 inc                                                     %g5 ) %l1 ld                                                    %l1 ) jmp                                                       nop                                                           : next  (next) ba  nop ;                                                                                                        previous  also forth definitions  also assembler                                                                                : code  ( | name -- )                                             create  asmhere dup 1 cells - ! ( cfa -> paramfield )           also assembler ;                                              : end-code  previous ;                                                                                                          previous previous                                               decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ MIPS assembler #1                                                                                                             \ Instruction format:                                           \                                                               \   s t d <instr>       (R)                                     \   s t <instr>         (R*)                                    \   d <instr>           (Rd)                                    \   t imm d <instr>     (R/shift)                               \   s imm t <instr>     (I)                                     \   imm t <instr>       (I*)                                    \   addr s t <instr>    (I/branch)                              \   addr s <instr>      (I/branch*)                             \   addr <instr>        (J)                                     \   s d <instr>         (jalr)                                  \   s <instr>           (jr)                                    \                                                               \ # marks immediate                                             \ $ is a synonym for the current assembly location              \ ) is a synonym for "0 #"                                      \                                                               \ conditions: >  <  =  <>  0<  0>  0=  0<>  <=  >=  u<  u>      \   *  a condition takes either a single register argument (`0= \ `, `0<>`)                                                     \     or two arguments, of which one may be immediate.          \                                                               \ conditionals: if  then  else  begin  while  repeat  until     \                                                               \ pseudo instructions:                                          \                                                               \ noop  move  clear  not  li  mul  rem  b                       \                                                               \ set the deferred words `asm@`, `asm!`, `asmhere!` and         \  `ashmere`                                                    \ to customize target code addressing.                                                                                          vocabulary assembler    also assembler definitions              hex                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ MIPS assembler #2                                                                                                             : register  ( u | name -- ) <builds  ,  does>  @ 0 ;            0 register $0       0 register $zero                            1 register $1       1 register $at                              2 register $2       2 register $v0                              3 register $3       3 register $v1                              4 register $4       4 register $a0                              5 register $5       5 register $a1                              6 register $6       6 register $a2                              7 register $7       7 register $a3                              8 register $8       8 register $t0      8 register $a4          9 register $9       9 register $t1      9 register $a5          0a register $10     0a register $t2     0a register $a6         0b register $11     0b register $t3     0b register $a7         0c register $12     0c register $t4                             0d register $13     0d register $t5                             0e register $14     0e register $t6                             0f register $15     0f register $t7                             10 register $16     10 register $s0                             11 register $17     11 register $s1                             12 register $18     12 register $s2                             13 register $19     13 register $s3                             14 register $20     14 register $s4                             15 register $21     15 register $s5                             16 register $22     16 register $s6                             17 register $23     17 register $s7                             18 register $24     18 register $t8                             19 register $25     19 register $t9                             1a register $26     1a register $k0                             1b register $27     1b register $k1                             1c register $28     1c register $gp                             1d register $29     1d register $sp                             1e register $30     1e register $fp                             1f register $31     1f register $ra                             defer asm@       ' @ is asm@                                    defer asm!       ' ! is asm!                                    defer asmhere    ' here is asmhere                              defer asmhere!   :noname h ! ; is asmhere!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ MIPS assembler #3                                                                                                             : asm,  ( x -- ) asmhere asm!  1 cells asmhere + asmhere! ;     : rs  ( r 0 -- u ) abort" expected s register"  d# 21 lshift ;  : rt  ( r 0 -- u ) abort" expected t register"  d# 16 lshift ;  : rd  ( r 0 -- u ) abort" expected d register"  d# 11 lshift ;  : imm16  ( n 1 -- u ) 0= abort" expected 16-bit immediate"        ffff and ;                                                    : off16  ( addr -- u ) asmhere cell+ 2 rshifta - ffff and ;     : shamt  ( n 1 -- u )                                             0= abort" expected shift amount"                                1f and  d# 6 lshift ;                                         : rop  ( s 0 t 0 d 0 a -- u ) @ -rot rd or -rot rt or -rot rs or  ;                                                             : r2op  ( s 0 t 0 a -- u ) @ -rot rt or -rot rs or ;            : rsop  ( t 0 imm 1 d 0 a -- u )                                  @ -rot rd or -rot shamt or -rot rt or ;                       : iop  ( s 0 imm 1 t 0 a -- u )                                   @ -rot rt or -rot imm16 or -rot rs or ;                       : ibop  ( addr s 1 t 0 a -- u )                                   @ -rot rt or -rot rs or swap off16 or ;                       : ib1op  ( addr s 1 a -- u ) @ -rot rs or swap off16 or ;       : jop  ( addr a -- u ) @  swap 2 rshift 3ffffff and or ;        : opr  ( op/fun | name -- ) <builds  ,  does>  rop asm, ;       : opr2  ( op/fun | name -- ) <builds  ,  does>  r2op asm, ;     : opi  ( op | name -- ) <builds  ,  does>  iop asm, ;           : opib  ( op | name -- ) <builds  ,  does>  ibop asm, ;         : opib1  ( op | name -- ) <builds  ,  does>  ib1op asm, ;       : opj  ( op | name -- ) <builds  ,  does>  jop asm, ;           : oprs  ( op | name -- ) <builds  ,  does>  rsop asm, ;         : #  ( n -- n 1 ) 1 ;                                           : $  ( -- a ) asmhere ;                                         : )  ( -- 0 1 ) 0 1 ;                                           \ instructions                                                  10000000 opib beq           14000000 opib bne                   04110000 opib1 bgez         04100000 opib1 bltzal               04110000 opib1 bgezal       1c000000 opib1 bgtz                 18000000 opib1 blez         04000000 opib1 bltz                 1a opr2 div     1b opr2 divu                                    18 opr2 mult    18 opr2 multu                                   08000000 opj j      0c000000 opj jal                            80000000 opi lb     8c000000 opi lw         90000000 opi lbu    84000000 opi lh     94000000 opi lhu        ac000000 opi sw     34000000 opi ori    a0000000 opi sb         38000000 opi xori   28000000 opi slti   2c000000 opi sltiu      a4000000 opi sh     20000000 opi addi   24000000 opi addiu      30000000 opi andi   88000000 opi lwl    98000000 opi lwr        a8000000 opi swl    b8000000 opi swr                                                e0000000 opi sc     c0000000 opi ll     \ mips II               25 opr or       26 opr xor      27 opr nor                      04 opr sllv     2a opr slt      2b opr sltu                     06 opr srlv     22 opr sub      23 opr subu                     20 opr add      21 opr addu     24 opr and                      07 opr srav                                                     0 oprs sll      03 oprs sra     02 oprs srl                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ MIPS assembler #4                                                                                                             : syscall  0c asm, ;        : break  0d asm, ;                  : sync  0f asm, ;       \ mips II                               also forth                                                      : lui  ( imm 1 t 0 -- )                                           rt -rot  imm16 or  3c000000  or asm, ;                        : jr  ( s 0 -- )  rs 08 or asm, ;                               : jalr  ( s 0 d 0 -- )  rd  rs or  09 or asm, ;                 : mthi  ( s 0 -- ) rs 11 or asm, ;                              : mtlo  ( s 0 -- ) rs 13 or asm, ;                              : mfhi  ( d 0 -- ) rd 10 or asm, ;                              : mflo  ( d 0 -- ) rd 12 or asm, ;                              \ pseudo instructions                                           : nop  00000000 asm, ;                                          : move  ( s 1 t 1 -- ) $0 2swap add ;                           : clear  ( t 1 -- ) $0 $0 2rot add ;                            : not  ( s 1 t 1 -- ) $0 2swap nor ;                            : b  ( addr -- ) $0 $0 beq ;                                    : li  ( imm 1 d 0 -- )                                            abort" expected d register"  >r                                 0= abort" expected immediate"                                   dup d# -32768 d# 32768 within 0=  if                              dup d# 16 rshift 1 r@ 0 lui                                   then                                                            ffff and  r@ 0  rot 1  r> 0  ori ;                            : mul  ( s 1 t 1 d 1 -- ) 2>r mult  2r> mflo ;                  : rem  ( s 1 t 1 d 1 -- ) 2>r div  2r> mfhi ;                   \ comparisons                                                   variable condop                                                 : conds  ( op | name -- )                                         <builds  ,  does>  ( s 0 a -- ) @ -rot rs or  condop ! ;      : toreg  ( x f -- r 0 ) dup  if  $0 $at ori  $at  then ;        : condst  ( op | name -- )                                        <builds  ,  does>  ( s sm t tm a -- )                           @ >r  toreg rt r> or  -rot toreg rs or  condop ! ;            10000000 conds 0<>      14000000 conds 0=                       04010000 conds 0<       18000000 conds 0>                       10000000 condst <>       14000000 condst =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ "ff" sources 10 - Assemblers 364                                                                                              \ MIPS assembler #5 (end)                                                                                                       : cmpst  ( s t sltx br -- )                                       >r >r  toreg rt  -rot  toreg rs or  $at rd or  r> or asm,       $at rs  $0 rt or  r> or  condop ! ;                           : <=  ( s t -- ) 2swap 2a 14000000 cmpst ;                      : >=  ( s t -- ) 2a 14000000 cmpst ;                            : <  ( s t -- ) 2a 10000000 cmpst ;                             : >  ( s t -- ) 2swap 2a 10000000 cmpst ;                       : u<  ( s t -- ) 2b 10000000 cmpst ;                            : u>  ( s t -- ) 2swap 2b 10000000 cmpst ;                      \ control structures                                            : patchj  ( from to -- )                                          over - 2/ 2/ 1- ffff and  over asm@ or  swap asm! ;           : %if  ( -- a ) asmhere  condop @ asm,  nop ;                   : if  %if ;                                                     : then  ( a -- ) asmhere patch ;                                : branch,  ( -- a ) asmhere  10000000 asm,  nop ; \ beq $0 $0   : else  ( a1 -- a2 ) branch,  swap asmhere patchj ;             : begin  ( -- a ) asmhere ;                                     : again  ( a -- ) branch,  swap patchj ;                        : until  ( a -- ) %if  swap patchj ;                            : while  ( a1 -- a1 a2 ) %if ;                                  : repeat  ( a1 a2 -- )                                            asmhere >r  swap off16 10000000 or asm,  nop                    r> asmhere patchj ;                                           previous                                                        \ assuming: TOS = $2, SP = $29, RP = $30, AP = $28, W = $25     create (next)                                                     $28 ) $25 lw                                                    $28 4 # $28 addi                                                $25 ) $3 lw                                                     nop               \ LDS                                         $3 jr                                                           nop                                                           : next  (next) b  nop ;                                                                                                         previous  also forth definitions  also assembler                                                                                : code  ( | name -- )                                             create  asmhere dup 1 cells - ! ( cfa -> paramfield )           also assembler ;                                              : end-code  previous ;                                                                                                          only forth definitions                                          decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #1                                                                                                           \ Instruction format:                                           \                                                               \ rd rs1 rs2 <instr>    R-type                                  \ rd rs1 imm <instr>    I-type                                  \ rs2 rs1 a <instr>     S-type                                  \ rs1 rs2 imm <instr>   SB-type                                 \ rd a <instr>          jal                                     \ rd imm <instr>        li                                      \ <instr>               ecall ebreak fence.i                    \ pred succ <instr>     fence                                   \ a <instr>             j                                       \ rd rs1 a <instr>      jalr                                    \ rd rs <instr>         mv                                      \                                                               \ rounding mode suffixes: rne rtz rdn rup rmm                   \ aq/rl suffixes: aq rl                                         \                                                               \ conditionals: <> = >= <= > < u> u< 0= 0<>                     vocabulary assembler    also assembler definitions                                                                              : register  ( u | name -- ) <builds  ,  does>  @ 0 ;            \ note: assumes host is little-endian                           defer asm@       ' @ is asm@                                    defer asm!       ' ! is asm!                                    defer asmhere    ' here is asmhere                              defer asmhere!   :noname h ! ; is asmhere!                      : asm,  ( x -- ) asmhere asm!  1 cells asmhere + asmhere! ;     0 register x0       1 register x1       2 register x2           3 register x3       4 register x4       5 register x5           6 register x6       7 register x7       8 register x8           9 register x9       10 register x10     11 register x11         12 register x12     13 register x13     14 register x14         15 register x15     16 register x16     17 register x17         18 register x18     19 register x19     20 register x20         21 register x21     22 register x22     23 register x23         24 register x24     25 register x25     26 register x26         27 register x27     28 register x28     29 register x29         30 register x30     31 register x31                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #2                                                                                                                                                                           0 register f0       1 register f1       2 register f2           3 register f3       4 register f4       5 register f5           6 register f6       7 register f7       8 register f8           9 register f9       10 register f10     11 register f11         12 register f12     13 register f13     14 register f14         15 register f15     16 register f16     17 register f17         18 register f18     19 register f19     20 register f20         21 register f21     22 register f22     23 register f23         24 register f24     25 register f25     26 register f26         27 register f27     28 register f28     29 register f29         30 register f30     31 register f31                             1 register ra       2 register sp       3 register gp           4 register tp       5 register t0       6 register t1           7 register t2       8 register s0       8 register fp           9 register s1       10 register a0      11 register a1          12 register a2      13 register a3      14 register a4          15 register a5      16 register a6      17 register a7          18 register s2      19 register s3      20 register s4          21 register s5      22 register s6      23 register s7          24 register s8      25 register s9      26 register s10         27 register s11     28 register t3      29 register t4          30 register t5      31 register t6                              : +reg  ( 0 -- ) abort" expected register" ;                    : +imm  ( 1 -- ) 0= abort" expected immediate" ;                : rs1  ( r 0 -- u ) +reg  15 lshift ;                           : rs2  ( r 0 -- u ) +reg  20 lshift ;                           : rs3  ( r 0 -- u ) +reg  27 lshift ;                           : rd  ( r 0 -- u ) +reg  7 lshift ;                             : immi  ( x 1 -- u ) +imm  20 lshift ;                          : imms  ( x 1 -- u )                                              +imm  dup h# 1f and 7 lshift  swap 20 lshift or ;             : immu  ( x 1 -- u ) +imm  12 lshift ;                          : zimm  ( x 1 -- u ) +imm  h# 1f and  15 lshift  ;              : sboff  ( x -- u )                                               \ ____ ____ ____ ____ ___A BCCC CCCD DDD_                       \ ACCC CCCX XXXX YYYY YZZZ DDDD BOOO OOOO                       dup h# 1000 and 19 lshift         \ A                           over h# 3e0 and 20 lshift or      \ C                           over h# 1e and 7 lshift or        \ D                           swap h# 800 and 4 rshift or ;     \ B                         : ujoff  ( x -- u )                                               \ ____ ____ ___A BBBB BBBB CDDD DDDD DDD_                       \ ADDD DDDD DDDC BBBB BBBB XXXX XOOO OOOO                       dup h# 100000 and 11 lshift       \ A                           over h# 7fe and 20 lshift or      \ D                           over h# 800 and 9 lshift or       \ C                           swap h# ff000 and or ;            \ B                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #3                                                                                                           : rtype  ( op | name -- )                                         <builds  ,  does>  ( rd 0 rs1 0 rs2 0 -- )                      @ >r  rs2 -rot  rs1 or  -rot rd or  r> or asm, ;              : rtype2  ( op | name -- )                                        <builds  ,  does>  ( rd 0 rs1 0 -- )                            @ >r  rs1 -rot  rd or  r> or asm, ;                           : r4type  ( op | name -- )                                        <builds  ,  does>  ( rd 0 rs1 0 rs2 0 rs3 -- )                  @ >r  rs3 -rot  rs2 or -rot  rs1 or  -rot rd or                 r> or asm, ;                                                  : itype  ( op | name -- )                                         <builds  ,  does>  ( rd 0 rs1 0 x 1 -- )                        @ >r  immi -rot  rs1 or  -rot rd or  r> or asm, ;             : stype  ( op | name -- )                                         <builds  ,  does>  ( rs2 0 rs1 0 x 1 -- )                       @ >r  imms -rot  rs1 or  -rot rs2 or  r> or asm, ;            : utype  ( op | name -- )                                         <builds  ,  does>  ( rd 0 x 1 -- )                              @ >r  immu -rot  rd or  r> or asm, ;                          : sbtype  ( op | name -- )                                        <builds  ,  does>  ( rs1 0 rs2 0 a -- )                         @ >r  asmhere swap - sboff -rot  rs2 or -rot  rs1 or            r> or asm, ;                                                  : csrtype  ( op | name -- )                                       <builds  ,  does>  ( csr rd 0 rs1 0 -- )                        @ >r  rs1 -rot  rd or  swap 20 lshift  or  r> or asm, ;       : csritype  ( op | name -- )                                      <builds  ,  does>  ( csr rd 0 x 1 -- )                          @ >r  zimm -rot  rd or  swap 20 lshift or  r> or asm, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #4                                                                                                           hex                                                             37 utype lui        17 utype auipc                              0003 itype lb       1003 itype lh                               2003 itype lw       4003 itype lbu      5003 itype lhu          0013 itype addi     2013 itype slti     3013 itype sltiu        4013 itype xori     6013 itype ori      7013 itype andi         1013 itype slli     5013 itype srli     40005013 itype srai     2007 itype flw      3007 itype fld                              0063 sbtype beq     1063 sbtype bne     4063 sbtype blt         5063 sbtype bge     6063 sbtype bltu    7063 sbtype bgeu        0023 stype sb       1023 stype sh       2023 stype sw           2027 stype fsw      3927 stype fsd                              00000033 rtype add      40000033 rtype sub                      00001033 rtype sll      00002033 rtype slt                      00003033 rtype sltu     00004033 rtype xor                      00005033 rtype srl      40005033 rtype sra                      02000033 rtype mul      02001033 rtype mulh                     02002033 rtype mulhsu   02003033 rtype mulhu                    02004033 rtype div      02005033 rtype divu                     02006033 rtype rem      02007033 rtype remu                     1800202f rtype sc.w     1c00202f rtype sc.w.aq                  1a00202f rtype sc.w.rl  1e99292f rtype sc.w.aq.rl               0800202f rtype amoswap.w    0000202f rtype amoadd.w             2000202f rtype amoxor.w     6000202f rtype amoand.w             4000202f rtype amoor.w      8000202f rtype amomin.w             a000202f rtype amomax.w     c000202f rtype amominu.w            e000202f rtype amomaxu.w                                        00000053 rtype fadd.s       08000053 rtype fsub.s               10000053 rtype fmul.s       18000053 rtype fdiv.s               58000053 rtype2 fsqrt.s     20000053 rtype fsgnj.s              20001053 rtype fsgnjn.s     20002053 rtype fsgnjx.s             28000053 rtype fmin.s       28001053 rtype fmax.s               c0000053 rtype2 fcvt.w.s    e0000053 rtype2 fmv.x.s             a0002053 rtype feq.s        a0001053 rtype flt.s                a0000053 rtype fle.s        e0001053 rtype2 fclass.s            d0000053 rtype2 fcvt.s.w    f0000053 rtype2 fmv.s.x             02000053 rtype fadd.d       0a000053 rtype fsub.d               12000053 rtype fmul.d       1a000053 rtype fdiv.d               5a000053 rtype2 fsqrt.d     22000053 rtype fsgnj.d              22001053 rtype fsgnjn.d     22002053 rtype fsgnjx.d             2a000053 rtype fmin.d       2a001053 rtype fmax.d               c2000053 rtype2 fcvt.w.d    d2000053 rtype fcvt.d.w             00000043 r4type fmadd.s     00000047 r4type fmsub.s             0000004b r4type fnmsub.s    0000004f r4type fnmadd.s            02000043 r4type fmadd.d     02000047 r4type fmsub.d             0200004b r4type fnmsub.d    0200004f r4type fnmadd.d            1073 csrtype csrrw      2073 csrtype csrrs                      3073 csrtype csrrc                                              507e csritype csrrwi    6073 csritype csrrsi                    7073 csritype csrrci                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #5                                                                                                           : jal  ( rd 0 a -- ) asmhere - ujoff -rot  rd or  6f or asm, ;  : jalr  ( rd 0 rs1 0 a -- )                                       >r rs1  -rot rd or  r> asmhere - 1 immi or  0067 or asm, ;    : fcvt.wu.s  ( rd 0 rs1 0 -- ) rs1 -rot  rd or  c0100053 or asm, ;                                                              : fcvt.s.wu  ( rd 0 rs1 0 -- ) rs1 -rot  rd or  d0100053 or asm, ;                                                              : fcvt.wu.d  ( rd 0 rs1 0 -- ) rs1 -rot  rd or  c2100053 or asm, ;                                                              : fcvt.d.wu  ( rd 0 rs1 0 -- ) rs1 -rot  rd or  c2100053 or asm, ;                                                              : fence  ( pred succ -- )                                         d# 20 lshift  swap 24 lshift or  0f or asm, ;                 : fence.i  100f asm, ;                                          : lr.w  ( rd 0 rs1 0 -- ) rs1 -rot  rd or 1000202f or asm, ;    : lr.w.aq  ( rd 0 rs1 0 -- ) rs1 -rot  rd or 1400202f or asm, ; : lr.w.rl  ( rd 0 rs1 0 -- ) rs1 -rot  rd or 1200202f or asm, ; : lr.w.aq.rl  ( rd 0 rs1 0 -- ) rs1 -rot  rd or 1600202f or asm, ;                                                              : csrr  ( csr rd 1 -- ) x0 2swap csrrs ;                        : csrw  ( csr rs 1 -- ) x0 csrrw ;                              : csrwi  ( csr x 1 -- ) x0 csrrwi ;                             : ecall  00000073 asm, ;        : ebreak  001000073 asm, ;      : #  ( n -- n 1 ) 1 ;                                           : )  ( r 0 -- r 0 0 1 ) 0 1 ;                                   : $  ( -- a ) asmhere ;                                         : mv  ( rd 0 rs 0 -- ) 0 # addi ;                               : subi  ( rd 0 rs 0 x 1 -- ) swap negate swap addi ;            : not  ( rd 0 rs 0 -- ) -1 # xori ;                             : nop  x0 x0 0 # addi ;                                         : li  ( rd 0 imm 1 -- )                                           +imm  dup d# -2048 d# 2047 within 0=  if                          >r 2dup  r@ d# 12 rshift # lui  2dup r> # ori                 else  x0 rot # addi  then ;                                   : suffix  ( u -- ) asmhere 1 cells - dup asm@ rot or swap asm!    ;                                                             : rm  ( rm -- ) d# 12 lshift suffix ;                           : rne  0 rm ;       : rtz  1 rm ;       : rdn  2 rm ;           : rup  3 rm ;       : rmm  4 rm ;                               : aq/rl  ( u -- ) d# 25 lshift suffix ;                         : aq  2 aq/rl ;     : rl  1 aq/rl ;                             : beqz  ( rs 0 a -- ) x0 rot beq ;                              : bnez  ( rs 0 a -- ) x0 rot bne ;                              : blez  ( rs 0 a -- ) >r x0 2swap r> bge ;                      : bgez  ( rs 0 a -- ) x0 rot bge ;                              : bltz  ( rs 0 a -- ) x0 rot blt ;                              : bgtz  ( rs 0 a -- ) >r x0 2swap r> blt ;                      : j  ( a -- ) x0 rot jal ;                                      : jr  ( r 0 -- ) x0 2swap asmhere jalr ;                        : ret  x0 x1 0 jalr ;                                           : neg  x0 2swap sub ;       : seqz  1 # sltiu ;                 : snez  x0 2swap sltu ;     : sltz  x0 slt ;                    : sgtz  x0 2swap slt ;      : fmv.s  2dup fsgnj.s ;             : fabs.s  2dup fsgnjx.s ;   : fneg.s  2dup fsgnjn.s ;           : fmv.d  2dup fsgnj.d ;     : fabs.d  2dup fsgnjx.d ;           : fneg.d  2dup fsgnjn.d ;                                                                                                                                                                                                                                       \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ RISC-V assembler #6 (end)                                                                                                     \ comparisons                                                   also forth                                                      variable condop                                                 : toreg  ( x f -- r 0 ) dup  if  x5 2swap li  x5  then ;        : condargs  ( rs1 0 rs2 0 op -- )                                 >r  toreg rs2  -rot toreg rs1 or  r> or condop ! ;            : cond  ( op | name -- )                                          <builds  ,  does>  ( rs1 0 rs2 0 a -- ) @ condargs ;          : conds ( op | name -- )                                          <builds  ,  does>  ( rs1 0 rs2 0 a -- ) @ >r 2swap r> condargs  ;                                                             0063 cond <>    1063 cond =     4063 conds <=                   4063 cond >=    5063 cond <     5063 conds >                    7063 cond u<    7063 conds u>                                   : 0=  ( x f -- ) x0 1063 condargs ;                             : 0<>  ( x f -- ) x0 0063 condargs ;                            \ control structures                                            : patchj  ( from to -- ) over - sboff  over asm@ or  swap asm! ;: %if  ( -- a ) asmhere  condop @ asm, ;                        : if  %if ;                                                     : then  ( a -- ) asmhere patchj ;                               : branch,  ( -- a ) asmhere  63 asm, ;  \ beq x0, x0, ...       : else  ( a1 -- a2 ) branch,  swap asmhere patchj ;             : begin  ( -- a ) asmhere ;                                     : again  ( a -- ) branch,  swap patchj ;                        : until  ( a -- ) %if  swap patchj ;                            : while  ( a1 -- a1 a2 ) %if ;                                  : repeat  ( a1 a2 -- )                                            asmhere >r  swap sboff 63 or asm,  r> asmhere patchj ;        previous                                                        \ because we need `or` above                                    00006033 rtype or       00007033 rtype and                      \ assuming: TOS = x10, SP = x2, RP = x3, AP = x18, W = x19      \ x5: temporary, also used in conditionals                      create (next)                                                     x19 x18 ) lw                                                    x18 x18 4 # addi                                                x5 x19 ) lw                                                     x5 jr                                                         : next  (next) j ;                                                                                                              previous  also forth definitions  also assembler                                                                                : code  ( | name -- )                                             create  asmhere dup 1 cells - ! ( cfa -> paramfield )           also assembler ;                                              : end-code  previous ;                                                                                                          only forth definitions                                                                                                          decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #1                                                                                                            \ Instruction format:                                           \                                                               \   rT rA rB <instr>                                            \   rT rA <imm> <instr>                                         \   rT rA <instr>                                               \   rA rS rB <instr>                                            \   rS rA rB <instr>                                            \   rA rS <imm> <instr>                                         \   <addr> <instr>                                              \   BO BI <addr> <instr>                                        \   BIF <addr> <instr>                                          \   BO BI <instr>                                               \   BIF <addr> <instr>                                          \   crT L rA rB <instr>                                         \   crT rA rB <instr>                                           \   rA rS <instr>                                               \   bT bA bB <instr>                                            \   bT bA <instr>                                               \   rA rB <instr>                                               \   <instr>                                                     \   rT rB <instr>                                               \   rT rA rB rC <instr>                                         \   rT rA rC <instr>                                            \   crT crS <instr>                                             \   rT <instr>                                                  \   rT SPR/TBR <instr>                                          \   crMASK rS <instr>                                           \   bit <instr>                                                 \   frMASK rB <instr>                                           \   SPR rS <instr>                                              \   rA rS n mB mE <instr>                                       \   rA rS n nB sh <instr>                                       \   rA rS n nB <instr>                                          \   rA rS rB mB mE <instr>                                      \   TO rA rB <instr>                                            \   TO rA <imm> <instr>                                         \                                                               \ conditionals: = <> > < >= <= so? ns?                          vocabulary assembler    also assembler definitions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #2                                                                                                            : register  ( u | name -- ) <builds  ,  does>  @ 0 ;            \ note: assumes host is big-endian                              defer asm@       ' @ is asm@                                    defer asm!       ' ! is asm!                                    defer asmhere    ' here is asmhere                              defer asmhere!   :noname h ! ; is asmhere!                      : asm,  ( x -- ) asmhere asm!  1 cells asmhere + asmhere! ;     0 register r0       1 register r1       2 register r2           3 register r3       4 register r4       5 register r5           6 register r6       7 register r7       8 register r8           9 register r9       10 register r10     11 register r11         12 register r12     13 register r13     14 register r14         15 register r15     16 register r16     17 register r17         18 register r18     19 register r19     20 register r20         21 register r21     22 register r22     23 register r23         24 register r24     25 register r25     26 register r26         27 register r27     28 register r28     29 register r29         30 register r30     31 register r31                             0 register fr0       1 register fr1       2 register fr2        3 register fr3       4 register fr4       5 register fr5        6 register fr6       7 register fr7       8 register fr8        9 register fr9       10 register fr10     11 register fr11      12 register fr12     13 register fr13     14 register fr14      15 register fr15     16 register fr16     17 register fr17      18 register fr18     19 register fr19     20 register fr20      21 register fr21     22 register fr22     23 register fr23      24 register fr24     25 register fr25     26 register fr26      27 register fr27     28 register fr28     29 register fr29      30 register fr30     31 register fr31                           0 constant crf0     1 constant crf1     2 constant crf2         3 constant crf3     4 constant crf4     5 constant crf5         6 constant crf6     7 constant crf7                             : +imm  ( 1 -- ) 0= abort" expected immediate" ;                : rC  ( u 0 -- u ) abort" expected register"  6 lshift ;        : rB  ( u 0 -- u ) abort" expected register"  11 lshift ;       : rA  ( u 0 -- u ) abort" expected register"  16 lshift ;       : rT  ( u 0 -- u ) abort" expected register"  21 lshift ;       : SI  ( x 1 -- u ) +imm h# ffff and ;                           : BO  ( bo -- u ) 21 lshift ;       : BI  ( bi -- u ) 16 lshift   ;                                                             : BIF  ( bi -- u ) 18 lshift ;                                  : absBD  ( addr -- u ) h# fffc and ;                            : absLI  ( addr -- u ) h# 03fffffc and ;                        : relLI  ( addr -- u ) asmhere swap - absLI ;                   : relBD  ( addr -- u ) asmhere swap - absBD ;                   : crT  ( u1 -- u2 ) 23 lshift ;                                 : crS  ( u1 -- u2 ) 18 lshift ;                                 : LF  ( l -- u ) 21 lshift ;                                    : bT  ( u1 -- u2 ) 21 lshift ;                                  : bA  ( u1 -- u2 ) 16 lshift ;                                  : bB  ( u1 -- u2 ) 11 lshift ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #3                                                                                                            : SPR  ( SPR -- u )                                               dup h# 1f and 16 lshift  swap h# 3e0 and 11 lshift or           h# 1ff800 and ;                                               : TAB  ( code | name -- )                                         <builds  ,  does>  @ >r  rB -rot  rA or -rot  rT or  r> or      asm, ;                                                        : TAC  ( code | name -- )                                         <builds  ,  does>  @ >r  rC -rot  rA or -rot  rT or  r> or      asm, ;                                                        : TABC  ( code | name -- )                                        <builds  ,  does>  @ >r  rC -rot  rB -rot  rA or -rot  rT or    r> or asm, ;                                                  : TACB  ( code | name -- )                                        <builds  ,  does>  @ >r  rB -rot  rC -rot  rA or -rot  rT or    r> or asm, ;                                                  : ASB  ( code | name -- )                                         <builds  ,  does>  @ >r  rB -rot  rT or -rot  rA or  r> or      asm, ;                                                        : TASI  ( code | name -- )                                        <builds  ,  does>  @ >r  SI -rot  rA or -rot  rT or  r> or      asm, ;                                                        : ASUI  ( code | name -- )                                        <builds  ,  does>  @ >r  SI -rot  rT or -rot  rA or  r> or      asm, ;                                                        : TA  ( code | name -- )                                          <builds  ,  does>  @ >r  rA -rot  rT or  r> or asm, ;         : AB  ( code | name -- )                                          <builds  ,  does>  @ >r  rB -rot  rA or  r> or asm, ;         : LI  ( rel? code | name -- )                                     <builds  , ,  does>  @+ >r  @  if  relLI  then  r> or asm, ;  : BOBIBD  ( rel? bo bi code | name -- )                           <builds  , , , ,  does>  @+ >r  @+ BI >r  @+ BO >r              @  if  relBD  else  absBD  then  r> or  r> or  >r or asm, ;   : BOBIFBD  ( rel? bo code | name -- )                             <builds  , , ,  does>  @+ >r  @+ BO >r                          @  if  relBD  else  absBD  then  r> or  r> or  swap BIF or      asm, ;                                                        : BOBI  ( bo bi code | name -- )                                  <builds  , , ,  does>  @+ >r  @+ BI >r  @ BO r> or r> or asm,   ;                                                             : BOBIF  ( bo code | name -- )                                    <builds  , ,  does>  @+ >r  @ BO r> or swap BIF or asm, ;     : cTLAB  ( code | name -- )                                       <builds  ,  does>  @ >r  rB -rot  rA or  swap LF or  swap crT   or  r> or asm, ;                                              : cTAB  ( code | name -- )                                        <builds  ,  does>  @ >r  rB -rot  rA or  swap crT or  r> or     asm, ;                                                        : cTLASI  ( code | name -- )                                      <builds  ,  does>  @ >r  SI -rot  rA or  swap LF or  swap crT   or  r> or asm, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #4                                                                                                            : bTAB  ( code | name -- )                                        <builds  ,  does>  @ >r  bB swap  bA or swap  bT or r> or asm, ;                                                              : AS  ( code | name )                                             <builds  ,  does>  @ >r  rT -rot  rA or  r> or asm, ;         : TB  ( code | name -- )                                          <builds  ,  does>  @ >r  rB -rot  rT or  r> or asm, ;         : cTcS  ( code | name -- )                                        <builds  ,  does>  @ >r  crS swap crT or  r> or asm, ;        : ASnBE  ( code | name -- )                                       <builds  ,  does>  @ >r  1 lshift  swap 6 lshift or             swap 11 lshift or  -rot rT or  -rot rA or  r> or asm, ;       : ASBBE  ( code | name -- )                                       <builds  ,  does>  @ >r  1 lshift  swap 6 lshift or             -rot rB or  -rot rT or  -rot rA or  r> or asm, ;              : cT  ( code | name -- ) <builds  ,  does>  @ >r  crT  r> or      asm, ;                                                        : RT  ( code | name -- ) <builds  ,  does>  @ >r  rT  r> or       asm, ;                                                        : BT  ( code | name -- ) <builds  ,  does>  @ >r  bT  r> or       asm, ;                                                        : #  ( n -- n 1 ) 1 ;                                           : )  ( r 0 -- r 0 0 1 ) 0 1 ;                                   : $  ( -- a ) asmhere ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #5                                                                                                            hex                                                             7c000214 TAB add      7c000215 TAB add.                         7c000614 TAB addo     7c000615 TAB addo.                        7c000014 TAB addc     7c000015 TAB addc.                        7c000414 TAB addco    7c000415 TAB addco.                       7c000114 TAB adde     7c000115 TAB adde.                        7c000514 TAB addeo    7c000515 TAB addeo.                       7c0003d6 TAB divw     7c0003d7 TAB divw.                        7c0007d6 TAB divwo    7c0007d7 TAB divwo.                       7c000396 TAB divwu    7c000397 TAB divwu.                       7c000796 TAB divwuo   7c000797 TAB divwuo.                      7c00026c TAB eciwx    7c00036c TAB ecowx                        fc00002a TAB fadd     fc00002b TAB fadd.                        ec00002a TAB fadds    ec00002b TAB fadds.                       fc000024 TAB fdiv     fc000024 TAB fdiv.                        ec000024 TAB fdivs    ec000024 TAB fdivs.                       fc000028 TAB fsub     fc000029 TAB fsub.                        ec000028 TAB fsubs    ec000029 TAB fsubs.                       7c0000ee TAB lbzux    7c0000ae TAB lbzx                         7c0004ee TAB lfdux    7c0004ae TAB lfdx                         7c00046e TAB lfsux    7c00042e TAB lfsx                         7c0002ee TAB lhaux    7c0002ae TAB lhax                         7c00062c TAB lhbrx    7c00026e TAB lhzux                        7c00022e TAB lhzx     7c00042a TAB lswx                         7c000028 TAB lwarx    7c00042c TAB lwbrx                        7c00006e TAB lwzux    7c00002e TAB lwzx                         7c000092 TAB mulhw    7c000093 TAB mulhw.                       7c000016 TAB mulhwu   7c000017 TAB mulhwu.                      7c0001d6 TAB mullw    7c0001d7 TAB mullw.                       7c0005d6 TAB mullwo   7c0005d7 TAB mullwo.                      7c0001ee TAB stbux    7c0001ae TAB stbx                         7c0005ee TAB stfdux   7c0005ae TAB stfdx                        7c00056e TAB stfsux   7c00052e TAB stfsx                        7c00072c TAB sthbrx   7c00036e TAB sthux                        7c00032e TAB sthx     7c00052a TAB stswx                        7c00052c TAB stwbrx   7c00012d TAB stwcx.                       7c00016e TAB stwux    7c00012e TAB stwx                         7c000050 TAB subf     7c000051 TAB subf.                        7c000450 TAB subfo    7c000451 TAB subfo.                       7c000010 TAB subfc    7c000011 TAB subfc.                       7c000410 TAB subfco   7c000411 TAB subfco.                      7c000110 TAB subfe    7c000111 TAB subfe.                       7c000510 TAB subfeo   7c000511 TAB subfeo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #6                                                                                                            \ unimplemented: stfiwx                                         38000000 TASI addi    30000000 TASI addic                       34000000 TASI addic.  3c000000 TASI addis                       88000000 TASI lbz     8c000000 TASI lbzu                        c8000000 TASI lfd     cc000000 TASI lfdu                        c0000000 TASI lfs     c4000000 TASI lfsu                        a8000000 TASI lha     ac000000 TASI lhau                        a0000000 TASI lhz     a4000000 TASI lhzu                        b8000000 TASI lmw     80000000 TASI lwz                         84000000 TASI lwzu    1c000000 TASI mulli                       98000000 TASI stb     9c000000 TASI stbu                        d8000000 TASI stfd    dc000000 TASI stfdu                       d0000000 TASI stfs    d4000000 TASI stfsu                       b0000000 TASI sth     b4000000 TASI sthu                        bc000000 TASI stmw    90000000 TASI stw                         94000000 TASI stwu    40000000 TASI subfic                      : sub  ( rT 0 rB 0 rA 0 -- ) 2swap subf ;                       : sub.  ( rT 0 rB 0 rA 0 -- ) 2swap subf. ;                     : subi  ( rT 0 rA 0 x 1 -- ) swap negate swap addi ;            7c0001d4 TA addme     7c0001d5 TA addme.                        7c0004d4 TA addmeo    7c0004d5 TA addmeo.                       7c000194 TA addze     7c000195 TA addze.                        7c000494 TA addzeo    7c000495 TA addzeo.                       7c0000d0 TA neg       7c0000d1 TA neg.                          7c0004d0 TA nego      7c0004d1 TA nego.                         7c0001b0 TA subfme    7c0001b1 TA subfme.                       7c0004b0 TA subfmeo   7c0004b0 TA subfmeo.                      7c000190 TA subfze    7c000191 TA subfze.                       7c000490 TA subfzeo   7c000490 TA subfzeo.                      7c000078 ASB andc     7c000079 ASB andc.                        7c000238 ASB eqv      7c000239 ASB eqv.                         7c0003b8 ASB nand     7c0003b9 ASB nand.                        7c0000f8 ASB nor      7c0000f9 ASB nor.                         7c000338 ASB orc      7c000339 ASB orc.                         7c000030 ASB slw      7c000031 ASB slw.                         7c000630 ASB sraw     7c000631 ASB sraw.                        7c000430 ASB srw      7c000431 ASB srw.                         7c000278 ASB xor      7c000279 ASB xor.                         70000000 ASUI andi.   74000000 ASUI andis.                      60000000 ASUI ori     64000000 ASUI oris                        7c000670 ASUI srawi   7c000671 ASUI srawi.                      68000000 ASUI xori    6c000000 ASUI xoris                       : li  ( rT 0 x 1 -- )                                             +imm  dup >r d# -32768 d# 32768 within 0=  if                     2dup  r0  r@ d# 16 rshifta 1 addis  2dup                      else  r0  then  r> 1  addi ;                                  true 48000000 LI b    false 48000002 LI ba                      true 48000001 LI bl   false 48000003 LI bla                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #7                                                                                                            : bc  ( bo bi addr -- )                                           >r  BI  swap BO or  40000000 or  r> relBD or asm, ;           : bca  ( bo bi addr -- )                                          >r  BI  swap BO or  40000002 or  r> BD or asm, ;              : bcl  ( bo bi addr -- )                                          >r  BI  swap BO or  40000001 or  r> relBD or asm, ;           : bcla  ( bo bi addr -- )                                         >r  BI  swap BO or  40000003 or  r> BD or asm, ;              true 10 0 40000000 BOBIBD bdnz      true 10 0 40000001 BOBIBD bdnzl                                                             false 10 0 40000000 BOBIBD bdnza    false 10 0 40000001 BOBIBD bdnzla                                                           true 12 0 40000000 BOBIBD bdz       true 12 0 40000001 BOBIBD bdzl                                                              false 12 0 40000000 BOBIBD bdza     false 12 0 40000001 BOBIBD bdzla                                                            true 0c 40020000 BOBIFBD beq        true 0c 40020001 BOBIFBD beql                                                               false 0c 40020000 BOBIFBD beqa      false 0c 40020001 BOBIFBD beqla                                                             true 04 40000000 BOBIFBD bge        true 04 40000001 BOBIFBD bgel                                                               false 04 40000000 BOBIFBD bgea      false 04 40000001 BOBIFBD bgela                                                             true 0c 40001000 BOBIFBD bgt        true 0c 40010001 BOBIFBD bgtl                                                               false 0c 40010000 BOBIFBD bgta      false 0c 40010001 BOBIFBD bgtla                                                             true 04 40010000 BOBIFBD ble        true 04 40010001 BOBIFBD blel                                                               false 04 40010000 BOBIFBD blea      false 04 40010001 BOBIFBD blela                                                             true 0c 40000000 BOBIFBD blt        true 0c 40000001 BOBIFBD bltl                                                               false 0c 40000000 BOBIFBD blta      false 0c 40000001 BOBIFBD bltla                                                             true 04 40020000 BOBIFBD bne        true 04 40020001 BOBIFBD bnel                                                               false 04 40020000 BOBIFBD bnea      false 04 40020001 BOBIFBD bnela                                                             true 04 40030000 BOBIFBD bns        true 04 40030001 BOBIFBD bnsl                                                               false 04 40030000 BOBIFBD bnsa      false 04 40030001 BOBIFBD bnsla                                                             true 0c 40030000 BOBIFBD bso        true 0c 40030001 BOBIFBD bsol                                                               false 0c 40030000 BOBIFBD bsoa      false 0c 40030001 BOBIFBD bsola                                                             \ unimplemented: bdnzfXX bdnztXX bdzfXX bdztXX bfXX btXX bngXX  \ bnlXX                                                         \                bnuXX bunXX                                    : bcctr  ( bo bi -- ) BI swap BO or 4c000420 or asm, ;          : bcctrl  ( bo bi -- ) BI swap BO or 4c000421 or asm, ;                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #8                                                                                                            14 0 4c000420 BOBI bctr             14 0 4c000421 BOBI bctrl    0c 4c020420 BOBIF beqctr            0c 4c020421 BOBIF beqctrl   04 4c000420 BOBIF bgectr            04 4c000421 BOBIF bgectrl   0c 4c010420 BOBIF bgtctr            0c 4c010420 BOBIF bgtctrl   04 4c010420 BOBIF blectr            04 4c010420 BOBIF blectrl   0c 4c000420 BOBIF bltctr            0c 4c000420 BOBIF bltctrl   04 4c020420 BOBIF bnectr            04 4c020420 BOBIF bnectrl   04 4c030420 BOBIF bnsctr            04 4c030420 BOBIF bnsctrl   0c 4c030420 BOBIF bsoctr            0c 4c030420 BOBIF bsoctrl   \ unimplemented: bfctrX btctrX bngctrX bnlctrX bnuctrX bunctrX  : bclr  ( bo bi -- ) BI swap BO or 4c000020 or asm, ;           : bclrl  ( bo bi -- ) BI swap BO or 4c000021 or asm, ;          14 0 4c000020 BOBI blr              14 0 4c000021 BOBI blrl     10 0 4c000020 BOBI bdnzlr           10 0 4c000021 BOBI bdnzlrl  12 0 4c000020 BOBI bdzlr            12 0 4c000021 BOBI bdzlrl   0c 4c020020 BOBIF beqlr             0c 4c020021 BOBIF beqlrl    04 4c000020 BOBIF bgelr             04 4c000021 BOBIF bgelrl    0c 4c010020 BOBIF bgtlr             0c 4c010021 BOBIF bgtlrl    04 4c010020 BOBIF blelr             04 4c010021 BOBIF blelrl    0c 4c000020 BOBIF bltlr             0c 4c000021 BOBIF bltlrl    04 4c020020 BOBIF bnelr             04 4c020021 BOBIF bnelrl    04 4c030020 BOBIF bnslr             04 4c030021 BOBIF bnslrl    0c 4c030020 BOBIF bsolr             0c 4c030021 BOBIF bsolrl    \ unimplemented: bdnzflrX bdnztlrX bdzflrX bdztlrX bflrX bnglrX \                bnllrX bnulrX btlrX bunlrX                     7c000000 cTLAB cmp          7c000040 cTLAB cmpl                 : cmpw  ( crT rA 0 rB 0 -- ) 2>r  0 -rot  2r> cmp ;             : cmplw  ( crT rA 0 rB 0 -- ) 2>r  0 -rot  2r> cmpl ;           2c000000 cTLASI cmpi        28000000 cTLASI cmpli               : cmpwi  ( crT rA 0 n 1 -- ) 2>r  0 -rot  2r> cmpi ;            : cmplwi  ( crT rA 0 n 1 -- ) 2>r  0 -rot  2r> cmpli ;          7c000034 AS cntlzw          7c000774 AS extsb                   7c000775 AS extsb.          7c000734 AS extsh                   7c000735 AS extsh.          7c0007b4 AS extsw                   7c0007b5 AS extsw.                                              4c000202 bTAB crand         4c000102 bTAB crandc                4c000242 bTAB creqv         4c0001c2 bTAB crnand                4c000082 bTAB crnor         4c000382 bTAB cror                  4c000342 bTAB crorc         4c000182 bTAB crxor                 : crnot  ( bT bA -- ) dup crnor ;                               : crmove  ( bT bA -- ) dup cror ;                               7c0000ac AB dcbf            7c0003ac AB dcbi                    7c00006c AB dcbst           7c00022c AB dcbt                    7c0001ec AB dcbtst          7c0007ec AB dcbz                    7c0007ac AB icbi                                                : eieio  7c0006ac asm, ;                                        : isync  4c00012c asm, ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #9                                                                                                            fc000210 TB fabs            fc000211 TB fabs.                   fc00001c TB fctiw           fc00001d TB fctiw.                  fc00001e TB fctiwz          fc00001f TB fctiwz.                 fc000090 TB fmr             fc000091 TB fmr.                    fc000110 TB fnabs           fc000111 TB fnabs.                  fc000050 TB fneg            fc000051 TB fneg.                   fc000018 TB frsp            fc000019 TB frsp.                   fc000040 cTAB fcmpo         fc000000 cTAB fcmpu                 fc00003a TABC fmadd         fc00003b TABC fmadd.                ec00003a TABC fmadds        ec00003b TABC fmadds.               fc000038 TABC fmsub         fc000039 TABC fmsub.                ec000038 TABC fmsubs        ec000039 TABC fmsubs.               fc000032 TAC fmul           fc000033 TAC fmul.                  ec000032 TAC fmuls          ec000033 TAC fmuls.                 fc00003e TACB fnmadd        fc00003f TACB fnmadd.               ec00003e TACB fnmadds       ec00003f TACB fnmadds.              fc00003c TACB fnmsub        fc00003d TACB fnmsub.               ec00003c TACB fnmsubs       ec00003d TACB fnmsubs.              : lswi  ( rT 0 rA 0 u 1 -- )                                      SI d# 11 lshift -rot  rA or -rot  rT or  7c0004aa or asm, ;   : stswi  ( rT 0 rA 0 u 1 -- )                                     SI d# 11 lshift -rot  rA or -rot  rT or  7c0005aa or asm, ;   4c000000 cTcS mcrf          fc000080 cTcS mcrfs                 7c000400 cT mcrxr                                               7c000026 RT mfcr            fc00048e RT mffs                    7c0000a6 RT mfmsr           7c000124 RT mtmsr                   : mfspr  ( rT 0 SPR -- ) >r rT r> SPR or 7c0002a6 or asm, ;     : mfctr 9 mfspr ;      : mflr 8 mfspr ;     : mfxer 1 mfspr ;   \ unimplemented: mfasr mfdar mfdbatl mfdbatu mfdec mfdisr mfear \                mfibatl mfibatu mfpvr mfsdrl mfsprg mfsrr0     \                mfsrr1                                         \                mfsr mfsrin                                    : mftb  ( rT 0 TBR -- ) >r rT  r> SPR or  7c0004a6 or asm, ;    : mftbu 269 mftb ;                                              : mtcrf  ( crMASK rS 0 -- )                                       rT swap  d# 12 lshift or  7c000120 or asm, ;                  : mtcr 0ff -rot mtcrf ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #10                                                                                                           fc00008c BT mtfsb0          fc00008d BT mtfsb0.                 fc00004c BT mtfsb1          fc00004d BT mtfsb1.                 : mtfsf  ( frMASK rB 0 -- )                                       rB swap  d# 17 lshift or  fc00058e or asm, ;                  : mtfsf.  ( frMASK rB 0 -- )                                      rB swap  d# 17 lshift or  fc00058f or asm, ;                  : mtfsfi  ( crT IMM 1 -- )                                        0= abort" expected immediate"                                   d# 13 lshift  swap crT or  fc00010c or asm, ;                 : mtfsfi.  ( crT IMM 1 -- )                                       0= abort" expected immediate"                                   d# 13 lshift  swap crT or  fc00010d or asm, ;                 : mtspr  ( SPR rS 0 -- ) rT swap  SPR or  7c0003a6 or asm, ;    : mtctr 9 -rot mtspr ;      : mtlr 8 -rot mtspr ;               : mtxer 1 -rot mtspr ;                                          \ unimplemented: mtasr mtdar mtdbatl mtdbatu mtdec mtdisr mtear \                mtibatl mtibatu mtsdr1 mtsprg mtsrr0 mtsrr1    \                mtsr mtsrin                                    50000000 ASnBE rlwimi       50000001 ASnBE rlwimi.              54000000 ASnBE rlwinm       54000001 ASnBE rlwinm.              : clrlslwi  swap over -  over d# 31 swap - rlwinm ;             : clrlslwi.  swap over -  over d# 31 swap - rlwinm. ;           : clrlwi  +imm  0 swap d# 31 rlwinm ;                           : clrlwi.  +imm  0 swap d# 31 rlwinm. ;                         : clrrwi  +imm  0 0 rot d# 31 swap - rlwinm ;                   : clrrwi.  +imm  0 0 rot d# 31 swap - rlwinm. ;                 : extlwi  +imm  0 rot 1- rlwinm ;                               : extlwi.  +imm  0 rot 1- rlwinm. ;                             : extrwi  +imm  over >r  +  d# 32 r> -  d# 31 rlwinm ;          : extrwi.  +imm  over >r  +  d# 32 r> -  d# 31 rlwinm. ;        : rotlwi  +imm  0 d# 31 rlwinm ;                                : rotlwi.  +imm  0 d# 31 rlwinm. ;                              : rotrwi  +imm  d# 32 swap - 0 d# 31 rlwinm ;                   : rotrwi.  +imm  d# 32 swap - 0 d# 31 rlwinm. ;                 : slwi  +imm  0 over d# 31 swap - rlwinm ;                      : slwi.  +imm  0 over d# 31 swap - rlwinm. ;                    : srwi  +imm  dup >r  d# 32 swap -  r> d# 31 rlwinm ;           : srwi.  +imm  dup >r  d# 32 swap -  r> d# 31 rlwinm. ;         5c000000 ASBBE rlwnm        5c000001 ASBBE rlwnm.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0              \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #11                                                                                                           : rotlw  0 d# 31 rlwnm ;        : rotlw.  0 d# 31 rlwnm. ;      : sc  44000002 asm, ;           : sync  7c0004ac asm, ;         \ unimplemented: tlbia tlbie tlbsync                            : tw  ( TO rA 0 rB 0 -- ) rB -rot  rA or  swap d# 21 lshift or    7c000008 or asm, ;                                            : trap  d# 31 r0 r0 tw ;                                        : tw-rot  ( rA 0 rB 0 t# -- ) -rot 2>r -rot 2r> tw ;            : tweq  4 tw-rot ;      : twge  0c tw-rot ;     : twgt  8 tw-rot ;                                                              : twle  d# 20 tw-rot ;  : twlge  5 tw-rot ;     : twlgt  1 tw-rot ;                                                             : twlle  6 tw-rot ;     : twllt  2 tw-rot ;     : twlt  10 tw-rot ;                                                             : twne  d# 24 tw-rot ;                                          \ unimplemented: twlng twlnl twng twnl                          : twi  ( TO rA 0 n 1 -- ) SI -rot  rA or  swap d# 21 lshift or    0c000000 or asm, ;                                            : twi-rot  ( rA 0 n 1 t# -- ) -rot 2>r -rot 2r> twi ;           : tweqi  4 twi-rot ;        : twgei  d# 12 twi-rot ;            : twgti  8 twi-rot ;        : twlei  d# 20 twi-rot ;            : twlgei  5 twi-rot ;       : twlgti  1 twi-rot ;               : twllei  6 twi-rot ;       : twllti  2 twi-rot ;               : twlti  d# 16 twi-rot ;    : twnei  d# 24 twi-rot ;            \ unimplemented: twlngi twlnli twngi twnli                      also forth                                                      variable cond                                                   : >  810000 cond ! ;     : <  800000 cond ! ;                   : =  820000 cond ! ;     : <>  1820000 cond ! ;                 : <=  1810000 cond ! ;   : >=  1800000 cond ! ;                 : so?  830000 cond ! ;   : ns?  1830000 cond ! ;                \ control structures                                            : patch  ( from to -- ) over -  fffc and  over asm@ or  swap asm! ;                                                             : %if  ( -- a ) asmhere  cond @ 40000000 or asm, ;              : if  %if ;                                                     : then  ( a -- ) asmhere patch ;                                : branch,  ( -- a ) asmhere  48000000 asm, ;                    : else  ( a1 -- a2 ) branch,  swap asmhere patch ;              : begin  ( -- a ) asmhere ;                                     : again  ( a -- ) asmhere - absLI 48000000 or asm, ;            : until  ( a -- ) %if  swap patch ;                             : while  ( a1 -- a1 a2 ) %if ;                                  : repeat  ( a1 a2 -- ) asmhere >r  swap b r> asmhere patch ;    \ here, because we need `and` + `or` in the code above          7c000378 ASB or       7c000379 ASB or.                          7c000038 ASB and      7c000039 ASB and.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev :#0            \ "ff" sources 10 - Assemblers 364                                                                                              \ PPC assembler - #12 (end)                                                                                                     previous                                                        : nop  r0 r0 0 # ori ;      : rfi 4c000064 asm, ;               : mr  2dup or ;             : mr.  2dup or. ;                                                                                   \ next                                                                                                                          \ registers: TOS: r3, SP: r1, RP: r11, AP: r13, W: r14          create (next)                                                     r14 r13 ) lwz                                                   r13 r13 4 # addi                                                r4 r14 ) lwz                                                    r4 mtlr                                                         blr                                                                                                                           : next  (next) b ;                                                                                                              previous  also forth definitions  also assembler                                                                                : code  ( | name -- )                                             create  asmhere dup 1 cells - ! ( cfa -> paramfield )           also assembler ;                                              : end-code  previous ;                                                                                                          previous previous                                               decimal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0                                                                         \ The "ff" User Manual                                                                                                          Introduction                                    801             Portability                                     802             Platform Notes                                  803             Available Vocabulary                            804             Unicode Support                                 805             Debugging Tools                                 806             Saving executables                              807             Assemblers                                      808             Metacompilation                                 809             Porting Guide                                   810             Glossary of Words                               811 - 816       Common Error Messages                           817             Limitations                                     818             Dictionary Layout                               819             Memory Map                                      820             Register Usage                                  821             Acknowledgements                                822             License                                         823             Contact                                         824                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back Xclip 0   \ User Manual 800                                                                                                               \ Introduction                                                                                                                    This is "ff", an implementation of the Forth programming      language for 32- and 64-bit CPUs on Linux, Mac OS X and most    BSD flavors. "ff" is indirect-threaded and currently available  for x86_64, i386, ARM, MIPS, PowerPC, m68k/ColdFire, RISC-V, SH5and Sparc processors. It is kept intentionally simple to reduce size and complexity to a minimum. Floating-point math and double-precision numbers are not directly supported and only basic    I/O facilities are provided. The machine-code portion is quite  small and it should be very easy to port "ff" to other architec-tures.                                                                                                                            "ff" is completely self-contained - no additional software is needed to build it and the system can be cross-compiled from andto all supported target platforms.  The C library ("libc") is   not used, "ff" directly invokes Linux or BSD system-calls or ca be modified to directly access the hardware on bare metal       systems.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Portability                                                                                                                     "ff" supports ARM, ColdFire, ARM-Cortex, i386, m68k, MIPS,    PowerPC, RISC-V, SH4, SPARC and x86_64 architectures, both      little- and big-endian (if variable). Target operating systems  that are supported are currently Linux, Darwin, FreeBSD, NetBSD and OpenBSD.                                                                                                                      To see whether a particular architecture/OS combination is    is supported out of the box, see block 346, which holds words   to build a binary for this configuration. If a particular       combination does not exist yet, it can be added, but needs      some support code for system calls and other platform-specific  things.                                                                                                                           "ff" can also run on bare metal, but you will need to write   drivers for I/O to be able to communicate with the outside      world.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Platform Notes                                                                                                                * On x86_64 and riscv64, cell size is 8, on all other platforms   is is 4.                                                                                                                      * Cross-compilation of `ff-x86_64-darwin` requires a 64-bit host  binary.                                                                                                                       * The Darwin build has only been fully tested on OS X "Sierra"    so far.                                                                                                                       * The m68k kernel uses 32-bit division/remainder and thus         requires an 68020 or higher.                                                                                                  * The ARM Cortex versions use the Cortex-M0 variant of the        thumb instruction set and should run on all ARM processors.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Available Vocabulary                                                                                                            "ff" tries to adhere to the Forth200x standard where it seems to make sense. Most core and core-extension words are provided, together with many file- and string- words. The list of         supported words further down lists all words provided by the    core system and the extensions usually loaded.                                                                                    Floating-point words are not provided. Also, number  parsing and printing only support single-precision numbers. Note that    "ff" is case-sensitive: standard words are all meant to be used in lowercase.                                                                                                                                                                                     Words incompatible to the Forth200x standard:                                                                                 `literal` and `sliteral` are not immediate.  It is not clear    where the advantage lies in making these so.                                                                                    `c"` is intended for interpretation time, and should not be usedin colon definitions.                                                                                                           `create` does not work in combination with `does>`, use         `<builds` instead.                                                                                                              `parse` returns a counted string, not an address + length.                                                                      `abort` and `abort"` do not throw exceptions and can not be     caught.  The standard semantics are rather messy, and catching  aborts can be handled much easier by modifying the deferred     word `abort`                                                                                                                    `(` does not allow comments that exceed the current line.                                                                       `number` does only handle single-precision numbers.                                                                                                                                               "ff" provides numerous extensions, consult the source code formore information about what' is available.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Unicode Support                                                                                                                 Partial UTF-8 support is provided: `emit`, `char` and `[char]`encode and decode UTF-8 sequences correctly, `key` does not.    For manual UTF-8 encoding and decoding, see `utfencode` +       `utfdecode`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Debugging Tools                                                                                                                 Several tools exist to support viewing and analyzing code and data.                                                                                                                           dump  ( a u -- ) Shows the contents of memory at the given        address.                                                                                                                      see  ( | word -- ) Decompiles the word with the given name,       showing a low-level representation of color words.                                                                            locate  ( | word -- ) Shows the block-number and position in the  block where "word" was defined (`view` does the same and opens  the editor.)                                                                                                                  where  ( | word -- ) Lists all colon words that refer to "word".                                                                  There is also a simple interactive debugger:                                                                                    also debugger                                                                                                                 debug  ( | word -- ) will invoke "word" in a debugging environ-   ment where you are asked after every executed word how to       continue. If another definition was currnetly executing under   debugger-control, then the previous exeuction is quietly        aborted. The debugger uses the data stack like normal code      but uses simulated return stack.                                                                                              Debugger commands:                                                                                                                q     Stop debugging. The contents of the data stack remain           unchanged.                                                                                                                s     Execute the next instruction.                                                                                             n     Execute the next instruction and, if it is a colon word,        continue executing until it returns. Note that                  execution of nested words under debugger control is much        slower than normal execution.                                                                                             t     Like "n", but show each instruction as it is executed.                                                                    .rs   Show the contents of the (simulated) return stack.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Saving Executables                                                                                                              A running "ff" instance can be saved to a new executable file using the `save` word, which will be an ELF or Mach-O binary,   depending on the platform the system is compiled for.                                                                             The deferred word `startup` can be modified to perform any    tasks that should run at program startup, the default is to     enter the interactive interpreter (using `quit`.) The deferred  word `presave` is invoked just before saving a file, to perform any cleanup that should be done to ensure the freshly started   excutable is in a clean state. `presave` defaults to `noop`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Assemblers                                                                                                                      The distribution contains assemblers for some of the target   architectures, with varying quality. Some have been obtained    from other sources, some have been written for "ff". See the    section on platform-specific code (block 13) for more details.                                                                    All assemblers provide the words `code` and `end-code` to     define words written in machine language. No automatic flush of the instruction-cache is currently done, nor are OS-specific    restrictions on writable + executable memory pages addressed.   On architectures that require this, you will have to implement  the necessary operations yourself.                                                                                              `i386/asm.f` originates from kForth[7] and was written by Frank Sergeant, and subsequently extended by Thomas Novelli and       Krishna Myneni. This code is available under a MIT/BSD license. Note that this assembler contains a number of bugs: indirect    addressing with register `esp` and indirect jump through a      register result in an incorrect instruction encoding.                                                                           `arm/asm.f` was written by J.D. Medhurst (see here[8]) and is   available under a MIT license.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Metacompilation                                                                                                                 Building "ff" uses a process called "meta-compilation", where certain defining words are replaced with variants that generate code for a different platform and/or executable formats. With   some vocabulary gymnastics it is possible to load the code      for the base system unchanged, generaring the final target      binary in memory and finally dumping that to a file.                                                                            Machine-dependent code for primitives (the "kernel") is written in a low-level Forth-like assembly language, called "generic".  Implementations for this language are provided for all supportedarchitectures.                                                                                                                  The complete process is roughly as follows:                                                                                     - Load meta-compilation support code, set up buffers            - Load a "configuration" screen setting parameters like           endianness, word-size, architecture, binary format, etc.      - Load an implementation of "generic" for the target            - Load the kernel, generating machine code for primitives       - Load the core words                                           - Generating a header for the selected target binary format     - Copy the kernel, compiled core words and required sections      for the binary format and write everything to disk            - Remove all generated data and meta-compilation support code                                                                   See screen 345 for the messy details.                                                                                           Most target binaries can be generated from any working "ff"     binary, but some exceptions exist, for example, the 64-bit      Darwin binary can only be generated from a 64-bit "ff" (it needsto manipulate 64-bit addresses.)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Xclip Back 0   \ User Manual 800                                                                                                               \ Porting Guide                                                                                                                   Porting "ff" to a new architecture requires implementing a    code generator for "generic", the pseudo machine level Forth in that the kernel containing the machine-language primitives is   written in.                                                                                                                       Generic has words for explicit stack access and consists of   machine code templates that are used to construct the core      dictionary. Support for a new architecture requires an          implementation of generic generating the necessary code.                                                                          Some core words have to be defined to connect the I/O         primitives with the outside world, and usually platform-specificstartup code is required.                                                                                                         Currently, the supported binary formats for target executablesand boot images are ELF, Mach-O, Multiboot and flat binaries.   Other formats can be added. "Flat" binaries can be loaded       directly to a specific memory location and have no further      structure, but you must specify a base address in your meta-    compilation configuration. Multiboot binaries can be loaded by  the "GRUB" bootloader, see screen 560 for code and instructions to build a simple i386 bare metal "ff" binary for PCs.                                                                            Note that meta-compiled binaries only contain very basic wordsand functionality. For the optional extensions you will need    access to external media to read and evaluate the code.         Alternatively, you could load the block-file into memory and    implement a minimal block-access interface that directly reads  the extensions from memory. By default, only a very basic file- based block-file loader is contained in the bootstrap binaries, one that is just sufficient to load basic extensions and a      full block file interface. The extended binary you built to use this editor uses an mmap(2) based interface to the block file.                                                                    For more information, consult the existing code, specifically the meta compiler (screen 12) and the platform specific code    (screen 13.)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                               \ Glossary of Words (Words marked by "*" are state-smart)                                                                           !              ( x a -- )                       primitive       !+             ( a1 x -- a2 )                   optional        ?exit          ( f -- )                         optional        "              ( ..." -- a n )                                  #              ( u1 -- u2 )                                     #>             ( u1 -- a n )                                    #arg           ( -- u )                                         #s             ( u -- n )                                       '              ( <word> -- xt )                                 (              ( ...) -- )         immediate                    (+loop)        ( n -- )                         primitive       (:)            ( -- )                           primitive       (.)            ( n1 -- a n2 )                                   (?abort)       ( f a n -- )                                     (abort)        ( ... -- )                                       (constant)     ( -- x )                         primitive       (deferred)     ( -- )                           primitive       (do)           ( n1 n2 -- )                     primitive       (else)         ( -- )                           primitive       (if)           ( n1 -- )                        primitive       (literal)      ( -- n )                         primitive       (loop)         ( -- )                           primitive       (sliteral)     ( -- a n )                       primitive       (u.)           ( u1 -- a u2 )                                   (variable)     ( -- a)                          primitive       *              ( n1 n2 -- n3 )                  primitive       +              ( n1 n2 -- n3 )                  primitive       +!             ( n a -- )                                       +field         ( u | <word> -- )                optional        +loop          ( n -- )            immediate                    ,              ( x -- )                                         ,"             ( | ..." -- )                    optional        -              ( n1 n2 -- n3 )                  primitive       -;             ( -- )              immediate    optional        -rot           ( x y z -- z x y )                               -trailing      ( a n1 -- a n2 )                 optional        .              ( n -- )                                         ."             ( | ..." -- )       immediate                    .(             \( | ...) -- )      immediate    optional        .buffers       ( -- )                           optional        .rs            ( -- )                           debugger        .s             ( -- )                                           .r             ( n1 n2 -- )                                     /              ( n1 n2 -- n3 )                                  /mod           ( n1 n2 -- n3 n4 )               primitive       /string        ( a1 n1 n2 -- a2 n3 )            optional        0>             ( n -- f)                        optional        0<             ( n -- f )                                       0<>            ( n -- f )                       optional        0=             ( n -- f )                                       1+             ( n1 -- n2 )                                     1-             ( n1 -- n2 )                                     2*             ( n1 -- n2 )                                     2/             ( n1 -- n2 )                                     2@             ( a -- x y )                                     2!             ( x y a -- )                                     2>r            ( x y -- )                                       2constant      ( x y | <word> -- )              optional                                                                    \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                                   2drop          ( x y -- )                                       2dup           ( x y -- x y x y )                               2literal       ( x y -- )                       optional        2nip           ( x y z q -- z q )                               2over          ( x y z q -- x y z q x y )                       2r>            ( -- x y )                                       2r@            ( -- x y )                       optional        2rot           ( x y z q v w -- z q v q x y )                   2swap          ( x y z q -- z q x y )                           2variable      ( | <word> -- )                  optional        :              ( | <word> -- )                                  :noname        ( | ... -- xt )                  optional        ;              ( -- )              immediate                    <              ( n1 n2 -- f )                   primitive       <#             ( -- )                                           <=             ( x y -- f )                     optional        <>             ( n1 n2 -- f )                                   <builds        ( | <word> -- )                                  =              ( n1 n2 -- f )                   primitive       >              ( n1 n2 -- f )                                   >=             ( x y -- f )                     optional        >body          ( a1 -- a2 )                                     >in            ( -- a )                                         >limit         ( -- a )                                         >r             ( x -- )                         primitive       ?              ( a -- )                                         ?do            ( n1 n2 -- )                                     ?dup           ( x -- x [x] )                                   ?stack         ( -- )                                           @              ( a -- x )                       primitive       @+             ( a1 -- a2 x )                   optional        [              ( -- )                                           [']            ( | <word> -- xt )  immediate                    [char]         ( | <char> -- c )   immediate                    [defined]      ( | <word> -- f )   immediate    optional        [else]         ( | ... -- )        immediate    optional        [if]           ( f | ... -- )      immediate    optional        [then]         ( -- )              immediate    optional        [undefined]    ( | <word> -- f )   immediate    optional        \              ( | ... -- )        immediate                    \s             ( | ... -- )        immediate                    ]              ( -- )              immediate                    |              ( -- )              immediate    optional        a/o            ( -- n )                                         abort          ( ... -- )          deferred                     abort"         ( f | ..." -- )     immediate                    abs            ( n -- u )                                       accept         ( a n1 -- n2 )                                   again          ( -- )              immediate                    align          ( -- )                                           aligned        ( a1 -- a2 )                                     allot          ( n -- )                                         also           ( -- )                           optional        and            ( n1 n2 -- n3 )                  primitive       arg            ( u1 -- a u2 )                                   base           ( -- a )                                         begin          ( -- )              immediate                    begin-structure ( | <word> -- a 0 )             optional        bl             ( -- c )                                         blank          ( a n -- )                                                                                                   \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                                   blk            ( -- a )                                         boot           ( -- )                                           brk            ( -- )                                           bounds         ( a1 n -- a2 a1 )                optional        buffer:        ( n | <word> -- )                optional        bye            ( -- )              deferred                     c!             ( c a -- )                       primitive       c,             ( c -- )                                         c@             ( a -- c )                       primitive       c"             ( | ..." -- a )                                  callback       ( a -- )                         optional        case           ( x -- )                         optional        catch          ( xt -- exn# | 0 )               optional        cell+          ( a1 -- a2 )                                     cells          ( n1 -- n2 )                                     cfield:        ( u1 | <name> -- u2 )            optional        char           ( | <char> -- c )                                clear          ( ... -- )                       primitive       close-file     ( fd -- ior )                                    cmove          ( a1 a2 n -- )                   primitive       cmove>         ( a1 a2 n -- )                   primitive       cold           ( ... -- )                                       command        ( | <word> -- )     deferred     optional        compare        ( a1 n1 a2 n2 -- n3 )                            constant       ( x | <word> -- x )                              context        ( -- a )                         optional        count          ( a1 -- a2 n )                                   cr             ( -- )                                           crash          ( -- )                                           create         ( | <word> -- )                                  create-file    ( a n fam -- fd ior )                            current        ( -- )                           primitive       d#             ( | <number> -- n ) immediate*   optional        debug          ( | <word> -- )                  debugger        debugger       ( -- )                           debugger        decimal        ( -- )                                           defer          ( | <word> -- )                                  defer!         ( xt1 xt2 -- )                                   defer@         ( xt1 -- xt2 )                                   definitions    ( -- )                           optional        delete-file    ( a n -- ior )                                   depth          ( -- u )                                         do             ( n1 n2 -- )        immediate                    does>          ( | ... -- a )                                   dp             ( -- a )                         primitive       drop           ( x -- )                         primitive       dump           ( a n -- )                                       dup            ( x -- x x )                     primitive       else           ( -- )              immediate                    emit           ( c -- )                                         emits          ( c n -- )                                       empty-buffers  ( -- )                                           endcase        ( -- )                           optional        endof          ( -- )                           optional        end-structure  ( a offset -- )                  optional        erase          ( a n -- )                                       evaluate       ( a u -- )                                       exec           ( a u -- )                       optional        execute        ( xt -- )                        primitive       exit           ( -- )                           primitive                                                                   \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                                   false          ( -- 0 )                                         file-size      ( fd -- n ior )                  optional        field:         ( u1 | <name> -- u2 )            optional        fill           ( a n c -- )                                     find           ( a -- a 0 | xt 1 | xt -1 )                      flush          ( -- )                                           fork           ( -- pid|0 )                     optional        forth          ( -- )                           optional        forget         ( | <word> -- )                  optional        h              ( -- a )                         primitive       h#             ( | <number> -- n ) immediate*   optional        halt           ( n -- )                         primitive       here           ( -- a )                                         hex            ( -- )                                           hold           ( c -- )                                         i              ( -- n )                         primitive       if             ( f -- )            immediate                    immediate      ( -- )                                           include        ( | <fname> -- )                                 include-file   ( fd -- )                                        included       ( a u -- )                                       index          ( n1 n2 -- )                                     interpret      ( -- )                                           invert         ( n1 -- n2 )                                     is             ( xt | <word> -- )  immediate*                   j              ( -- n )                         primitive       key            ( -- c )                                         literal        ( n -- )                                         locate         ( | word -- )                                    lock?          ( a -- f )                       primitive       loop           ( -- )              immediate                    lshift         ( n1 u -- n2 )                   primitive       map-file       ( fd acc size off -- a ior )     optional        map-memory     ( size -- a ior )                optional        max            ( n1 n2 -- n1 | n2 )                             marker         ( | <word> -- )                  optional        min            ( n1 n2 -- n1 | n2 )                             mmap           ( a1 -- a2 )                     primitive       mod            ( n1 n2 -- n3 )                                  ms             ( n1 -- )                        optional        n              ( -- )                           debugger        negate         ( n1 -- n2 )                                     nip            ( x y -- y )                                     noop           ( -- )                           optional        number         ( a n1 -- n2 -1 | a n1 0 )                       of             ( x -- )                         optional        off            ( a -- )                                         on             ( a -- )                                         only           ( -- )                           optional        open-file      ( a n acc -- fd ior )                            or             ( n1 n2 -- n3 )                  primitive       order          ( -- )                           optional        over           ( x y -- x y x )                 primitive       pad            ( -- a )                                         page           ( -- )                                           parse          ( c | ... -- a )                                 pause          ( -- )                           primitive       perform        ( a -- )                         optional        postpone       ( | <word> -- )                  optional        pick           ( ... n -- x )                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                                   presave        ( -- )               deferred    optional        previous       ( -- )                           optional        prompt         ( -- )               deferred                    q              ( -- )                           debugger        query          ( -- )                                           quit           ( ... -- )           deferred                    r0             ( -- a )                         primitive       r/a            ( -- n )                                         r/o            ( -- n )                                         r/w            ( -- n )                                         r>             ( -- x )                         primitive       r@             ( -- x )                         primitive       random         ( -- n )                         optional        randomize      ( -- )                           optional        read-file      ( a n1 fd -- n2 ior )                            recurse        ( -- )                                           refill         ( -- f )                                         repeat         ( -- )              immediate                    reposition-file ( n fd -- ior )                                 reset          ( -- )                           primitive       restore-input  ( ... n -- )                                     reveal         ( -- )                                           rfind          ( xt -- a|0 )                    optional        roll           ( x1 x2 ... xN u -- x2 ... xN x1 ) optional      rot            ( n1 -- n2 )                                     rp!            ( a -- )                         primitive       rp@            ( -- a )                         primitive       rshift         ( n1 u -- n2 )                   primitive       rshifta        ( n1 u -- n2 )                   primitive       s              ( -- )                           debugger        s"             ( | ..." -- a n )   immediate                    s0             ( -- a )                         primitive       save           ( | <fname> -- )                 optional        save-input     ( -- ... n )                                     saved          ( a n -- )                       optional        scan           ( a1 n1 c -- a2 n2 )             optional        search         ( a1 n1 a2 n2 -- a3 n3 f )                       see            ( | <word> -- )                  optional        seed           ( -- a )                         optional        sifting        ( | <word> -- )                  optional        sign           ( n -- )                                         signum         ( n1 -- n2 )                                     sizeof         ( | <word> -- sz )  immediate*   optional        skip           ( a1 n1 c -- a2 n2 )             optional        sliteral       ( a n -- )                                       smudge         ( -- )                                           source         ( -- a u )                                       source-id      ( -- id )                                        sp!            ( a -- )                         primitive       sp@            ( -- a )                         primitive       space          ( -- )                                           spaces         ( n -- )                                         startup        ( -- )              deferred                     state          ( -- a )                                         string,        ( a n -- )                       optional        swap           ( x y -- y x )                                   syscall0       ( u -- x )                       primitive       syscall1       ( x u -- y )                     primitive       syscall2       ( x1 x2 u -- y )                 primitive       syscall3       ( x1 x2 x3 u -- y )              primitive                                                                   \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ User Manual 800                                                                                                                   syscall4       ( x1 x2 x3 x4 u -- y )           primitive       syscall6       ( a u -- x )                     primitive       system         ( a u1 -- u2 )                   optional        t              ( -- )                           debugger        then           ( -- )              immediate                    th             ( a n1 -- n2 )                   optional        throw          ( ... n -- ... | ... n )         optional        tib            ( -- a )                                         transmit       ( u -- )                                         true           ( -- -1 )                                        tuck           ( x y -- y x y )                 optional        type           ( a n -- )                                       u>             ( u1 u2 -- f )                                   u<             ( u1 u2 -- f )                   primitive       u.             ( u -- )                                         u.r            ( u n -- )                                       under+         ( n1 n2 n3 -- n4 n2 )            optional        unless         ( x -- )            immediate    optional        unloop         ( -- )              immediate    primitive       unmap-memory   ( a u -- ior )                   optional        until          ( f -- )            immediate                    unused         ( -- u )                                         update         ( -- )                                           utfdecode      ( a1 -- a2 c )                                   utfencode      ( a c -- a n )                                   utfparse       ( c | ... -- a )                 optional        variable       ( | <word> -- )                                  vocabulary     ( | <word> -- )                  optional        w/o            ( -- n )                                         waitpid        ( pid -- status ior )            optional        where          ( | <word> -- )                  optional        while          ( f -- )            immediate                    within         ( n1 n2 n3 -- f )                                word           ( c | <word> -- a )                              words          ( -- )                           optional        write-file     ( a n fd -- ior )                                xor            ( n1 n2 -- n3 )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Common Error Messages                                                                                                         "<WORD> ?"                                                        Indicates that a word could not be found in the dictionary,     either during interpretation or compilation.                                                                                  "stack underflow"                                                 The stack was exhausted while being popped.                                                                                   "unable to restore input"                                         After including a file, the original input source could not be  restored - usually, the case when the stack is unbalanced       after inclusion of the file.                                                                                                  "uninitialized execution vector"                                  A deferred word was invoked, that was not set yet using `is`.                                                                 "too many wordlists"                                              Too many vocabularies are active at the same time.                                                                            "bad number syntax"                                               Arguments given to `h#` or `d#` are syntactically invalid for   assumed base.                                                                                                                 "out of space"                                                    The last explicit or implicit `allot` would exhaust the         available dictionary space.                                                                                                   "no handler"                                                      A `throw` occurred without an enclosing `catch`.                                                                              "unexpected end of input"                                         Unterminated interpreter conditional (like `[if]`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Limitations                                                                                                                     The default free dictionary space is 4MB, the default stack   size is 4086 cells and the default return-stack size is 256     cells. These settings can be changed by modifying the           appropriate constants at the head of the `metacompile` script.                                                                    UTF-8 encoded characters of maximally 4 bytes are supported,  using code-points that require more bytes result in undefined   behaviour.                                                                                                                      Words in the dictionary are significant to 31 characters.                                                                         Multiple `while` forms inside a `begin ... repeat` loop are   not allowed, as is mixing of `while` and `until`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Dictionary Layout                                                                                                               The Forth dictionary is organized as a single linked list of  headers, starting with the header at the address held by the    variable `dp`.                                                                                                                  Headers have the following structure:                                                                                             Length field (1 byte): the length of the word in the lowest       lowest 5 bits (bits 0-4)                                        bit 5: unused, bit 6: "smudge" bit, bit 7: immediate bit                                                                      Name (0-31 bytes)                                                                                                               Padding (0-3 bytes): pad link-field to address divisible by 4                                                                   Location (1 word): source-block (bits 16 - 31), source            position in block (bits 0 - 14)                                                                                               Link (1 word): pointer to previous header                                                                                       Code field (1 word): pointer to executable code                                                                                 Parameter field (0-N words): variable data, colon word code       or machine code in code words                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Memory Map                                                                                                                    Area                  |      Size | Contains                    ----------------------+-----------+-----------------------------Machine code words    |           | "text" segment              Core dictionary       |           | "data" segment              Heapspace             |       4MB | start of "bss" segment       :                    |           | (`here`)                                          |           |                             Buffer space          | 16 x 1024 | if file-bases block-words                         |           | are loaded                  Return stack          | 256 cells | `r0` (grows upwards)         :                    |           |                             Parameter stack       | 2048 cells|                              :                    |           |                             End of heap           |           | `s0`(grows downards)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Register Usage                                                                                                                Forth|i386|ARM|MIPS|Sparc|x86_64|m68k|RISC-V|PPC|SH4|           -----+----+---+----+-----+------+----+------+---+---+           TOS  | eax| r0| $v0|  %r1|   rax|  d0|    a0| r3| r0|           SP   | esp|r13| $sp|  %g2|   rsp|  a7|    x2| r1|r15|           RP   | ebp|r14| $fp|  %g3|   rbp|  a6|    x3|r11|r14|           AP   | esi|r12| $gp|  %g4|   rsi|  a5|   x18|r13|r13|           W    | edi|r11| $t9|  %g5|   rdi|  a4|   x19|r14|r12|           Temp | ebx| r1| $v1|  %l1|   rbx|  a0|   x11| r4| r1|                | ecx| r2| $t0|  %l2|   rcx|  d1|   x12| r5| r2|                | edx| r3| $t1|  %l3|   rdx|  d2|   x13| r6| r3|                |    | r4| $a0|  %l4|      |    |      |   |r11|                |    | r5| $a1|  %l5|      |    |      |   |   |                |    |   | $a2|     |      |    |      |   |   |                                                                           TOS: Top of stack                                               SP: Parameter stack pointer                                     RP: Return stack pointer                                        AP: Address pointer                                             W: Work register (holds CFA of currently invoked word)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Acknowledgements                                                                                                              Many thanks to Valery Ushakov for helping to port `ff` to many  NetBSD platforms.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ License                                                                                                                       Copyright (c) 2015-2018, Felix L. Winkelmann                    All rights reserved.                                                                                                            Redistribution and use in source and binary forms, with or      without modification, are permitted provided that the following conditions are met:                                                                                                             1. Redistributions of source code must retain the above            copyright notice, this list of conditions and the following     disclaimer.                                                                                                                  2. Redistributions in binary form must reproduce the above         copyright notice, this list of conditions and the following     disclaimer in the documentation and/or other materials          provided with the distribution.                                                                                              3. The name of the authors may not be used to endorse or promote   products derived from this software without specific prior      written permission.                                                                                                          THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY      EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,   THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A     PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORSBE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,        EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT         LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING  IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF  THE POSSIBILITY OF SUCH DAMAGE.                                                                                                 `i386/asm.f`: asm-x86 is released under the mit/bsd license, in accordance with the preference of its original author, frank    sergeant.                                                                                                                       `arm/asm.f`: this program is distributed under the terms of the 'mit license'. copyright (c) 2005 j.d.medhurst (a.k.a. tixy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ User Manual 800                                                                                                               \ Contact                                                                                                                         If you have questions, suggestions, want to report bugs or    comment on the system, please don't hesitate to contact me at                                                                     felix@call-with-current-continuation.org                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ Double- and mixed-precision math #1                                                                                           \ mostly taken from: http://excamera.com/files/j1demo/docforth/n \ uc.fs.html                                                                                                                   .( dmath )                                                                                                                      : d=                        ( a b c d -- f )                        >r                      \ a b c                                 rot xor                 \ b a^c                                 swap r> xor             \ a^c b^d                               or 0= ;                                                     : d+                              ( augend . addend . -- sum . )    rot + >r                      ( augend addend)                  over +                        ( augend sum)                     dup rot                       ( sum sum augend)                 u< if                         ( sum)                                r> 1+                                                       else                                                                r>                                                          then ;                        ( sum . )                     : s>d dup 0< ;                                                  : dnegate                                                           invert swap invert swap                                         1 0 d+ ;                                                    : dabs ( d -- ud ) ( 8.6.1.1160 ) dup 0< if dnegate then ;      : d- dnegate d+ ;                                               : dxor              \ ( a b c d -- e f )                            rot xor         \ a c b^d                                       -rot xor        \ b^d a^c                                       swap ;                                                      : dand      rot and -rot and swap ;                             : dor       rot or  -rot or  swap ;                             : dinvert  invert swap invert swap ;                            : d<            \ ( al ah bl bh -- flag )                           rot         \ al bl bh ah                                       2dup =                                                          if                                                                  2drop u<                                                    else                                                                2nip >                                                      then ;                                                      : d> 2swap d< ;                                                 : d0= or 0= ;                                                   : d0< 0 0 d< ;                                                  : d<> d= invert ;                                               : d2* 2dup d+ ;                                                 : d2/ dup 31 lshift >r 2/ swap 2/ r> or swap ;                  : dmax 2over 2over d< if 2swap then 2drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ Double- and mixed-precision math #2                                                                                           variable scratch                                                : um*  ( u1 u2 -- ud )                                              scratch !                                                       0 0                                                             [ 1 cells 8 * literal ] 0 do                                        2dup d+                                                         rot dup 0< if                                                       2* -rot                                                         scratch @ 0 d+                                              else                                                                2* -rot                                                     then                                                        loop                                                            rot drop ;                                                  : abssgn    ( a b -- |a| |b| negf )                                 2dup xor 0< >r abs swap abs swap r> ;                       : m*  abssgn >r um* r> if dnegate then ;                        : divstep                                                           ( divisor dq hi )                                               2*                                                              over 0< if 1+ then                                              swap 2* swap                                                    rot                     ( dq hi divisor )                       2dup < 0= if                                                        tuck                ( dq divisor hi divisor )                   -                                                               swap                ( dq hi divisor )                           rot 1+              ( hi divisor dq )                           rot                 ( divisor dq hi )                       else                                                                -rot                                                        then ;                                                      : um/mod ( ud u1 -- u2 u3 ) ( 6.1.2370 )                            -rot  [ 1 cells 8 * literal ] 0 do  divstep  loop               rot drop swap ;                                             : sm/rem ( d n -- r q ) ( 6.1.2214 ) ( symmetric )                over >r >r  dabs r@ abs um/mod                                  r> r@ xor 0< if negate then  r> 0< if >r negate r> then ;     : */mod >r m* r> sm/rem ;                                       : */    */mod nip ;                                             : t2*  over >r >r d2* r> 2* r> 0< 1 and + ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ Double- and mixed-precision math #3 (end)                                                                                                                                                     variable divisor                                                : m*/mod                                                            divisor !                                                       tuck um* 2swap um*   ( hi. lo. )                                                     ( m0 h l m1 )                              swap >r 0 d+ r>   ( m h l )                                     -rot                 ( l m h )                                  32 0 do         \ XXX 64?                                           t2*                                                             dup divisor @ < 0= if                                               divisor @ -                                                     rot 1+ -rot                                                 then                                                       loop ;                                                       : m*/ m*/mod drop ;                                                                                                             \ double printing                                               : (digit)  ( u -- c ) 9 over < 7 and + [char] 0 + ;             : (d#)  ( d1 -- d2 )                                                0 base @ um/mod >r base @ um/mod swap (digit) hold r> ;     : d#s ( d1 -- d2 ) ( 6.1.0050 ) begin  (d#) 2dup or 0=  until ; : d#> ( d -- a u ) ( 6.1.0040 ) drop #> ;                       : (d.)  ( d -- a n ) 2dup dabs <# d#s 2swap nip sign d#> ;      : d.  ( n -- ) (d.) type space ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ from: http://en.literateprograms.org/index.php?title=Special:D \ ownloadcode/Fixed-point_arithmetic_(Forth)&oldid=10788&file=m \ elbrot.f                                                                                                                     \ needs: dmath (900 902 thru)                                                                                                   .( mandelbrot )                                                                                                                 hex                                                             4000 constant 1fixed                                            4666 constant 1.1fixed                                          10000 constant 4fixed                                           decimal                                                         1fixed  3 * 80 / constant xinc                                  1.1fixed 2* 24 / constant yinc                                                                                                  : *f ( f g -- f*g ) 1fixed */ ;                                 : sq ( f -- f f*f ) over dup *f ;                                                                                               : mandel                                                          1.1fixed dup negate do                                            1fixed dup 2* negate do                                           i j 30   \ initial point x,y and max iteration count            begin                                                             1- ?dup  if                                                         -rot sq sq 2dup + 4fixed <  if                                      - i + -rot *f 2* j + rot false                              else                                                                2drop drop space true                                       then                                                        else                                                                ." *" true                                                  then                                                          until                                                           2drop                                                         xinc +loop                                                      cr                                                            yinc +loop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ simple char-frequency counter                                                                                                 ( doesn't scale histogram, just for testing mmap )                                                                              variable fd     variable addr       variable fsize                                                                              256 cells buffer: counts                                        counts 256 cells erase                                                                                                          : cf  addr @ dup fsize @ + swap do                                  counts i c@ th dup @ 1+ swap !                                loop ;                                                                                                                        : df  256 0 do                                                      counts i th @ 100 / ?dup  if                                      i 3 .r  space  [char] - swap emits cr                         then                                                          loop ;                                                                                                                        : countf  ( a u -- )                                              r/o open-file ?fcheck  dup fd !                                 file-size ?fcheck  fsize !                                      fd @ r/o fsize @ 0 map-file ?fcheck  addr !                     cf  df                                                          addr @ fsize @ unmap-memory ?fcheck                             fd @ close-file ?fcheck ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ base64 encoding/decoding #1                                                                                                   .( base64 )                                                                                                                     variable b64in   variable b64out   variable b64out0             4 buffer: b64buf                                                create b64vals ," ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="                                                                                                            : b64@  ( -- c ) b64in @ c@ 1 b64in +! ;                        : b64!  ( c -- ) b64out @ c! 1 b64out +! ;                      : b64val  ( c -- n )                                                b64vals count rot scan 0= abort" invalid input"                 b64vals 1+ - ;                                              : b64dec  ( i -- )  b64buf + b64@ b64val swap c! ;              : b64init ( a-in n-in a-out -- n-in )                               dup b64out ! b64out0 ! swap b64in ! ;                       : b64done ( -- n-out )                                              b64out @ b64out0 @ - ;                                      : base64decode  ( a-in n-in a-out -- n-out )                        b64init                                                         0 do                                                                0 b64dec  1 b64dec  2 b64dec  3 b64dec                          b64buf c@ 2 lshift b64buf 1+ c@ 4 rshift or b64!                b64buf 2 + c@ 64 < if                                               b64buf 1+ c@ 4 lshift b64buf 2 + c@ 2 rshift or b64!            b64buf 3 + c@ 64 < if                                               b64buf 2 + c@ 6 lshift b64buf 3 + c@ or b64!                then                                                        then                                                        4 +loop                                                         b64done ;                                                                                                                    \ : go  s" dGhpcyBpcyBhIHRlc3Q=" pad base64decode ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ Load Snarf Cut Paste Exit Pause Next Prev Back Xclip 0        \ Testing code 14                                                                                                               \ base64 encoding/decoding #2 (end)                                                                                             : b64code  ( n -- c ) b64vals 1+ + c@ b64! ;                    hex                                                             variable b64len                                                 : b64get  ( i -- c )                                                b64in @ + c@ ;                                              : base64encode  ( a-in n-in a-out -- n-out )                        b64init dup b64len ! 0 do                                           i b64get dup 0fc and 2 rshift b64code                           3 and 4 lshift                                                  i 1+ b64len @ < if                                                  i 1+ b64get 0f0 and 4 rshift or b64code                         i 1+ b64get 0f and 2 lshift                                     i 2 + b64len @ < if                                                 i 2 + b64get 0c0 and 6 rshift or b64code                        i 2 + b64get 03f and b64code                                else                                                                b64code [char] = b64!                                       then                                                        else                                                                b64code [char] = dup b64! b64!                              then                                                        3 +loop                                                         b64done ;                                                   decimal                                                                                                                         1000 buffer: b64pad     variable /b64pad                                                                                        : b64test  ( a u -- f )                                           2dup b64pad base64encode                                        b64pad swap pad base64decode pad swap compare ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ Load Snarf Cut Paste Exit Pause Next Prev Back 0              \ Testing code 14                                                                                                               \ simple benchmark, base64-encode stdin                                                                                         \ needs base64 (905 906 thru)                                                                                                   .( bench )                                                                                                                      variable dest  variable len  variable out                                                                                       : bench                                                           here dup 1000000 0 read-file ?fcheck  dup len !                  here + dest !                                                  100 0 do here len @ dest @ base64encode out ! loop              dest @ out @ type  bye ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev Back 0         \ Testing code 14                                                                                                               \ Loader for tests                                                                                                              900 907 thru                                                                                                                    mandel                                                                                                                          0 arg countf                                                                                                                    :noname  s" this is a test" b64test                               abort" BASE64 TEST FAILED" ; execute                                                                                          .( done ) cr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Load Wipe Snarf Cut Paste Exit Pause Next Prev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                